var NC=Object.create;var Is=Object.defineProperty,qC=Object.defineProperties,LC=Object.getOwnPropertyDescriptor,MC=Object.getOwnPropertyDescriptors,AC=Object.getOwnPropertyNames,aa=Object.getOwnPropertySymbols,$C=Object.getPrototypeOf,ru=Object.prototype.hasOwnProperty,Cf=Object.prototype.propertyIsEnumerable;var Df=(n,e,t)=>e in n?Is(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,le=(n,e)=>{for(var t in e||(e={}))ru.call(e,t)&&Df(n,t,e[t]);if(aa)for(var t of aa(e))Cf.call(e,t)&&Df(n,t,e[t]);return n},Mi=(n,e)=>qC(n,MC(e)),Tf=n=>Is(n,"__esModule",{value:!0});var Sf=(n,e)=>{var t={};for(var r in n)ru.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&aa)for(var r of aa(n))e.indexOf(r)<0&&Cf.call(n,r)&&(t[r]=n[r]);return t};var L=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),jC=(n,e)=>{for(var t in e)Is(n,t,{get:e[t],enumerable:!0})},Rf=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of AC(e))!ru.call(n,i)&&(t||i!=="default")&&Is(n,i,{get:()=>e[i],enumerable:!(r=LC(e,i))||r.enumerable});return n},G=(n,e)=>Rf(Tf(Is(n!=null?NC($C(n)):{},"default",!e&&n&&n.__esModule?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n),WC=(n=>(e,t)=>n&&n.get(e)||(t=Rf(Tf({}),e,1),n&&n.set(e,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var Ff=L(xf=>{xf.entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",times:"\xD7",divide:"\xF7",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",fnof:"\u0192",circ:"\u02C6",tilde:"\u02DC",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",bull:"\u2022",hellip:"\u2026",permil:"\u2030",prime:"\u2032",Prime:"\u2033",lsaquo:"\u2039",rsaquo:"\u203A",oline:"\u203E",euro:"\u20AC",trade:"\u2122",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666"}});var $f=L(cu=>{var au=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,If=new RegExp("[\\-\\.0-9"+au.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),Of=new RegExp("^"+au.source+If.source+"*(?::"+au.source+If.source+"*)?$"),Ms=0,Vr=1,$i=2,As=3,ji=4,Wi=5,$s=6,ua=7;function Hi(n,e){this.message=n,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,Hi)}Hi.prototype=new Error;Hi.prototype.name=Hi.name;function Nf(){}Nf.prototype={parse:function(n,e,t){var r=this.domBuilder;r.startDocument(),Mf(e,e={}),VC(n,e,t,r,this.errorHandler),r.endDocument()}};function VC(n,e,t,r,i){function s(me){if(me>65535){me-=65536;var et=55296+(me>>10),Ge=56320+(me&1023);return String.fromCharCode(et,Ge)}else return String.fromCharCode(me)}function o(me){var et=me.slice(1,-1);return et in t?t[et]:et.charAt(0)==="#"?s(parseInt(et.substr(1).replace("x","0x"))):(i.error("entity not found:"+me),me)}function a(me){if(me>y){var et=n.substring(y,me).replace(/&#?\w+;/g,o);f&&c(y),r.characters(et,0,me-y),y=me}}function c(me,et){for(;me>=l&&(et=h.exec(n));)u=et.index,l=u+et[0].length,f.lineNumber++;f.columnNumber=me-u+1}for(var u=0,l=0,h=/.*(?:\r\n?|\n)|.*$/g,f=r.locator,C=[{currentNSMap:e}],b={},y=0;;){try{var S=n.indexOf("<",y);if(S<0){if(!n.substr(y).match(/^\s*$/)){var R=r.doc,v=R.createTextNode(n.substr(y));R.appendChild(v),r.currentElement=v}return}switch(S>y&&a(S),n.charAt(S+1)){case"/":var D=n.indexOf(">",S+3),k=n.substring(S+2,D),x=C.pop();D<0?(k=n.substring(S+2).replace(/[\s<].*/,""),i.error("end tag name: "+k+" is not complete:"+x.tagName),D=S+1+k.length):k.match(/\s</)&&(k=k.replace(/[\s<].*/,""),i.error("end tag name: "+k+" maybe not complete"),D=S+1+k.length);var F=x.localNSMap,N=x.tagName==k,U=N||x.tagName&&x.tagName.toLowerCase()==k.toLowerCase();if(U){if(r.endElement(x.uri,x.localName,k),F)for(var J in F)r.endPrefixMapping(J);N||i.fatalError("end tag name: "+k+" is not match the current start tagName:"+x.tagName)}else C.push(x);D++;break;case"?":f&&c(S),D=QC(n,S,r);break;case"!":f&&c(S),D=GC(n,S,r,i);break;default:f&&c(S);var te=new Af,ie=C[C.length-1].currentNSMap,D=XC(n,S,te,ie,o,i),_e=te.length;if(!te.closed&&BC(n,D,te.tagName,b)&&(te.closed=!0,t.nbsp||i.warning("unclosed xml attribute")),f&&_e){for(var Tt=qf(f,{}),dt=0;dt<_e;dt++){var ft=te[dt];c(ft.offset),ft.locator=qf(f,{})}r.locator=Tt,Lf(te,r,ie)&&C.push(te),r.locator=f}else Lf(te,r,ie)&&C.push(te);te.uri==="http://www.w3.org/1999/xhtml"&&!te.closed?D=zC(n,D,te.tagName,o,r):D++}}catch(me){if(me instanceof Hi)throw me;i.error("element parse error: "+me),D=-1}D>y?y=D:a(Math.max(S,y)+1)}}function qf(n,e){return e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber,e}function XC(n,e,t,r,i,s){function o(C,b,y){C in t.attributeNames&&s.fatalError("Attribute "+C+" redefined"),t.addValue(C,b,y)}for(var a,c,u=++e,l=Ms;;){var h=n.charAt(u);switch(h){case"=":if(l===Vr)a=n.slice(e,u),l=As;else if(l===$i)l=As;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(l===As||l===Vr)if(l===Vr&&(s.warning('attribute value must after "="'),a=n.slice(e,u)),e=u+1,u=n.indexOf(h,e),u>0)c=n.slice(e,u).replace(/&#?\w+;/g,i),o(a,c,e-1),l=Wi;else throw new Error("attribute value no end '"+h+"' match");else if(l==ji)c=n.slice(e,u).replace(/&#?\w+;/g,i),o(a,c,e),s.warning('attribute "'+a+'" missed start quot('+h+")!!"),e=u+1,l=Wi;else throw new Error('attribute value must after "="');break;case"/":switch(l){case Ms:t.setTagName(n.slice(e,u));case Wi:case $s:case ua:l=ua,t.closed=!0;case ji:case Vr:case $i:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return s.error("unexpected end of input"),l==Ms&&t.setTagName(n.slice(e,u)),u;case">":switch(l){case Ms:t.setTagName(n.slice(e,u));case Wi:case $s:case ua:break;case ji:case Vr:c=n.slice(e,u),c.slice(-1)==="/"&&(t.closed=!0,c=c.slice(0,-1));case $i:l===$i&&(c=a),l==ji?(s.warning('attribute "'+c+'" missed quot(")!'),o(a,c.replace(/&#?\w+;/g,i),e)):((r[""]!=="http://www.w3.org/1999/xhtml"||!c.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+c+'" missed value!! "'+c+'" instead!!'),o(c,c,e));break;case As:throw new Error("attribute value missed!!")}return u;case"\x80":h=" ";default:if(h<=" ")switch(l){case Ms:t.setTagName(n.slice(e,u)),l=$s;break;case Vr:a=n.slice(e,u),l=$i;break;case ji:var c=n.slice(e,u).replace(/&#?\w+;/g,i);s.warning('attribute "'+c+'" missed quot(")!!'),o(a,c,e);case Wi:l=$s;break}else switch(l){case $i:var f=t.tagName;(r[""]!=="http://www.w3.org/1999/xhtml"||!a.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),o(a,a,e),e=u,l=Vr;break;case Wi:s.warning('attribute space is required"'+a+'"!!');case $s:l=Vr,e=u;break;case As:l=ji,e=u;break;case ua:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function Lf(n,e,t){for(var r=n.tagName,i=null,s=n.length;s--;){var o=n[s],a=o.qName,c=o.value,f=a.indexOf(":");if(f>0)var u=o.prefix=a.slice(0,f),l=a.slice(f+1),h=u==="xmlns"&&l;else l=a,u=null,h=a==="xmlns"&&"";o.localName=l,h!==!1&&(i==null&&(i={},Mf(t,t={})),t[h]=i[h]=c,o.uri="http://www.w3.org/2000/xmlns/",e.startPrefixMapping(h,c))}for(var s=n.length;s--;){o=n[s];var u=o.prefix;u&&(u==="xml"&&(o.uri="http://www.w3.org/XML/1998/namespace"),u!=="xmlns"&&(o.uri=t[u||""]))}var f=r.indexOf(":");f>0?(u=n.prefix=r.slice(0,f),l=n.localName=r.slice(f+1)):(u=null,l=n.localName=r);var C=n.uri=t[u||""];if(e.startElement(C,l,r,n),n.closed){if(e.endElement(C,l,r),i)for(u in i)e.endPrefixMapping(u)}else return n.currentNSMap=t,n.localNSMap=i,!0}function zC(n,e,t,r,i){if(/^(?:script|textarea)$/i.test(t)){var s=n.indexOf("</"+t+">",e),o=n.substring(e+1,s);if(/[&<]/.test(o))return/^script$/i.test(t)?(i.characters(o,0,o.length),s):(o=o.replace(/&#?\w+;/g,r),i.characters(o,0,o.length),s)}return e+1}function BC(n,e,t,r){var i=r[t];return i==null&&(i=n.lastIndexOf("</"+t+">"),i<e&&(i=n.lastIndexOf("</"+t)),r[t]=i),i<e}function Mf(n,e){for(var t in n)e[t]=n[t]}function GC(n,e,t,r){var i=n.charAt(e+2);switch(i){case"-":if(n.charAt(e+3)==="-"){var s=n.indexOf("-->",e+4);return s>e?(t.comment(n,e+4,s-e-4),s+3):(r.error("Unclosed comment"),-1)}else return-1;default:if(n.substr(e+3,6)=="CDATA["){var s=n.indexOf("]]>",e+9);return t.startCDATA(),t.characters(n,e+9,s-e-9),t.endCDATA(),s+3}var o=YC(n,e),a=o.length;if(a>1&&/!doctype/i.test(o[0][0])){var c=o[1][0],u=!1,l=!1;a>3&&(/^public$/i.test(o[2][0])?(u=o[3][0],l=a>4&&o[4][0]):/^system$/i.test(o[2][0])&&(l=o[3][0]));var h=o[a-1];return t.startDTD(c,u,l),t.endDTD(),h.index+h[0].length}}return-1}function QC(n,e,t){var r=n.indexOf("?>",e);if(r){var i=n.substring(e,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){var s=i[0].length;return t.processingInstruction(i[1],i[2]),r+2}else return-1}return-1}function Af(){this.attributeNames={}}Af.prototype={setTagName:function(n){if(!Of.test(n))throw new Error("invalid tagName:"+n);this.tagName=n},addValue:function(n,e,t){if(!Of.test(n))throw new Error("invalid attribute:"+n);this.attributeNames[n]=this.length,this[this.length++]={qName:n,value:e,offset:t}},length:0,getLocalName:function(n){return this[n].localName},getLocator:function(n){return this[n].locator},getQName:function(n){return this[n].qName},getURI:function(n){return this[n].uri},getValue:function(n){return this[n].value}};function YC(n,e){var t,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(i.lastIndex=e,i.exec(n);t=i.exec(n);)if(r.push(t),t[1])return r}cu.XMLReader=Nf;cu.ParseError=Hi});var yu=L(Ks=>{function js(n,e){for(var t in n)e[t]=n[t]}function nn(n,e){var t=n.prototype;if(!(t instanceof e)){let i=function(){};var r=i;i.prototype=e.prototype,i=new i,js(t,i),n.prototype=t=i}t.constructor!=n&&(typeof n!="function"&&console.error("unknow Class:"+n),t.constructor=n)}var JC="http://www.w3.org/1999/xhtml",rn={},qn=rn.ELEMENT_NODE=1,Ui=rn.ATTRIBUTE_NODE=2,la=rn.TEXT_NODE=3,jf=rn.CDATA_SECTION_NODE=4,Wf=rn.ENTITY_REFERENCE_NODE=5,ZC=rn.ENTITY_NODE=6,Hf=rn.PROCESSING_INSTRUCTION_NODE=7,Uf=rn.COMMENT_NODE=8,Kf=rn.DOCUMENT_NODE=9,Vf=rn.DOCUMENT_TYPE_NODE=10,mr=rn.DOCUMENT_FRAGMENT_NODE=11,eD=rn.NOTATION_NODE=12,Ot={},St={},Ux=Ot.INDEX_SIZE_ERR=(St[1]="Index size error",1),Kx=Ot.DOMSTRING_SIZE_ERR=(St[2]="DOMString size error",2),tD=Ot.HIERARCHY_REQUEST_ERR=(St[3]="Hierarchy request error",3),Vx=Ot.WRONG_DOCUMENT_ERR=(St[4]="Wrong document",4),Xx=Ot.INVALID_CHARACTER_ERR=(St[5]="Invalid character",5),zx=Ot.NO_DATA_ALLOWED_ERR=(St[6]="No data allowed",6),Bx=Ot.NO_MODIFICATION_ALLOWED_ERR=(St[7]="No modification allowed",7),nD=Ot.NOT_FOUND_ERR=(St[8]="Not found",8),Gx=Ot.NOT_SUPPORTED_ERR=(St[9]="Not supported",9),Xf=Ot.INUSE_ATTRIBUTE_ERR=(St[10]="Attribute in use",10),Qx=Ot.INVALID_STATE_ERR=(St[11]="Invalid state",11),Yx=Ot.SYNTAX_ERR=(St[12]="Syntax error",12),Jx=Ot.INVALID_MODIFICATION_ERR=(St[13]="Invalid modification",13),Zx=Ot.NAMESPACE_ERR=(St[14]="Invalid namespace",14),eF=Ot.INVALID_ACCESS_ERR=(St[15]="Invalid access",15);function di(n,e){if(e instanceof Error)var t=e;else t=this,Error.call(this,St[n]),this.message=St[n],Error.captureStackTrace&&Error.captureStackTrace(this,di);return t.code=n,e&&(this.message=this.message+": "+e),t}di.prototype=Error.prototype;js(Ot,di);function Xr(){}Xr.prototype={length:0,item:function(n){return this[n]||null},toString:function(n,e){for(var t=[],r=0;r<this.length;r++)Xi(this[r],t,n,e);return t.join("")}};function Ki(n,e){this._node=n,this._refresh=e,uu(this)}function uu(n){var e=n._node._inc||n._node.ownerDocument._inc;if(n._inc!=e){var t=n._refresh(n._node);ah(n,"length",t.length),js(t,n),n._inc=e}}Ki.prototype.item=function(n){return uu(this),this[n]};nn(Ki,Xr);function da(){}function zf(n,e){for(var t=n.length;t--;)if(n[t]===e)return t}function Bf(n,e,t,r){if(r?e[zf(e,r)]=t:e[e.length++]=t,n){t.ownerElement=n;var i=n.ownerDocument;i&&(r&&Jf(i,n,r),rD(i,n,t))}}function Gf(n,e,t){var r=zf(e,t);if(r>=0){for(var i=e.length-1;r<i;)e[r]=e[++r];if(e.length=i,n){var s=n.ownerDocument;s&&(Jf(s,n,t),t.ownerElement=null)}}else throw di(nD,new Error(n.tagName+"@"+t))}da.prototype={length:0,item:Xr.prototype.item,getNamedItem:function(n){for(var e=this.length;e--;){var t=this[e];if(t.nodeName==n)return t}},setNamedItem:function(n){var e=n.ownerElement;if(e&&e!=this._ownerElement)throw new di(Xf);var t=this.getNamedItem(n.nodeName);return Bf(this._ownerElement,this,n,t),t},setNamedItemNS:function(n){var e=n.ownerElement,t;if(e&&e!=this._ownerElement)throw new di(Xf);return t=this.getNamedItemNS(n.namespaceURI,n.localName),Bf(this._ownerElement,this,n,t),t},removeNamedItem:function(n){var e=this.getNamedItem(n);return Gf(this._ownerElement,this,e),e},removeNamedItemNS:function(n,e){var t=this.getNamedItemNS(n,e);return Gf(this._ownerElement,this,t),t},getNamedItemNS:function(n,e){for(var t=this.length;t--;){var r=this[t];if(r.localName==e&&r.namespaceURI==n)return r}return null}};function Qf(n){if(this._features={},n)for(var e in n)this._features=n[e]}Qf.prototype={hasFeature:function(n,e){var t=this._features[n.toLowerCase()];return!!(t&&(!e||e in t))},createDocument:function(n,e,t){var r=new Hs;if(r.implementation=this,r.childNodes=new Xr,r.doctype=t,t&&r.appendChild(t),e){var i=r.createElementNS(n,e);r.appendChild(i)}return r},createDocumentType:function(n,e,t){var r=new pu;return r.name=n,r.nodeName=n,r.publicId=e,r.systemId=t,r}};function Nt(){}Nt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(n,e){return eh(this,n,e)},replaceChild:function(n,e){this.insertBefore(n,e),e&&this.removeChild(e)},removeChild:function(n){return Zf(this,n)},appendChild:function(n){return this.insertBefore(n,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(n){return vu(this.ownerDocument||this,this,n)},normalize:function(){for(var n=this.firstChild;n;){var e=n.nextSibling;e&&e.nodeType==la&&n.nodeType==la?(this.removeChild(e),n.appendData(e.data)):(n.normalize(),n=e)}},isSupported:function(n,e){return this.ownerDocument.implementation.hasFeature(n,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(n){for(var e=this;e;){var t=e._nsMap;if(t){for(var r in t)if(t[r]==n)return r}e=e.nodeType==Ui?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(n){for(var e=this;e;){var t=e._nsMap;if(t&&n in t)return t[n];e=e.nodeType==Ui?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(n){var e=this.lookupPrefix(n);return e==null}};function Yf(n){return n=="<"&&"&lt;"||n==">"&&"&gt;"||n=="&"&&"&amp;"||n=='"'&&"&quot;"||"&#"+n.charCodeAt()+";"}js(rn,Nt);js(rn,Nt.prototype);function Ws(n,e){if(e(n))return!0;if(n=n.firstChild)do if(Ws(n,e))return!0;while(n=n.nextSibling)}function Hs(){}function rD(n,e,t){n&&n._inc++;var r=t.namespaceURI;r=="http://www.w3.org/2000/xmlns/"&&(e._nsMap[t.prefix?t.localName:""]=t.value)}function Jf(n,e,t,r){n&&n._inc++;var i=t.namespaceURI;i=="http://www.w3.org/2000/xmlns/"&&delete e._nsMap[t.prefix?t.localName:""]}function lu(n,e,t){if(n&&n._inc){n._inc++;var r=e.childNodes;if(t)r[r.length++]=t;else{for(var i=e.firstChild,s=0;i;)r[s++]=i,i=i.nextSibling;r.length=s}}}function Zf(n,e){var t=e.previousSibling,r=e.nextSibling;return t?t.nextSibling=r:n.firstChild=r,r?r.previousSibling=t:n.lastChild=t,lu(n.ownerDocument,n),e}function eh(n,e,t){var r=e.parentNode;if(r&&r.removeChild(e),e.nodeType===mr){var i=e.firstChild;if(i==null)return e;var s=e.lastChild}else i=s=e;var o=t?t.previousSibling:n.lastChild;i.previousSibling=o,s.nextSibling=t,o?o.nextSibling=i:n.firstChild=i,t==null?n.lastChild=s:t.previousSibling=s;do i.parentNode=n;while(i!==s&&(i=i.nextSibling));return lu(n.ownerDocument||n,n),e.nodeType==mr&&(e.firstChild=e.lastChild=null),e}function iD(n,e){var t=e.parentNode;if(t){var r=n.lastChild;t.removeChild(e);var r=n.lastChild}var r=n.lastChild;return e.parentNode=n,e.previousSibling=r,e.nextSibling=null,r?r.nextSibling=e:n.firstChild=e,n.lastChild=e,lu(n.ownerDocument,n,e),e}Hs.prototype={nodeName:"#document",nodeType:Kf,doctype:null,documentElement:null,_inc:1,insertBefore:function(n,e){if(n.nodeType==mr){for(var t=n.firstChild;t;){var r=t.nextSibling;this.insertBefore(t,e),t=r}return n}return this.documentElement==null&&n.nodeType==qn&&(this.documentElement=n),eh(this,n,e),n.ownerDocument=this,n},removeChild:function(n){return this.documentElement==n&&(this.documentElement=null),Zf(this,n)},importNode:function(n,e){return oh(this,n,e)},getElementById:function(n){var e=null;return Ws(this.documentElement,function(t){if(t.nodeType==qn&&t.getAttribute("id")==n)return e=t,!0}),e},getElementsByClassName:function(n){var e=new RegExp("(^|\\s)"+n+"(\\s|$)");return new Ki(this,function(t){var r=[];return Ws(t.documentElement,function(i){i!==t&&i.nodeType==qn&&e.test(i.getAttribute("class"))&&r.push(i)}),r})},createElement:function(n){var e=new Vi;e.ownerDocument=this,e.nodeName=n,e.tagName=n,e.childNodes=new Xr;var t=e.attributes=new da;return t._ownerElement=e,e},createDocumentFragment:function(){var n=new ha;return n.ownerDocument=this,n.childNodes=new Xr,n},createTextNode:function(n){var e=new du;return e.ownerDocument=this,e.appendData(n),e},createComment:function(n){var e=new fu;return e.ownerDocument=this,e.appendData(n),e},createCDATASection:function(n){var e=new hu;return e.ownerDocument=this,e.appendData(n),e},createProcessingInstruction:function(n,e){var t=new mu;return t.ownerDocument=this,t.tagName=t.target=n,t.nodeValue=t.data=e,t},createAttribute:function(n){var e=new fa;return e.ownerDocument=this,e.name=n,e.nodeName=n,e.localName=n,e.specified=!0,e},createEntityReference:function(n){var e=new gu;return e.ownerDocument=this,e.nodeName=n,e},createElementNS:function(n,e){var t=new Vi,r=e.split(":"),i=t.attributes=new da;return t.childNodes=new Xr,t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.namespaceURI=n,r.length==2?(t.prefix=r[0],t.localName=r[1]):t.localName=e,i._ownerElement=t,t},createAttributeNS:function(n,e){var t=new fa,r=e.split(":");return t.ownerDocument=this,t.nodeName=e,t.name=e,t.namespaceURI=n,t.specified=!0,r.length==2?(t.prefix=r[0],t.localName=r[1]):t.localName=e,t}};nn(Hs,Nt);function Vi(){this._nsMap={}}Vi.prototype={nodeType:qn,hasAttribute:function(n){return this.getAttributeNode(n)!=null},getAttribute:function(n){var e=this.getAttributeNode(n);return e&&e.value||""},getAttributeNode:function(n){return this.attributes.getNamedItem(n)},setAttribute:function(n,e){var t=this.ownerDocument.createAttribute(n);t.value=t.nodeValue=""+e,this.setAttributeNode(t)},removeAttribute:function(n){var e=this.getAttributeNode(n);e&&this.removeAttributeNode(e)},appendChild:function(n){return n.nodeType===mr?this.insertBefore(n,null):iD(this,n)},setAttributeNode:function(n){return this.attributes.setNamedItem(n)},setAttributeNodeNS:function(n){return this.attributes.setNamedItemNS(n)},removeAttributeNode:function(n){return this.attributes.removeNamedItem(n.nodeName)},removeAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);t&&this.removeAttributeNode(t)},hasAttributeNS:function(n,e){return this.getAttributeNodeNS(n,e)!=null},getAttributeNS:function(n,e){var t=this.getAttributeNodeNS(n,e);return t&&t.value||""},setAttributeNS:function(n,e,t){var r=this.ownerDocument.createAttributeNS(n,e);r.value=r.nodeValue=""+t,this.setAttributeNode(r)},getAttributeNodeNS:function(n,e){return this.attributes.getNamedItemNS(n,e)},getElementsByTagName:function(n){return new Ki(this,function(e){var t=[];return Ws(e,function(r){r!==e&&r.nodeType==qn&&(n==="*"||r.tagName==n)&&t.push(r)}),t})},getElementsByTagNameNS:function(n,e){return new Ki(this,function(t){var r=[];return Ws(t,function(i){i!==t&&i.nodeType===qn&&(n==="*"||i.namespaceURI===n)&&(e==="*"||i.localName==e)&&r.push(i)}),r})}};Hs.prototype.getElementsByTagName=Vi.prototype.getElementsByTagName;Hs.prototype.getElementsByTagNameNS=Vi.prototype.getElementsByTagNameNS;nn(Vi,Nt);function fa(){}fa.prototype.nodeType=Ui;nn(fa,Nt);function Us(){}Us.prototype={data:"",substringData:function(n,e){return this.data.substring(n,n+e)},appendData:function(n){n=this.data+n,this.nodeValue=this.data=n,this.length=n.length},insertData:function(n,e){this.replaceData(n,0,e)},appendChild:function(n){throw new Error(St[tD])},deleteData:function(n,e){this.replaceData(n,e,"")},replaceData:function(n,e,t){var r=this.data.substring(0,n),i=this.data.substring(n+e);t=r+t+i,this.nodeValue=this.data=t,this.length=t.length}};nn(Us,Nt);function du(){}du.prototype={nodeName:"#text",nodeType:la,splitText:function(n){var e=this.data,t=e.substring(n);e=e.substring(0,n),this.data=this.nodeValue=e,this.length=e.length;var r=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}};nn(du,Us);function fu(){}fu.prototype={nodeName:"#comment",nodeType:Uf};nn(fu,Us);function hu(){}hu.prototype={nodeName:"#cdata-section",nodeType:jf};nn(hu,Us);function pu(){}pu.prototype.nodeType=Vf;nn(pu,Nt);function th(){}th.prototype.nodeType=eD;nn(th,Nt);function nh(){}nh.prototype.nodeType=ZC;nn(nh,Nt);function gu(){}gu.prototype.nodeType=Wf;nn(gu,Nt);function ha(){}ha.prototype.nodeName="#document-fragment";ha.prototype.nodeType=mr;nn(ha,Nt);function mu(){}mu.prototype.nodeType=Hf;nn(mu,Nt);function rh(){}rh.prototype.serializeToString=function(n,e,t){return ih.call(n,e,t)};Nt.prototype.toString=ih;function ih(n,e){var t=[],r=this.nodeType==9&&this.documentElement||this,i=r.prefix,s=r.namespaceURI;if(s&&i==null){var i=r.lookupPrefix(s);if(i==null)var o=[{namespace:s,prefix:null}]}return Xi(this,t,n,e,o),t.join("")}function sh(n,e,t){var r=n.prefix||"",i=n.namespaceURI;if(!r&&!i||r==="xml"&&i==="http://www.w3.org/XML/1998/namespace"||i=="http://www.w3.org/2000/xmlns/")return!1;for(var s=t.length;s--;){var o=t[s];if(o.prefix==r)return o.namespace!=i}return!0}function Xi(n,e,t,r,i){if(r)if(n=r(n),n){if(typeof n=="string"){e.push(n);return}}else return;switch(n.nodeType){case qn:i||(i=[]);var s=i.length,o=n.attributes,a=o.length,c=n.firstChild,u=n.tagName;t=JC===n.namespaceURI||t,e.push("<",u);for(var l=0;l<a;l++){var h=o.item(l);h.prefix=="xmlns"?i.push({prefix:h.localName,namespace:h.value}):h.nodeName=="xmlns"&&i.push({prefix:"",namespace:h.value})}for(var l=0;l<a;l++){var h=o.item(l);if(sh(h,t,i)){var f=h.prefix||"",C=h.namespaceURI,b=f?" xmlns:"+f:" xmlns";e.push(b,'="',C,'"'),i.push({prefix:f,namespace:C})}Xi(h,e,t,r,i)}if(sh(n,t,i)){var f=n.prefix||"",C=n.namespaceURI;if(C){var b=f?" xmlns:"+f:" xmlns";e.push(b,'="',C,'"'),i.push({prefix:f,namespace:C})}}if(c||t&&!/^(?:meta|link|img|br|hr|input)$/i.test(u)){if(e.push(">"),t&&/^script$/i.test(u))for(;c;)c.data?e.push(c.data):Xi(c,e,t,r,i),c=c.nextSibling;else for(;c;)Xi(c,e,t,r,i),c=c.nextSibling;e.push("</",u,">")}else e.push("/>");return;case Kf:case mr:for(var c=n.firstChild;c;)Xi(c,e,t,r,i),c=c.nextSibling;return;case Ui:return e.push(" ",n.name,'="',n.value.replace(/[<&"]/g,Yf),'"');case la:return e.push(n.data.replace(/[<&]/g,Yf).replace(/]]>/g,"]]&gt;"));case jf:return e.push("<![CDATA[",n.data,"]]>");case Uf:return e.push("<!--",n.data,"-->");case Vf:var y=n.publicId,S=n.systemId;if(e.push("<!DOCTYPE ",n.name),y)e.push(" PUBLIC ",y),S&&S!="."&&e.push(" ",S),e.push(">");else if(S&&S!=".")e.push(" SYSTEM ",S,">");else{var R=n.internalSubset;R&&e.push(" [",R,"]"),e.push(">")}return;case Hf:return e.push("<?",n.target," ",n.data,"?>");case Wf:return e.push("&",n.nodeName,";");default:e.push("??",n.nodeName)}}function oh(n,e,t){var r;switch(e.nodeType){case qn:r=e.cloneNode(!1),r.ownerDocument=n;case mr:break;case Ui:t=!0;break}if(r||(r=e.cloneNode(!1)),r.ownerDocument=n,r.parentNode=null,t)for(var i=e.firstChild;i;)r.appendChild(oh(n,i,t)),i=i.nextSibling;return r}function vu(n,e,t){var r=new e.constructor;for(var i in e){var s=e[i];typeof s!="object"&&s!=r[i]&&(r[i]=s)}switch(e.childNodes&&(r.childNodes=new Xr),r.ownerDocument=n,r.nodeType){case qn:var o=e.attributes,a=r.attributes=new da,c=o.length;a._ownerElement=r;for(var u=0;u<c;u++)r.setAttributeNode(vu(n,o.item(u),!0));break;case Ui:t=!0}if(t)for(var l=e.firstChild;l;)r.appendChild(vu(n,l,t)),l=l.nextSibling;return r}function ah(n,e,t){n[e]=t}try{if(Object.defineProperty){let n=function(e){switch(e.nodeType){case qn:case mr:var t=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&t.push(n(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}};tF=n,Object.defineProperty(Ki.prototype,"length",{get:function(){return uu(this),this.$$length}}),Object.defineProperty(Nt.prototype,"textContent",{get:function(){return n(this)},set:function(e){switch(this.nodeType){case qn:case mr:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),ah=function(e,t,r){e["$$"+t]=r}}}catch{}var tF;Ks.Node=Nt;Ks.DOMException=di;Ks.DOMImplementation=Qf;Ks.XMLSerializer=rh});var dh=L(Xs=>{function ch(n){this.options=n||{locator:{}}}ch.prototype.parseFromString=function(n,e){var t=this.options,r=new aD,i=t.domBuilder||new Vs,s=t.errorHandler,o=t.locator,a=t.xmlns||{},c=/\/x?html?$/.test(e),u=c?oD.entityMap:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return o&&i.setDocumentLocator(o),r.errorHandler=sD(s,i,o),r.domBuilder=t.domBuilder||i,c&&(a[""]="http://www.w3.org/1999/xhtml"),a.xml=a.xml||"http://www.w3.org/XML/1998/namespace",n&&typeof n=="string"?r.parse(n,a,u):r.errorHandler.error("invalid doc source"),i.doc};function sD(n,e,t){if(!n){if(e instanceof Vs)return e;n=e}var r={},i=n instanceof Function;t=t||{};function s(o){var a=n[o];!a&&i&&(a=n.length==2?function(c){n(o,c)}:n),r[o]=a&&function(c){a("[xmldom "+o+"]	"+c+wu(t))}||function(){}}return s("warning"),s("error"),s("fatalError"),r}function Vs(){this.cdata=!1}function zi(n,e){e.lineNumber=n.lineNumber,e.columnNumber=n.columnNumber}Vs.prototype={startDocument:function(){this.doc=new uD().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(n,e,t,r){var i=this.doc,s=i.createElementNS(n,t||e),o=r.length;pa(this,s),this.currentElement=s,this.locator&&zi(this.locator,s);for(var a=0;a<o;a++){var n=r.getURI(a),c=r.getValue(a),t=r.getQName(a),u=i.createAttributeNS(n,t);this.locator&&zi(r.getLocator(a),u),u.value=u.nodeValue=c,s.setAttributeNode(u)}},endElement:function(n,e,t){var r=this.currentElement,i=r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(n,e){},endPrefixMapping:function(n){},processingInstruction:function(n,e){var t=this.doc.createProcessingInstruction(n,e);this.locator&&zi(this.locator,t),pa(this,t)},ignorableWhitespace:function(n,e,t){},characters:function(n,e,t){if(n=uh.apply(this,arguments),n){if(this.cdata)var r=this.doc.createCDATASection(n);else var r=this.doc.createTextNode(n);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(n)&&this.doc.appendChild(r),this.locator&&zi(this.locator,r)}},skippedEntity:function(n){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(n){(this.locator=n)&&(n.lineNumber=0)},comment:function(n,e,t){n=uh.apply(this,arguments);var r=this.doc.createComment(n);this.locator&&zi(this.locator,r),pa(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(n,e,t){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(n,e,t);this.locator&&zi(this.locator,i),pa(this,i)}},warning:function(n){console.warn("[xmldom warning]	"+n,wu(this.locator))},error:function(n){console.error("[xmldom error]	"+n,wu(this.locator))},fatalError:function(n){throw new cD(n,this.locator)}};function wu(n){if(n)return`
@`+(n.systemId||"")+"#[line:"+n.lineNumber+",col:"+n.columnNumber+"]"}function uh(n,e,t){return typeof n=="string"?n.substr(e,t):n.length>=e+t||e?new java.lang.String(n,e,t)+"":n}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(n){Vs.prototype[n]=function(){return null}});function pa(n,e){n.currentElement?n.currentElement.appendChild(e):n.doc.appendChild(e)}var oD=Ff(),lh=$f(),aD=lh.XMLReader,cD=lh.ParseError,uD=Xs.DOMImplementation=yu().DOMImplementation;Xs.XMLSerializer=yu().XMLSerializer;Xs.DOMParser=ch;Xs.__DOMHandler=Vs});var ph=L(hh=>{var lD=dh().DOMParser;hh.parse=fD;var ga=3,fh=4,dD=8;function bu(n){return n.nodeType===ga||n.nodeType===dD||n.nodeType===fh}function vr(n){return!n.childNodes||n.childNodes.length===0}function fi(n,e){if(!n)throw new Error(e)}function fD(n){var e=new lD().parseFromString(n);fi(e.documentElement.nodeName==="plist","malformed document. First element should be <plist>");var t=Bi(e.documentElement);return t.length==1&&(t=t[0]),t}function Bi(n){var e,t,r,i,s,o,a,c;if(!n)return null;if(n.nodeName==="plist"){if(s=[],vr(n))return s;for(e=0;e<n.childNodes.length;e++)bu(n.childNodes[e])||s.push(Bi(n.childNodes[e]));return s}else if(n.nodeName==="dict"){if(t={},r=null,a=0,vr(n))return t;for(e=0;e<n.childNodes.length;e++)bu(n.childNodes[e])||(a%2==0?(fi(n.childNodes[e].nodeName==="key","Missing key while parsing <dict/>."),r=Bi(n.childNodes[e])):(fi(n.childNodes[e].nodeName!=="key",'Unexpected key "'+Bi(n.childNodes[e])+'" while parsing <dict/>.'),t[r]=Bi(n.childNodes[e])),a+=1);if(a%2==1)throw new Error('Missing value for "'+r+'" while parsing <dict/>');return t}else if(n.nodeName==="array"){if(s=[],vr(n))return s;for(e=0;e<n.childNodes.length;e++)bu(n.childNodes[e])||(o=Bi(n.childNodes[e]),o!=null&&s.push(o));return s}else if(n.nodeName!=="#text"){if(n.nodeName==="key")return vr(n)?"":(fi(n.childNodes[0].nodeValue!=="__proto__","__proto__ keys can lead to prototype pollution. More details on CVE-2022-22912"),n.childNodes[0].nodeValue);if(n.nodeName==="string"){if(o="",vr(n))return o;for(e=0;e<n.childNodes.length;e++){var c=n.childNodes[e].nodeType;(c===ga||c===fh)&&(o+=n.childNodes[e].nodeValue)}return o}else{if(n.nodeName==="integer")return fi(!vr(n),'Cannot parse "" as integer.'),parseInt(n.childNodes[0].nodeValue,10);if(n.nodeName==="real"){for(fi(!vr(n),'Cannot parse "" as real.'),o="",e=0;e<n.childNodes.length;e++)n.childNodes[e].nodeType===ga&&(o+=n.childNodes[e].nodeValue);return parseFloat(o)}else if(n.nodeName==="data"){if(o="",vr(n))return Buffer.from(o,"base64");for(e=0;e<n.childNodes.length;e++)n.childNodes[e].nodeType===ga&&(o+=n.childNodes[e].nodeValue.replace(/\s+/g,""));return Buffer.from(o,"base64")}else{if(n.nodeName==="date")return fi(!vr(n),'Cannot parse "" as Date.'),new Date(n.childNodes[0].nodeValue);if(n.nodeName==="true")return!0;if(n.nodeName==="false")return!1}}}}});var vh=L(ma=>{"use strict";ma.byteLength=pD;ma.toByteArray=mD;ma.fromByteArray=wD;var tr=[],Tn=[],hD=typeof Uint8Array!="undefined"?Uint8Array:Array,Cu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(hi=0,gh=Cu.length;hi<gh;++hi)tr[hi]=Cu[hi],Tn[Cu.charCodeAt(hi)]=hi;var hi,gh;Tn["-".charCodeAt(0)]=62;Tn["_".charCodeAt(0)]=63;function mh(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function pD(n){var e=mh(n),t=e[0],r=e[1];return(t+r)*3/4-r}function gD(n,e,t){return(e+t)*3/4-t}function mD(n){var e,t=mh(n),r=t[0],i=t[1],s=new hD(gD(n,r,i)),o=0,a=i>0?r-4:r,c;for(c=0;c<a;c+=4)e=Tn[n.charCodeAt(c)]<<18|Tn[n.charCodeAt(c+1)]<<12|Tn[n.charCodeAt(c+2)]<<6|Tn[n.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=Tn[n.charCodeAt(c)]<<2|Tn[n.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=Tn[n.charCodeAt(c)]<<10|Tn[n.charCodeAt(c+1)]<<4|Tn[n.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function vD(n){return tr[n>>18&63]+tr[n>>12&63]+tr[n>>6&63]+tr[n&63]}function yD(n,e,t){for(var r,i=[],s=e;s<t;s+=3)r=(n[s]<<16&16711680)+(n[s+1]<<8&65280)+(n[s+2]&255),i.push(vD(r));return i.join("")}function wD(n){for(var e,t=n.length,r=t%3,i=[],s=16383,o=0,a=t-r;o<a;o+=s)i.push(yD(n,o,o+s>a?a:o+s));return r===1?(e=n[t-1],i.push(tr[e>>2]+tr[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],i.push(tr[e>>10]+tr[e>>4&63]+tr[e<<2&63]+"=")),i.join("")}});var yr=L((yh,pi)=>{(function(){var n,e,t,r,i,s,o=[].slice,a={}.hasOwnProperty;n=function(){var c,u,l,h,f,C;if(C=arguments[0],f=2<=arguments.length?o.call(arguments,1):[],r(Object.assign))Object.assign.apply(null,arguments);else for(c=0,l=f.length;c<l;c++)if(h=f[c],h!=null)for(u in h)!a.call(h,u)||(C[u]=h[u]);return C},r=function(c){return!!c&&Object.prototype.toString.call(c)==="[object Function]"},i=function(c){var u;return!!c&&((u=typeof c)==="function"||u==="object")},e=function(c){return r(Array.isArray)?Array.isArray(c):Object.prototype.toString.call(c)==="[object Array]"},t=function(c){var u;if(e(c))return!c.length;for(u in c)if(!!a.call(c,u))return!1;return!0},s=function(c){var u,l;return i(c)&&(l=Object.getPrototypeOf(c))&&(u=l.constructor)&&typeof u=="function"&&u instanceof u&&Function.prototype.toString.call(u)===Function.prototype.toString.call(Object)},pi.exports.assign=n,pi.exports.isFunction=r,pi.exports.isObject=i,pi.exports.isArray=e,pi.exports.isEmpty=t,pi.exports.isPlainObject=s}).call(yh)});var Du=L((wh,bh)=>{(function(){var n;bh.exports=n=function(){function e(t,r,i){if(this.options=t.options,this.stringify=t.stringify,r==null)throw new Error("Missing attribute name of element "+t.name);if(i==null)throw new Error("Missing attribute value for attribute "+r+" of element "+t.name);this.name=this.stringify.attName(r),this.value=this.stringify.attValue(i)}return e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(t){return this.options.writer.set(t).attribute(this)},e}()}).call(wh)});var zs=L((Ch,Dh)=>{(function(){var n,e,t,r,i,s,o=function(c,u){for(var l in u)a.call(u,l)&&(c[l]=u[l]);function h(){this.constructor=c}return h.prototype=u.prototype,c.prototype=new h,c.__super__=u.prototype,c},a={}.hasOwnProperty;s=yr(),i=s.isObject,r=s.isFunction,t=sn(),n=Du(),Dh.exports=e=function(c){o(u,c);function u(l,h,f){if(u.__super__.constructor.call(this,l),h==null)throw new Error("Missing element name");this.name=this.stringify.eleName(h),this.attributes={},f!=null&&this.attribute(f),l.isDocument&&(this.isRoot=!0,this.documentObject=l,l.rootObject=this)}return u.prototype.clone=function(){var l,h,f,C;f=Object.create(this),f.isRoot&&(f.documentObject=null),f.attributes={},C=this.attributes;for(h in C)!a.call(C,h)||(l=C[h],f.attributes[h]=l.clone());return f.children=[],this.children.forEach(function(b){var y;return y=b.clone(),y.parent=f,f.children.push(y)}),f},u.prototype.attribute=function(l,h){var f,C;if(l!=null&&(l=l.valueOf()),i(l))for(f in l)!a.call(l,f)||(C=l[f],this.attribute(f,C));else r(h)&&(h=h.apply()),(!this.options.skipNullAttributes||h!=null)&&(this.attributes[l]=new n(this,l,h));return this},u.prototype.removeAttribute=function(l){var h,f,C;if(l==null)throw new Error("Missing attribute name");if(l=l.valueOf(),Array.isArray(l))for(f=0,C=l.length;f<C;f++)h=l[f],delete this.attributes[h];else delete this.attributes[l];return this},u.prototype.toString=function(l){return this.options.writer.set(l).element(this)},u.prototype.att=function(l,h){return this.attribute(l,h)},u.prototype.a=function(l,h){return this.attribute(l,h)},u}(t)}).call(Ch)});var Bs=L((Th,Sh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=sn(),Sh.exports=n=function(i){t(s,i);function s(o,a){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing CDATA text");this.text=this.stringify.cdata(a)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).cdata(this)},s}(e)}).call(Th)});var Gs=L((Rh,kh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=sn(),kh.exports=n=function(i){t(s,i);function s(o,a){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing comment text");this.text=this.stringify.comment(a)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).comment(this)},s}(e)}).call(Rh)});var Qs=L((Ph,_h)=>{(function(){var n,e,t,r=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function c(){this.constructor=s}return c.prototype=o.prototype,s.prototype=new c,s.__super__=o.prototype,s},i={}.hasOwnProperty;t=yr().isObject,e=sn(),_h.exports=n=function(s){r(o,s);function o(a,c,u,l){var h;o.__super__.constructor.call(this,a),t(c)&&(h=c,c=h.version,u=h.encoding,l=h.standalone),c||(c="1.0"),this.version=this.stringify.xmlVersion(c),u!=null&&(this.encoding=this.stringify.xmlEncoding(u)),l!=null&&(this.standalone=this.stringify.xmlStandalone(l))}return o.prototype.toString=function(a){return this.options.writer.set(a).declaration(this)},o}(e)}).call(Ph)});var Ys=L((Eh,xh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=sn(),xh.exports=n=function(i){t(s,i);function s(o,a,c,u,l,h){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing DTD element name");if(c==null)throw new Error("Missing DTD attribute name");if(!u)throw new Error("Missing DTD attribute type");if(!l)throw new Error("Missing DTD attribute default");if(l.indexOf("#")!==0&&(l="#"+l),!l.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT");if(h&&!l.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT");this.elementName=this.stringify.eleName(a),this.attributeName=this.stringify.attName(c),this.attributeType=this.stringify.dtdAttType(u),this.defaultValue=this.stringify.dtdAttDefault(h),this.defaultValueType=l}return s.prototype.toString=function(o){return this.options.writer.set(o).dtdAttList(this)},s}(e)}).call(Eh)});var Js=L((Fh,Ih)=>{(function(){var n,e,t,r=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function c(){this.constructor=s}return c.prototype=o.prototype,s.prototype=new c,s.__super__=o.prototype,s},i={}.hasOwnProperty;t=yr().isObject,e=sn(),Ih.exports=n=function(s){r(o,s);function o(a,c,u,l){if(o.__super__.constructor.call(this,a),u==null)throw new Error("Missing entity name");if(l==null)throw new Error("Missing entity value");if(this.pe=!!c,this.name=this.stringify.eleName(u),!t(l))this.value=this.stringify.dtdEntityValue(l);else{if(!l.pubID&&!l.sysID)throw new Error("Public and/or system identifiers are required for an external entity");if(l.pubID&&!l.sysID)throw new Error("System identifier is required for a public external entity");if(l.pubID!=null&&(this.pubID=this.stringify.dtdPubID(l.pubID)),l.sysID!=null&&(this.sysID=this.stringify.dtdSysID(l.sysID)),l.nData!=null&&(this.nData=this.stringify.dtdNData(l.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity")}}return o.prototype.toString=function(a){return this.options.writer.set(a).dtdEntity(this)},o}(e)}).call(Fh)});var Zs=L((Oh,Nh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=sn(),Nh.exports=n=function(i){t(s,i);function s(o,a,c){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing DTD element name");c||(c="(#PCDATA)"),Array.isArray(c)&&(c="("+c.join(",")+")"),this.name=this.stringify.eleName(a),this.value=this.stringify.dtdElementValue(c)}return s.prototype.toString=function(o){return this.options.writer.set(o).dtdElement(this)},s}(e)}).call(Oh)});var eo=L((qh,Lh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;e=sn(),Lh.exports=n=function(i){t(s,i);function s(o,a,c){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing notation name");if(!c.pubID&&!c.sysID)throw new Error("Public or system identifiers are required for an external entity");this.name=this.stringify.eleName(a),c.pubID!=null&&(this.pubID=this.stringify.dtdPubID(c.pubID)),c.sysID!=null&&(this.sysID=this.stringify.dtdSysID(c.sysID))}return s.prototype.toString=function(o){return this.options.writer.set(o).dtdNotation(this)},s}(e)}).call(qh)});var to=L((Mh,Ah)=>{(function(){var n,e,t,r,i,s,o,a=function(u,l){for(var h in l)c.call(l,h)&&(u[h]=l[h]);function f(){this.constructor=u}return f.prototype=l.prototype,u.prototype=new f,u.__super__=l.prototype,u},c={}.hasOwnProperty;o=yr().isObject,s=sn(),n=Ys(),t=Js(),e=Zs(),r=eo(),Ah.exports=i=function(u){a(l,u);function l(h,f,C){var b,y;l.__super__.constructor.call(this,h),this.documentObject=h,o(f)&&(b=f,f=b.pubID,C=b.sysID),C==null&&(y=[f,C],C=y[0],f=y[1]),f!=null&&(this.pubID=this.stringify.dtdPubID(f)),C!=null&&(this.sysID=this.stringify.dtdSysID(C))}return l.prototype.element=function(h,f){var C;return C=new e(this,h,f),this.children.push(C),this},l.prototype.attList=function(h,f,C,b,y){var S;return S=new n(this,h,f,C,b,y),this.children.push(S),this},l.prototype.entity=function(h,f){var C;return C=new t(this,!1,h,f),this.children.push(C),this},l.prototype.pEntity=function(h,f){var C;return C=new t(this,!0,h,f),this.children.push(C),this},l.prototype.notation=function(h,f){var C;return C=new r(this,h,f),this.children.push(C),this},l.prototype.toString=function(h){return this.options.writer.set(h).docType(this)},l.prototype.ele=function(h,f){return this.element(h,f)},l.prototype.att=function(h,f,C,b,y){return this.attList(h,f,C,b,y)},l.prototype.ent=function(h,f){return this.entity(h,f)},l.prototype.pent=function(h,f){return this.pEntity(h,f)},l.prototype.not=function(h,f){return this.notation(h,f)},l.prototype.up=function(){return this.root()||this.documentObject},l}(s)}).call(Mh)});var no=L(($h,jh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;n=sn(),jh.exports=e=function(i){t(s,i);function s(o,a){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing raw text");this.value=this.stringify.raw(a)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).raw(this)},s}(n)}).call($h)});var ro=L((Wh,Hh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;n=sn(),Hh.exports=e=function(i){t(s,i);function s(o,a){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing element text");this.value=this.stringify.eleText(a)}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).text(this)},s}(n)}).call(Wh)});var io=L((Uh,Kh)=>{(function(){var n,e,t=function(i,s){for(var o in s)r.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},r={}.hasOwnProperty;n=sn(),Kh.exports=e=function(i){t(s,i);function s(o,a,c){if(s.__super__.constructor.call(this,o),a==null)throw new Error("Missing instruction target");this.target=this.stringify.insTarget(a),c&&(this.value=this.stringify.insValue(c))}return s.prototype.clone=function(){return Object.create(this)},s.prototype.toString=function(o){return this.options.writer.set(o).processingInstruction(this)},s}(n)}).call(Uh)});var sn=L((Vh,Xh)=>{(function(){var n,e,t,r,i,s,o,a,c,u,l,h,f,C={}.hasOwnProperty;f=yr(),h=f.isObject,l=f.isFunction,u=f.isEmpty,i=null,n=null,e=null,t=null,r=null,a=null,c=null,o=null,Xh.exports=s=function(){function b(y){this.parent=y,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.children=[],i||(i=zs(),n=Bs(),e=Gs(),t=Qs(),r=to(),a=no(),c=ro(),o=io())}return b.prototype.element=function(y,S,R){var v,D,k,x,F,N,U,J,te,ie;if(N=null,S==null&&(S={}),S=S.valueOf(),h(S)||(te=[S,R],R=te[0],S=te[1]),y!=null&&(y=y.valueOf()),Array.isArray(y))for(k=0,U=y.length;k<U;k++)D=y[k],N=this.element(D);else if(l(y))N=this.element(y.apply());else if(h(y)){for(F in y)if(!!C.call(y,F))if(ie=y[F],l(ie)&&(ie=ie.apply()),h(ie)&&u(ie)&&(ie=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&F.indexOf(this.stringify.convertAttKey)===0)N=this.attribute(F.substr(this.stringify.convertAttKey.length),ie);else if(!this.options.separateArrayItems&&Array.isArray(ie))for(x=0,J=ie.length;x<J;x++)D=ie[x],v={},v[F]=D,N=this.element(v);else h(ie)?(N=this.element(F),N.element(ie)):N=this.element(F,ie)}else!this.options.ignoreDecorators&&this.stringify.convertTextKey&&y.indexOf(this.stringify.convertTextKey)===0?N=this.text(R):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&y.indexOf(this.stringify.convertCDataKey)===0?N=this.cdata(R):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&y.indexOf(this.stringify.convertCommentKey)===0?N=this.comment(R):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&y.indexOf(this.stringify.convertRawKey)===0?N=this.raw(R):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&y.indexOf(this.stringify.convertPIKey)===0?N=this.instruction(y.substr(this.stringify.convertPIKey.length),R):N=this.node(y,S,R);if(N==null)throw new Error("Could not create any elements with: "+y);return N},b.prototype.insertBefore=function(y,S,R){var v,D,k;if(this.isRoot)throw new Error("Cannot insert elements at root level");return D=this.parent.children.indexOf(this),k=this.parent.children.splice(D),v=this.parent.element(y,S,R),Array.prototype.push.apply(this.parent.children,k),v},b.prototype.insertAfter=function(y,S,R){var v,D,k;if(this.isRoot)throw new Error("Cannot insert elements at root level");return D=this.parent.children.indexOf(this),k=this.parent.children.splice(D+1),v=this.parent.element(y,S,R),Array.prototype.push.apply(this.parent.children,k),v},b.prototype.remove=function(){var y,S;if(this.isRoot)throw new Error("Cannot remove the root element");return y=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[y,y-y+1].concat(S=[])),this.parent},b.prototype.node=function(y,S,R){var v,D;return y!=null&&(y=y.valueOf()),S||(S={}),S=S.valueOf(),h(S)||(D=[S,R],R=D[0],S=D[1]),v=new i(this,y,S),R!=null&&v.text(R),this.children.push(v),v},b.prototype.text=function(y){var S;return S=new c(this,y),this.children.push(S),this},b.prototype.cdata=function(y){var S;return S=new n(this,y),this.children.push(S),this},b.prototype.comment=function(y){var S;return S=new e(this,y),this.children.push(S),this},b.prototype.commentBefore=function(y){var S,R,v;return R=this.parent.children.indexOf(this),v=this.parent.children.splice(R),S=this.parent.comment(y),Array.prototype.push.apply(this.parent.children,v),this},b.prototype.commentAfter=function(y){var S,R,v;return R=this.parent.children.indexOf(this),v=this.parent.children.splice(R+1),S=this.parent.comment(y),Array.prototype.push.apply(this.parent.children,v),this},b.prototype.raw=function(y){var S;return S=new a(this,y),this.children.push(S),this},b.prototype.instruction=function(y,S){var R,v,D,k,x;if(y!=null&&(y=y.valueOf()),S!=null&&(S=S.valueOf()),Array.isArray(y))for(k=0,x=y.length;k<x;k++)R=y[k],this.instruction(R);else if(h(y))for(R in y)!C.call(y,R)||(v=y[R],this.instruction(R,v));else l(S)&&(S=S.apply()),D=new o(this,y,S),this.children.push(D);return this},b.prototype.instructionBefore=function(y,S){var R,v,D;return v=this.parent.children.indexOf(this),D=this.parent.children.splice(v),R=this.parent.instruction(y,S),Array.prototype.push.apply(this.parent.children,D),this},b.prototype.instructionAfter=function(y,S){var R,v,D;return v=this.parent.children.indexOf(this),D=this.parent.children.splice(v+1),R=this.parent.instruction(y,S),Array.prototype.push.apply(this.parent.children,D),this},b.prototype.declaration=function(y,S,R){var v,D;return v=this.document(),D=new t(v,y,S,R),v.children[0]instanceof t?v.children[0]=D:v.children.unshift(D),v.root()||v},b.prototype.doctype=function(y,S){var R,v,D,k,x,F,N,U,J,te;for(v=this.document(),D=new r(v,y,S),J=v.children,k=x=0,N=J.length;x<N;k=++x)if(R=J[k],R instanceof r)return v.children[k]=D,D;for(te=v.children,k=F=0,U=te.length;F<U;k=++F)if(R=te[k],R.isRoot)return v.children.splice(k,0,D),D;return v.children.push(D),D},b.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},b.prototype.root=function(){var y;for(y=this;y;){if(y.isDocument)return y.rootObject;if(y.isRoot)return y;y=y.parent}},b.prototype.document=function(){var y;for(y=this;y;){if(y.isDocument)return y;y=y.parent}},b.prototype.end=function(y){return this.document().end(y)},b.prototype.prev=function(){var y;if(y=this.parent.children.indexOf(this),y<1)throw new Error("Already at the first node");return this.parent.children[y-1]},b.prototype.next=function(){var y;if(y=this.parent.children.indexOf(this),y===-1||y===this.parent.children.length-1)throw new Error("Already at the last node");return this.parent.children[y+1]},b.prototype.importDocument=function(y){var S;return S=y.root().clone(),S.parent=this,S.isRoot=!1,this.children.push(S),this},b.prototype.ele=function(y,S,R){return this.element(y,S,R)},b.prototype.nod=function(y,S,R){return this.node(y,S,R)},b.prototype.txt=function(y){return this.text(y)},b.prototype.dat=function(y){return this.cdata(y)},b.prototype.com=function(y){return this.comment(y)},b.prototype.ins=function(y,S){return this.instruction(y,S)},b.prototype.doc=function(){return this.document()},b.prototype.dec=function(y,S,R){return this.declaration(y,S,R)},b.prototype.dtd=function(y,S){return this.doctype(y,S)},b.prototype.e=function(y,S,R){return this.element(y,S,R)},b.prototype.n=function(y,S,R){return this.node(y,S,R)},b.prototype.t=function(y){return this.text(y)},b.prototype.d=function(y){return this.cdata(y)},b.prototype.c=function(y){return this.comment(y)},b.prototype.r=function(y){return this.raw(y)},b.prototype.i=function(y,S){return this.instruction(y,S)},b.prototype.u=function(){return this.up()},b.prototype.importXMLBuilder=function(y){return this.importDocument(y)},b}()}).call(Vh)});var Tu=L((zh,Bh)=>{(function(){var n,e=function(r,i){return function(){return r.apply(i,arguments)}},t={}.hasOwnProperty;Bh.exports=n=function(){function r(i){this.assertLegalChar=e(this.assertLegalChar,this);var s,o,a;i||(i={}),this.noDoubleEncoding=i.noDoubleEncoding,o=i.stringify||{};for(s in o)!t.call(o,s)||(a=o[s],this[s]=a)}return r.prototype.eleName=function(i){return i=""+i||"",this.assertLegalChar(i)},r.prototype.eleText=function(i){return i=""+i||"",this.assertLegalChar(this.elEscape(i))},r.prototype.cdata=function(i){return i=""+i||"",i=i.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(i)},r.prototype.comment=function(i){if(i=""+i||"",i.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+i);return this.assertLegalChar(i)},r.prototype.raw=function(i){return""+i||""},r.prototype.attName=function(i){return i=""+i||""},r.prototype.attValue=function(i){return i=""+i||"",this.attEscape(i)},r.prototype.insTarget=function(i){return""+i||""},r.prototype.insValue=function(i){if(i=""+i||"",i.match(/\?>/))throw new Error("Invalid processing instruction value: "+i);return i},r.prototype.xmlVersion=function(i){if(i=""+i||"",!i.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+i);return i},r.prototype.xmlEncoding=function(i){if(i=""+i||"",!i.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+i);return i},r.prototype.xmlStandalone=function(i){return i?"yes":"no"},r.prototype.dtdPubID=function(i){return""+i||""},r.prototype.dtdSysID=function(i){return""+i||""},r.prototype.dtdElementValue=function(i){return""+i||""},r.prototype.dtdAttType=function(i){return""+i||""},r.prototype.dtdAttDefault=function(i){return i!=null?""+i||"":i},r.prototype.dtdEntityValue=function(i){return""+i||""},r.prototype.dtdNData=function(i){return""+i||""},r.prototype.convertAttKey="@",r.prototype.convertPIKey="?",r.prototype.convertTextKey="#text",r.prototype.convertCDataKey="#cdata",r.prototype.convertCommentKey="#comment",r.prototype.convertRawKey="#raw",r.prototype.assertLegalChar=function(i){var s;if(s=i.match(/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/),s)throw new Error("Invalid character in string: "+i+" at index "+s.index);return i},r.prototype.elEscape=function(i){var s;return s=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(s,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},r.prototype.attEscape=function(i){var s;return s=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(s,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")},r}()}).call(zh)});var Su=L((Gh,Qh)=>{(function(){var n,e={}.hasOwnProperty;Qh.exports=n=function(){function t(r){var i,s,o,a,c,u,l,h,f;r||(r={}),this.pretty=r.pretty||!1,this.allowEmpty=(s=r.allowEmpty)!=null?s:!1,this.pretty?(this.indent=(o=r.indent)!=null?o:"  ",this.newline=(a=r.newline)!=null?a:`
`,this.offset=(c=r.offset)!=null?c:0,this.dontprettytextnodes=(u=r.dontprettytextnodes)!=null?u:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash=(l=r.spacebeforeslash)!=null?l:"",this.spacebeforeslash===!0&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,h=r.writer||{};for(i in h)!e.call(h,i)||(f=h[i],this[i]=f)}return t.prototype.set=function(r){var i,s,o;r||(r={}),"pretty"in r&&(this.pretty=r.pretty),"allowEmpty"in r&&(this.allowEmpty=r.allowEmpty),this.pretty?(this.indent="indent"in r?r.indent:"  ",this.newline="newline"in r?r.newline:`
`,this.offset="offset"in r?r.offset:0,this.dontprettytextnodes="dontprettytextnodes"in r?r.dontprettytextnodes:0):(this.indent="",this.newline="",this.offset=0,this.dontprettytextnodes=0),this.spacebeforeslash="spacebeforeslash"in r?r.spacebeforeslash:"",this.spacebeforeslash===!0&&(this.spacebeforeslash=" "),this.newlinedefault=this.newline,this.prettydefault=this.pretty,s=r.writer||{};for(i in s)!e.call(s,i)||(o=s[i],this[i]=o);return this},t.prototype.space=function(r){var i;return this.pretty?(i=(r||0)+this.offset+1,i>0?new Array(i).join(this.indent):""):""},t}()}).call(Gh)});var va=L((Yh,Jh)=>{(function(){var n,e,t,r,i,s,o,a,c,u,l,h,f,C,b=function(S,R){for(var v in R)y.call(R,v)&&(S[v]=R[v]);function D(){this.constructor=S}return D.prototype=R.prototype,S.prototype=new D,S.__super__=R.prototype,S},y={}.hasOwnProperty;o=Qs(),a=to(),n=Bs(),e=Gs(),c=zs(),l=no(),f=ro(),u=io(),t=Ys(),r=Zs(),i=Js(),s=eo(),C=Su(),Jh.exports=h=function(S){b(R,S);function R(v){R.__super__.constructor.call(this,v)}return R.prototype.document=function(v){var D,k,x,F,N;for(this.textispresent=!1,F="",N=v.children,k=0,x=N.length;k<x;k++)D=N[k],F+=function(){switch(!1){case!(D instanceof o):return this.declaration(D);case!(D instanceof a):return this.docType(D);case!(D instanceof e):return this.comment(D);case!(D instanceof u):return this.processingInstruction(D);default:return this.element(D,0)}}.call(this);return this.pretty&&F.slice(-this.newline.length)===this.newline&&(F=F.slice(0,-this.newline.length)),F},R.prototype.attribute=function(v){return" "+v.name+'="'+v.value+'"'},R.prototype.cdata=function(v,D){return this.space(D)+"<![CDATA["+v.text+"]]>"+this.newline},R.prototype.comment=function(v,D){return this.space(D)+"<!-- "+v.text+" -->"+this.newline},R.prototype.declaration=function(v,D){var k;return k=this.space(D),k+='<?xml version="'+v.version+'"',v.encoding!=null&&(k+=' encoding="'+v.encoding+'"'),v.standalone!=null&&(k+=' standalone="'+v.standalone+'"'),k+=this.spacebeforeslash+"?>",k+=this.newline,k},R.prototype.docType=function(v,D){var k,x,F,N,U;if(D||(D=0),N=this.space(D),N+="<!DOCTYPE "+v.root().name,v.pubID&&v.sysID?N+=' PUBLIC "'+v.pubID+'" "'+v.sysID+'"':v.sysID&&(N+=' SYSTEM "'+v.sysID+'"'),v.children.length>0){for(N+=" [",N+=this.newline,U=v.children,x=0,F=U.length;x<F;x++)k=U[x],N+=function(){switch(!1){case!(k instanceof t):return this.dtdAttList(k,D+1);case!(k instanceof r):return this.dtdElement(k,D+1);case!(k instanceof i):return this.dtdEntity(k,D+1);case!(k instanceof s):return this.dtdNotation(k,D+1);case!(k instanceof n):return this.cdata(k,D+1);case!(k instanceof e):return this.comment(k,D+1);case!(k instanceof u):return this.processingInstruction(k,D+1);default:throw new Error("Unknown DTD node type: "+k.constructor.name)}}.call(this);N+="]"}return N+=this.spacebeforeslash+">",N+=this.newline,N},R.prototype.element=function(v,D){var k,x,F,N,U,J,te,ie,_e,Tt,dt,ft,me;D||(D=0),me=!1,this.textispresent?(this.newline="",this.pretty=!1):(this.newline=this.newlinedefault,this.pretty=this.prettydefault),ft=this.space(D),ie="",ie+=ft+"<"+v.name,_e=v.attributes;for(te in _e)!y.call(_e,te)||(k=_e[te],ie+=this.attribute(k));if(v.children.length===0||v.children.every(function(et){return et.value===""}))this.allowEmpty?ie+="></"+v.name+">"+this.newline:ie+=this.spacebeforeslash+"/>"+this.newline;else if(this.pretty&&v.children.length===1&&v.children[0].value!=null)ie+=">",ie+=v.children[0].value,ie+="</"+v.name+">"+this.newline;else{if(this.dontprettytextnodes){for(Tt=v.children,F=0,U=Tt.length;F<U;F++)if(x=Tt[F],x.value!=null){this.textispresent++,me=!0;break}}for(this.textispresent&&(this.newline="",this.pretty=!1,ft=this.space(D)),ie+=">"+this.newline,dt=v.children,N=0,J=dt.length;N<J;N++)x=dt[N],ie+=function(){switch(!1){case!(x instanceof n):return this.cdata(x,D+1);case!(x instanceof e):return this.comment(x,D+1);case!(x instanceof c):return this.element(x,D+1);case!(x instanceof l):return this.raw(x,D+1);case!(x instanceof f):return this.text(x,D+1);case!(x instanceof u):return this.processingInstruction(x,D+1);default:throw new Error("Unknown XML node type: "+x.constructor.name)}}.call(this);me&&this.textispresent--,this.textispresent||(this.newline=this.newlinedefault,this.pretty=this.prettydefault),ie+=ft+"</"+v.name+">"+this.newline}return ie},R.prototype.processingInstruction=function(v,D){var k;return k=this.space(D)+"<?"+v.target,v.value&&(k+=" "+v.value),k+=this.spacebeforeslash+"?>"+this.newline,k},R.prototype.raw=function(v,D){return this.space(D)+v.value+this.newline},R.prototype.text=function(v,D){return this.space(D)+v.value+this.newline},R.prototype.dtdAttList=function(v,D){var k;return k=this.space(D)+"<!ATTLIST "+v.elementName+" "+v.attributeName+" "+v.attributeType,v.defaultValueType!=="#DEFAULT"&&(k+=" "+v.defaultValueType),v.defaultValue&&(k+=' "'+v.defaultValue+'"'),k+=this.spacebeforeslash+">"+this.newline,k},R.prototype.dtdElement=function(v,D){return this.space(D)+"<!ELEMENT "+v.name+" "+v.value+this.spacebeforeslash+">"+this.newline},R.prototype.dtdEntity=function(v,D){var k;return k=this.space(D)+"<!ENTITY",v.pe&&(k+=" %"),k+=" "+v.name,v.value?k+=' "'+v.value+'"':(v.pubID&&v.sysID?k+=' PUBLIC "'+v.pubID+'" "'+v.sysID+'"':v.sysID&&(k+=' SYSTEM "'+v.sysID+'"'),v.nData&&(k+=" NDATA "+v.nData)),k+=this.spacebeforeslash+">"+this.newline,k},R.prototype.dtdNotation=function(v,D){var k;return k=this.space(D)+"<!NOTATION "+v.name,v.pubID&&v.sysID?k+=' PUBLIC "'+v.pubID+'" "'+v.sysID+'"':v.pubID?k+=' PUBLIC "'+v.pubID+'"':v.sysID&&(k+=' SYSTEM "'+v.sysID+'"'),k+=this.spacebeforeslash+">"+this.newline,k},R.prototype.openNode=function(v,D){var k,x,F,N;if(D||(D=0),v instanceof c){F=this.space(D)+"<"+v.name,N=v.attributes;for(x in N)!y.call(N,x)||(k=N[x],F+=this.attribute(k));return F+=(v.children?">":"/>")+this.newline,F}else return F=this.space(D)+"<!DOCTYPE "+v.rootNodeName,v.pubID&&v.sysID?F+=' PUBLIC "'+v.pubID+'" "'+v.sysID+'"':v.sysID&&(F+=' SYSTEM "'+v.sysID+'"'),F+=(v.children?" [":">")+this.newline,F},R.prototype.closeNode=function(v,D){switch(D||(D=0),!1){case!(v instanceof c):return this.space(D)+"</"+v.name+">"+this.newline;case!(v instanceof a):return this.space(D)+"]>"+this.newline}},R}(C)}).call(Yh)});var tp=L((Zh,ep)=>{(function(){var n,e,t,r,i,s=function(a,c){for(var u in c)o.call(c,u)&&(a[u]=c[u]);function l(){this.constructor=a}return l.prototype=c.prototype,a.prototype=new l,a.__super__=c.prototype,a},o={}.hasOwnProperty;i=yr().isPlainObject,e=sn(),r=Tu(),t=va(),ep.exports=n=function(a){s(c,a);function c(u){c.__super__.constructor.call(this,null),u||(u={}),u.writer||(u.writer=new t),this.options=u,this.stringify=new r(u),this.isDocument=!0}return c.prototype.end=function(u){var l;return u?i(u)&&(l=u,u=this.options.writer.set(l)):u=this.options.writer,u.document(this)},c.prototype.toString=function(u){return this.options.writer.set(u).document(this)},c}(e)}).call(Zh)});var ip=L((np,rp)=>{(function(){var n,e,t,r,i,s,o,a,c,u,l,h,f,C,b,y,S,R,v,D,k={}.hasOwnProperty;D=yr(),R=D.isObject,S=D.isFunction,v=D.isPlainObject,l=zs(),e=Bs(),t=Gs(),f=no(),y=ro(),h=io(),a=Qs(),c=to(),r=Ys(),s=Js(),i=Zs(),o=eo(),n=Du(),b=Tu(),C=va(),rp.exports=u=function(){function x(F,N,U){var J;F||(F={}),F.writer?v(F.writer)&&(J=F.writer,F.writer=new C(J)):F.writer=new C(F),this.options=F,this.writer=F.writer,this.stringify=new b(F),this.onDataCallback=N||function(){},this.onEndCallback=U||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return x.prototype.node=function(F,N,U){var J;if(F==null)throw new Error("Missing node name");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node");return this.openCurrent(),F=F.valueOf(),N==null&&(N={}),N=N.valueOf(),R(N)||(J=[N,U],U=J[0],N=J[1]),this.currentNode=new l(this,F,N),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,U!=null&&this.text(U),this},x.prototype.element=function(F,N,U){return this.currentNode&&this.currentNode instanceof c?this.dtdElement.apply(this,arguments):this.node(F,N,U)},x.prototype.attribute=function(F,N){var U,J;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode");if(F!=null&&(F=F.valueOf()),R(F))for(U in F)!k.call(F,U)||(J=F[U],this.attribute(U,J));else S(N)&&(N=N.apply()),(!this.options.skipNullAttributes||N!=null)&&(this.currentNode.attributes[F]=new n(this,F,N));return this},x.prototype.text=function(F){var N;return this.openCurrent(),N=new y(this,F),this.onData(this.writer.text(N,this.currentLevel+1)),this},x.prototype.cdata=function(F){var N;return this.openCurrent(),N=new e(this,F),this.onData(this.writer.cdata(N,this.currentLevel+1)),this},x.prototype.comment=function(F){var N;return this.openCurrent(),N=new t(this,F),this.onData(this.writer.comment(N,this.currentLevel+1)),this},x.prototype.raw=function(F){var N;return this.openCurrent(),N=new f(this,F),this.onData(this.writer.raw(N,this.currentLevel+1)),this},x.prototype.instruction=function(F,N){var U,J,te,ie,_e;if(this.openCurrent(),F!=null&&(F=F.valueOf()),N!=null&&(N=N.valueOf()),Array.isArray(F))for(U=0,ie=F.length;U<ie;U++)J=F[U],this.instruction(J);else if(R(F))for(J in F)!k.call(F,J)||(te=F[J],this.instruction(J,te));else S(N)&&(N=N.apply()),_e=new h(this,F,N),this.onData(this.writer.processingInstruction(_e,this.currentLevel+1));return this},x.prototype.declaration=function(F,N,U){var J;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node");return J=new a(this,F,N,U),this.onData(this.writer.declaration(J,this.currentLevel+1)),this},x.prototype.doctype=function(F,N,U){if(this.openCurrent(),F==null)throw new Error("Missing root node name");if(this.root)throw new Error("dtd() must come before the root node");return this.currentNode=new c(this,N,U),this.currentNode.rootNodeName=F,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},x.prototype.dtdElement=function(F,N){var U;return this.openCurrent(),U=new i(this,F,N),this.onData(this.writer.dtdElement(U,this.currentLevel+1)),this},x.prototype.attList=function(F,N,U,J,te){var ie;return this.openCurrent(),ie=new r(this,F,N,U,J,te),this.onData(this.writer.dtdAttList(ie,this.currentLevel+1)),this},x.prototype.entity=function(F,N){var U;return this.openCurrent(),U=new s(this,!1,F,N),this.onData(this.writer.dtdEntity(U,this.currentLevel+1)),this},x.prototype.pEntity=function(F,N){var U;return this.openCurrent(),U=new s(this,!0,F,N),this.onData(this.writer.dtdEntity(U,this.currentLevel+1)),this},x.prototype.notation=function(F,N){var U;return this.openCurrent(),U=new o(this,F,N),this.onData(this.writer.dtdNotation(U,this.currentLevel+1)),this},x.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},x.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},x.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},x.prototype.openNode=function(F){if(!F.isOpen)return!this.root&&this.currentLevel===0&&F instanceof l&&(this.root=F),this.onData(this.writer.openNode(F,this.currentLevel)),F.isOpen=!0},x.prototype.closeNode=function(F){if(!F.isClosed)return this.onData(this.writer.closeNode(F,this.currentLevel)),F.isClosed=!0},x.prototype.onData=function(F){return this.documentStarted=!0,this.onDataCallback(F)},x.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},x.prototype.ele=function(){return this.element.apply(this,arguments)},x.prototype.nod=function(F,N,U){return this.node(F,N,U)},x.prototype.txt=function(F){return this.text(F)},x.prototype.dat=function(F){return this.cdata(F)},x.prototype.com=function(F){return this.comment(F)},x.prototype.ins=function(F,N){return this.instruction(F,N)},x.prototype.dec=function(F,N,U){return this.declaration(F,N,U)},x.prototype.dtd=function(F,N,U){return this.doctype(F,N,U)},x.prototype.e=function(F,N,U){return this.element(F,N,U)},x.prototype.n=function(F,N,U){return this.node(F,N,U)},x.prototype.t=function(F){return this.text(F)},x.prototype.d=function(F){return this.cdata(F)},x.prototype.c=function(F){return this.comment(F)},x.prototype.r=function(F){return this.raw(F)},x.prototype.i=function(F,N){return this.instruction(F,N)},x.prototype.att=function(){return this.currentNode&&this.currentNode instanceof c?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},x.prototype.a=function(){return this.currentNode&&this.currentNode instanceof c?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},x.prototype.ent=function(F,N){return this.entity(F,N)},x.prototype.pent=function(F,N){return this.pEntity(F,N)},x.prototype.not=function(F,N){return this.notation(F,N)},x}()}).call(np)});var ap=L((sp,op)=>{(function(){var n,e,t,r,i,s,o,a,c,u,l,h,f,C,b=function(S,R){for(var v in R)y.call(R,v)&&(S[v]=R[v]);function D(){this.constructor=S}return D.prototype=R.prototype,S.prototype=new D,S.__super__=R.prototype,S},y={}.hasOwnProperty;o=Qs(),a=to(),n=Bs(),e=Gs(),c=zs(),l=no(),f=ro(),u=io(),t=Ys(),r=Zs(),i=Js(),s=eo(),C=Su(),op.exports=h=function(S){b(R,S);function R(v,D){R.__super__.constructor.call(this,D),this.stream=v}return R.prototype.document=function(v){var D,k,x,F,N,U,J,te;for(U=v.children,k=0,F=U.length;k<F;k++)D=U[k],D.isLastRootNode=!1;for(v.children[v.children.length-1].isLastRootNode=!0,J=v.children,te=[],x=0,N=J.length;x<N;x++)switch(D=J[x],!1){case!(D instanceof o):te.push(this.declaration(D));break;case!(D instanceof a):te.push(this.docType(D));break;case!(D instanceof e):te.push(this.comment(D));break;case!(D instanceof u):te.push(this.processingInstruction(D));break;default:te.push(this.element(D))}return te},R.prototype.attribute=function(v){return this.stream.write(" "+v.name+'="'+v.value+'"')},R.prototype.cdata=function(v,D){return this.stream.write(this.space(D)+"<![CDATA["+v.text+"]]>"+this.endline(v))},R.prototype.comment=function(v,D){return this.stream.write(this.space(D)+"<!-- "+v.text+" -->"+this.endline(v))},R.prototype.declaration=function(v,D){return this.stream.write(this.space(D)),this.stream.write('<?xml version="'+v.version+'"'),v.encoding!=null&&this.stream.write(' encoding="'+v.encoding+'"'),v.standalone!=null&&this.stream.write(' standalone="'+v.standalone+'"'),this.stream.write(this.spacebeforeslash+"?>"),this.stream.write(this.endline(v))},R.prototype.docType=function(v,D){var k,x,F,N;if(D||(D=0),this.stream.write(this.space(D)),this.stream.write("<!DOCTYPE "+v.root().name),v.pubID&&v.sysID?this.stream.write(' PUBLIC "'+v.pubID+'" "'+v.sysID+'"'):v.sysID&&this.stream.write(' SYSTEM "'+v.sysID+'"'),v.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(v)),N=v.children,x=0,F=N.length;x<F;x++)switch(k=N[x],!1){case!(k instanceof t):this.dtdAttList(k,D+1);break;case!(k instanceof r):this.dtdElement(k,D+1);break;case!(k instanceof i):this.dtdEntity(k,D+1);break;case!(k instanceof s):this.dtdNotation(k,D+1);break;case!(k instanceof n):this.cdata(k,D+1);break;case!(k instanceof e):this.comment(k,D+1);break;case!(k instanceof u):this.processingInstruction(k,D+1);break;default:throw new Error("Unknown DTD node type: "+k.constructor.name)}this.stream.write("]")}return this.stream.write(this.spacebeforeslash+">"),this.stream.write(this.endline(v))},R.prototype.element=function(v,D){var k,x,F,N,U,J,te,ie;D||(D=0),ie=this.space(D),this.stream.write(ie+"<"+v.name),J=v.attributes;for(U in J)!y.call(J,U)||(k=J[U],this.attribute(k));if(v.children.length===0||v.children.every(function(_e){return _e.value===""}))this.allowEmpty?this.stream.write("></"+v.name+">"):this.stream.write(this.spacebeforeslash+"/>");else if(this.pretty&&v.children.length===1&&v.children[0].value!=null)this.stream.write(">"),this.stream.write(v.children[0].value),this.stream.write("</"+v.name+">");else{for(this.stream.write(">"+this.newline),te=v.children,F=0,N=te.length;F<N;F++)switch(x=te[F],!1){case!(x instanceof n):this.cdata(x,D+1);break;case!(x instanceof e):this.comment(x,D+1);break;case!(x instanceof c):this.element(x,D+1);break;case!(x instanceof l):this.raw(x,D+1);break;case!(x instanceof f):this.text(x,D+1);break;case!(x instanceof u):this.processingInstruction(x,D+1);break;default:throw new Error("Unknown XML node type: "+x.constructor.name)}this.stream.write(ie+"</"+v.name+">")}return this.stream.write(this.endline(v))},R.prototype.processingInstruction=function(v,D){return this.stream.write(this.space(D)+"<?"+v.target),v.value&&this.stream.write(" "+v.value),this.stream.write(this.spacebeforeslash+"?>"+this.endline(v))},R.prototype.raw=function(v,D){return this.stream.write(this.space(D)+v.value+this.endline(v))},R.prototype.text=function(v,D){return this.stream.write(this.space(D)+v.value+this.endline(v))},R.prototype.dtdAttList=function(v,D){return this.stream.write(this.space(D)+"<!ATTLIST "+v.elementName+" "+v.attributeName+" "+v.attributeType),v.defaultValueType!=="#DEFAULT"&&this.stream.write(" "+v.defaultValueType),v.defaultValue&&this.stream.write(' "'+v.defaultValue+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(v))},R.prototype.dtdElement=function(v,D){return this.stream.write(this.space(D)+"<!ELEMENT "+v.name+" "+v.value),this.stream.write(this.spacebeforeslash+">"+this.endline(v))},R.prototype.dtdEntity=function(v,D){return this.stream.write(this.space(D)+"<!ENTITY"),v.pe&&this.stream.write(" %"),this.stream.write(" "+v.name),v.value?this.stream.write(' "'+v.value+'"'):(v.pubID&&v.sysID?this.stream.write(' PUBLIC "'+v.pubID+'" "'+v.sysID+'"'):v.sysID&&this.stream.write(' SYSTEM "'+v.sysID+'"'),v.nData&&this.stream.write(" NDATA "+v.nData)),this.stream.write(this.spacebeforeslash+">"+this.endline(v))},R.prototype.dtdNotation=function(v,D){return this.stream.write(this.space(D)+"<!NOTATION "+v.name),v.pubID&&v.sysID?this.stream.write(' PUBLIC "'+v.pubID+'" "'+v.sysID+'"'):v.pubID?this.stream.write(' PUBLIC "'+v.pubID+'"'):v.sysID&&this.stream.write(' SYSTEM "'+v.sysID+'"'),this.stream.write(this.spacebeforeslash+">"+this.endline(v))},R.prototype.endline=function(v){return v.isLastRootNode?"":this.newline},R}(C)}).call(sp)});var up=L((cp,so)=>{(function(){var n,e,t,r,i,s,o;o=yr(),i=o.assign,s=o.isFunction,n=tp(),e=ip(),r=va(),t=ap(),so.exports.create=function(a,c,u,l){var h,f;if(a==null)throw new Error("Root element needs a name");return l=i({},c,u,l),h=new n(l),f=h.element(a),l.headless||(h.declaration(l),(l.pubID!=null||l.sysID!=null)&&h.doctype(l)),f},so.exports.begin=function(a,c,u){var l;return s(a)&&(l=[a,c],c=l[0],u=l[1],a={}),c?new e(a,c,u):new n(a)},so.exports.stringWriter=function(a){return new r(a)},so.exports.streamWriter=function(a,c){return new t(a,c)}}).call(cp)});var hp=L(fp=>{var lp=vh(),bD=up();fp.build=TD;function CD(n){function e(t){return t<10?"0"+t:t}return n.getUTCFullYear()+"-"+e(n.getUTCMonth()+1)+"-"+e(n.getUTCDate())+"T"+e(n.getUTCHours())+":"+e(n.getUTCMinutes())+":"+e(n.getUTCSeconds())+"Z"}var DD=Object.prototype.toString;function dp(n){var e=DD.call(n).match(/\[object (.*)\]/);return e&&e[1]}function TD(n,e){var t={version:"1.0",encoding:"UTF-8"},r={pubid:"-//Apple//DTD PLIST 1.0//EN",sysid:"http://www.apple.com/DTDs/PropertyList-1.0.dtd"},i=bD.create("plist");return i.dec(t.version,t.encoding,t.standalone),i.dtd(r.pubid,r.sysid),i.att("version","1.0"),Ru(n,i),e||(e={}),e.pretty=e.pretty!==!1,i.end(e)}function Ru(n,e){var t,r,i,s=dp(n);if(s!="Undefined")if(Array.isArray(n))for(e=e.ele("array"),r=0;r<n.length;r++)Ru(n[r],e);else if(Buffer.isBuffer(n))e.ele("data").raw(n.toString("base64"));else if(s=="Object"){e=e.ele("dict");for(i in n)n.hasOwnProperty(i)&&(e.ele("key").txt(i),Ru(n[i],e))}else s=="Number"?(t=n%1==0?"integer":"real",e.ele(t).txt(n.toString())):s=="Date"?e.ele("date").txt(CD(new Date(n))):s=="Boolean"?e.ele(n?"true":"false"):s=="String"?e.ele("string").txt(n):s=="ArrayBuffer"?e.ele("data").raw(lp.fromByteArray(n)):n&&n.buffer&&dp(n.buffer)=="ArrayBuffer"&&e.ele("data").raw(lp.fromByteArray(new Uint8Array(n.buffer),e))}});var mp=L(ku=>{var pp=ph();Object.keys(pp).forEach(function(n){ku[n]=pp[n]});var gp=hp();Object.keys(gp).forEach(function(n){ku[n]=gp[n]})});var xp=L((oI,Mu)=>{var Ep=require("fs"),ND=require("path"),qD=Ep.exists||ND.exists,Lu=function(n,e){var t=[],r;["end_of_record"].concat(n.split(`
`)).forEach(function(i){i=i.trim();var s=i.split(":"),o=[s.shift(),s.join(":")],a,c;switch(o[0].toUpperCase()){case"TN":r.title=o[1].trim();break;case"SF":r.file=o.slice(1).join(":").trim();break;case"FNF":r.functions.found=Number(o[1].trim());break;case"FNH":r.functions.hit=Number(o[1].trim());break;case"LF":r.lines.found=Number(o[1].trim());break;case"LH":r.lines.hit=Number(o[1].trim());break;case"DA":a=o[1].split(","),r.lines.details.push({line:Number(a[0]),hit:Number(a[1])});break;case"FN":c=o[1].split(","),r.functions.details.push({name:c[1],line:Number(c[0])});break;case"FNDA":c=o[1].split(","),r.functions.details.some(function(u,l){if(u.name===c[1]&&u.hit===void 0)return r.functions.details[l].hit=Number(c[0]),!0});break;case"BRDA":c=o[1].split(","),r.branches.details.push({line:Number(c[0]),block:Number(c[1]),branch:Number(c[2]),taken:c[3]==="-"?0:Number(c[3])});break;case"BRF":r.branches.found=Number(o[1]);break;case"BRH":r.branches.hit=Number(o[1]);break}i.indexOf("end_of_record")>-1&&(t.push(r),r={lines:{found:0,hit:0,details:[]},functions:{hit:0,found:0,details:[]},branches:{hit:0,found:0,details:[]}})}),t.shift(),t.length?e(null,t):e("Failed to parse string")},LD=function(n,e){qD(n,function(t){if(!t)return Lu(n,e);Ep.readFile(n,"utf8",function(r,i){Lu(i,e)})})};Mu.exports=LD;Mu.exports.source=Lu});var Rn=L(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.asPromise=ct.thenable=ct.typedArray=ct.stringArray=ct.array=ct.func=ct.error=ct.number=ct.string=ct.boolean=void 0;function $D(n){return n===!0||n===!1}ct.boolean=$D;function $p(n){return typeof n=="string"||n instanceof String}ct.string=$p;function jD(n){return typeof n=="number"||n instanceof Number}ct.number=jD;function WD(n){return n instanceof Error}ct.error=WD;function jp(n){return typeof n=="function"}ct.func=jp;function Wp(n){return Array.isArray(n)}ct.array=Wp;function HD(n){return Wp(n)&&n.every(e=>$p(e))}ct.stringArray=HD;function UD(n,e){return Array.isArray(n)&&n.every(e)}ct.typedArray=UD;function Hp(n){return n&&jp(n.then)}ct.thenable=Hp;function KD(n){return n instanceof Promise?n:Hp(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}ct.asPromise=KD});var Zi=L(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.stringArray=Lt.array=Lt.func=Lt.error=Lt.number=Lt.string=Lt.boolean=void 0;function VD(n){return n===!0||n===!1}Lt.boolean=VD;function Up(n){return typeof n=="string"||n instanceof String}Lt.string=Up;function XD(n){return typeof n=="number"||n instanceof Number}Lt.number=XD;function zD(n){return n instanceof Error}Lt.error=zD;function BD(n){return typeof n=="function"}Lt.func=BD;function Kp(n){return Array.isArray(n)}Lt.array=Kp;function GD(n){return Kp(n)&&n.every(e=>Up(e))}Lt.stringArray=GD});var Wu=L(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.Message=re.NotificationType9=re.NotificationType8=re.NotificationType7=re.NotificationType6=re.NotificationType5=re.NotificationType4=re.NotificationType3=re.NotificationType2=re.NotificationType1=re.NotificationType0=re.NotificationType=re.RequestType9=re.RequestType8=re.RequestType7=re.RequestType6=re.RequestType5=re.RequestType4=re.RequestType3=re.RequestType2=re.RequestType1=re.RequestType=re.RequestType0=re.AbstractMessageSignature=re.ParameterStructures=re.ResponseError=re.ErrorCodes=void 0;var vi=Zi(),Vp;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})(Vp=re.ErrorCodes||(re.ErrorCodes={}));var xa=class extends Error{constructor(e,t,r){super(t);this.code=vi.number(e)?e:Vp.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,xa.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};re.ResponseError=xa;var _t=class{constructor(e){this.kind=e}static is(e){return e===_t.auto||e===_t.byName||e===_t.byPosition}toString(){return this.kind}};re.ParameterStructures=_t;_t.auto=new _t("auto");_t.byPosition=new _t("byPosition");_t.byName=new _t("byName");var Ye=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return _t.auto}};re.AbstractMessageSignature=Ye;var Xp=class extends Ye{constructor(e){super(e,0)}};re.RequestType0=Xp;var zp=class extends Ye{constructor(e,t=_t.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};re.RequestType=zp;var Bp=class extends Ye{constructor(e,t=_t.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};re.RequestType1=Bp;var Gp=class extends Ye{constructor(e){super(e,2)}};re.RequestType2=Gp;var Qp=class extends Ye{constructor(e){super(e,3)}};re.RequestType3=Qp;var Yp=class extends Ye{constructor(e){super(e,4)}};re.RequestType4=Yp;var Jp=class extends Ye{constructor(e){super(e,5)}};re.RequestType5=Jp;var Zp=class extends Ye{constructor(e){super(e,6)}};re.RequestType6=Zp;var eg=class extends Ye{constructor(e){super(e,7)}};re.RequestType7=eg;var tg=class extends Ye{constructor(e){super(e,8)}};re.RequestType8=tg;var ng=class extends Ye{constructor(e){super(e,9)}};re.RequestType9=ng;var rg=class extends Ye{constructor(e,t=_t.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};re.NotificationType=rg;var ig=class extends Ye{constructor(e){super(e,0)}};re.NotificationType0=ig;var sg=class extends Ye{constructor(e,t=_t.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};re.NotificationType1=sg;var og=class extends Ye{constructor(e){super(e,2)}};re.NotificationType2=og;var ag=class extends Ye{constructor(e){super(e,3)}};re.NotificationType3=ag;var cg=class extends Ye{constructor(e){super(e,4)}};re.NotificationType4=cg;var ug=class extends Ye{constructor(e){super(e,5)}};re.NotificationType5=ug;var lg=class extends Ye{constructor(e){super(e,6)}};re.NotificationType6=lg;var dg=class extends Ye{constructor(e){super(e,7)}};re.NotificationType7=dg;var fg=class extends Ye{constructor(e){super(e,8)}};re.NotificationType8=fg;var hg=class extends Ye{constructor(e){super(e,9)}};re.NotificationType9=hg;var QD;(function(n){function e(i){let s=i;return s&&vi.string(s.method)&&(vi.string(s.id)||vi.number(s.id))}n.isRequest=e;function t(i){let s=i;return s&&vi.string(s.method)&&i.id===void 0}n.isNotification=t;function r(i){let s=i;return s&&(s.result!==void 0||!!s.error)&&(vi.string(s.id)||vi.number(s.id)||s.id===null)}n.isResponse=r})(QD=re.Message||(re.Message={}))});var Uu=L(Cr=>{"use strict";var pg;Object.defineProperty(Cr,"__esModule",{value:!0});Cr.LRUCache=Cr.LinkedMap=Cr.Touch=void 0;var Kt;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(Kt=Cr.Touch||(Cr.Touch={}));var Hu=class{constructor(){this[pg]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=Kt.None){let r=this._map.get(e);if(!!r)return t!==Kt.None&&this.touch(r,t),r.value}set(e,t,r=Kt.None){let i=this._map.get(e);if(i)i.value=t,r!==Kt.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case Kt.None:this.addItemLast(i);break;case Kt.First:this.addItemFirst(i);break;case Kt.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(!!t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(pg=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==Kt.First&&t!==Kt.Last)){if(t===Kt.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Kt.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}};Cr.LinkedMap=Hu;var gg=class extends Hu{constructor(e,t=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Kt.AsNew){return super.get(e,t)}peek(e){return super.get(e,Kt.None)}set(e,t){return super.set(e,t,Kt.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};Cr.LRUCache=gg});var mg=L(ho=>{"use strict";Object.defineProperty(ho,"__esModule",{value:!0});ho.Disposable=void 0;var YD;(function(n){function e(t){return{dispose:t}}n.create=e})(YD=ho.Disposable||(ho.Disposable={}))});var Gr=L(Xu=>{"use strict";Object.defineProperty(Xu,"__esModule",{value:!0});var Ku;function Vu(){if(Ku===void 0)throw new Error("No runtime abstraction layer installed");return Ku}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");Ku=t}n.install=e})(Vu||(Vu={}));Xu.default=Vu});var es=L(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:!0});yi.Emitter=yi.Event=void 0;var JD=Gr(),ZD;(function(n){let e={dispose(){}};n.None=function(){return e}})(ZD=yi.Event||(yi.Event={}));var vg=class{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let s=0,o=r.length;s<o;s++)try{t.push(r[s].apply(i[s],e))}catch(a){(0,JD.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},po=class{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new vg),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{!this._callbacks||(this._callbacks.remove(e,t),i.dispose=po._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};yi.Emitter=po;po._noop=function(){}});var Fa=L(wi=>{"use strict";Object.defineProperty(wi,"__esModule",{value:!0});wi.CancellationTokenSource=wi.CancellationToken=void 0;var eT=Gr(),tT=Zi(),zu=es(),Bu;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:zu.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:zu.Event.None});function e(t){let r=t;return r&&(r===n.None||r===n.Cancelled||tT.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(Bu=wi.CancellationToken||(wi.CancellationToken={}));var nT=Object.freeze(function(n,e){let t=(0,eT.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}}),Gu=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?nT:(this._emitter||(this._emitter=new zu.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},yg=class{get token(){return this._token||(this._token=new Gu),this._token}cancel(){this._token?this._token.cancel():this._token=Bu.Cancelled}dispose(){this._token?this._token instanceof Gu&&this._token.dispose():this._token=Bu.None}};wi.CancellationTokenSource=yg});var Tg=L(ts=>{"use strict";Object.defineProperty(ts,"__esModule",{value:!0});ts.SharedArrayReceiverStrategy=ts.SharedArraySenderStrategy=void 0;var rT=Fa(),go;(function(n){n.Continue=0,n.Cancelled=1})(go||(go={}));var wg=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let t=new SharedArrayBuffer(4),r=new Int32Array(t,0,1);r[0]=go.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){let r=this.buffers.get(t);if(r===void 0)return;let i=new Int32Array(r,0,1);Atomics.store(i,0,go.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};ts.SharedArraySenderStrategy=wg;var bg=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===go.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},Cg=class{constructor(e){this.token=new bg(e)}cancel(){}dispose(){}},Dg=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let t=e.$cancellationData;return t===void 0?new rT.CancellationTokenSource:new Cg(t)}};ts.SharedArrayReceiverStrategy=Dg});var Qu=L(Ia=>{"use strict";Object.defineProperty(Ia,"__esModule",{value:!0});Ia.Semaphore=void 0;var iT=Gr(),Sg=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,iT.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};Ia.Semaphore=Sg});var kg=L(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});Dr.ReadableStreamMessageReader=Dr.AbstractMessageReader=Dr.MessageReader=void 0;var Yu=Gr(),ns=Zi(),Ju=es(),sT=Qu(),oT;(function(n){function e(t){let r=t;return r&&ns.func(r.listen)&&ns.func(r.dispose)&&ns.func(r.onError)&&ns.func(r.onClose)&&ns.func(r.onPartialMessage)}n.is=e})(oT=Dr.MessageReader||(Dr.MessageReader={}));var Zu=class{constructor(){this.errorEmitter=new Ju.Emitter,this.closeEmitter=new Ju.Emitter,this.partialMessageEmitter=new Ju.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${ns.string(e.message)?e.message:"unknown"}`)}};Dr.AbstractMessageReader=Zu;var el;(function(n){function e(t){let r,i,s,o=new Map,a,c=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(s=t.contentDecoder,o.set(s.name,s)),t.contentDecoders!==void 0)for(let u of t.contentDecoders)o.set(u.name,u);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,c.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let u of t.contentTypeDecoders)c.set(u.name,u)}return a===void 0&&(a=(0,Yu.default)().applicationJson.decoder,c.set(a.name,a)),{charset:r,contentDecoder:s,contentDecoders:o,contentTypeDecoder:a,contentTypeDecoders:c}}n.fromOptions=e})(el||(el={}));var Rg=class extends Zu{constructor(e,t){super();this.readable=e,this.options=el.fromOptions(t),this.buffer=(0,Yu.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new sT.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let r=this.buffer.tryReadHeaders(!0);if(!r)return;let i=r.get("content-length");if(!i){this.fireError(new Error("Header must provide a Content-Length property."));return}let s=parseInt(i);if(isNaN(s)){this.fireError(new Error("Content-Length value must be a number."));return}this.nextMessageLength=s}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let r=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,i=await this.options.contentTypeDecoder.decode(r,this.options);this.callback(i)}).catch(r=>{this.fireError(r)})}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,Yu.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};Dr.ReadableStreamMessageReader=Rg});var Fg=L(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.WriteableStreamMessageWriter=Tr.AbstractMessageWriter=Tr.MessageWriter=void 0;var Pg=Gr(),mo=Zi(),aT=Qu(),_g=es(),cT="Content-Length: ",Eg=`\r
`,uT;(function(n){function e(t){let r=t;return r&&mo.func(r.dispose)&&mo.func(r.onClose)&&mo.func(r.onError)&&mo.func(r.write)}n.is=e})(uT=Tr.MessageWriter||(Tr.MessageWriter={}));var tl=class{constructor(){this.errorEmitter=new _g.Emitter,this.closeEmitter=new _g.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${mo.string(e.message)?e.message:"unknown"}`)}};Tr.AbstractMessageWriter=tl;var nl;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,Pg.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,Pg.default)().applicationJson.encoder}}n.fromOptions=e})(nl||(nl={}));var xg=class extends tl{constructor(e,t){super();this.writable=e,this.options=nl.fromOptions(t),this.errorCount=0,this.writeSemaphore=new aT.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(cT,r.byteLength.toString(),Eg),i.push(Eg),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};Tr.WriteableStreamMessageWriter=xg});var Og=L(Oa=>{"use strict";Object.defineProperty(Oa,"__esModule",{value:!0});Oa.AbstractMessageBuffer=void 0;var lT=13,dT=10,fT=`\r
`,Ig=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,r=0,i=0,s=0;e:for(;r<this._chunks.length;){let u=this._chunks[r];i=0;t:for(;i<u.length;){switch(u[i]){case lT:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case dT:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}s+=u.byteLength,r++}if(t!==4)return;let o=this._read(s+i),a=new Map,c=this.toString(o,"ascii").split(fT);if(c.length<2)return a;for(let u=0;u<c.length-2;u++){let l=c[u],h=l.indexOf(":");if(h===-1)throw new Error("Message header must separate key and value using :");let f=l.substr(0,h),C=l.substr(h+1).trim();a.set(e?f.toLowerCase():f,C)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let s=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(s)}if(this._chunks[0].byteLength>e){let s=this._chunks[0],o=this.asNative(s,e);return this._chunks[0]=s.slice(e),this._totalLength-=e,o}let t=this.allocNative(e),r=0,i=0;for(;e>0;){let s=this._chunks[i];if(s.byteLength>e){let o=s.slice(0,e);t.set(o,r),r+=e,this._chunks[i]=s.slice(e),this._totalLength-=e,e-=e}else t.set(s,r),r+=s.byteLength,this._chunks.shift(),this._totalLength-=s.byteLength,e-=s.byteLength}return t}};Oa.AbstractMessageBuffer=Ig});var Wg=L(ne=>{"use strict";Object.defineProperty(ne,"__esModule",{value:!0});ne.createMessageConnection=ne.ConnectionOptions=ne.MessageStrategy=ne.CancellationStrategy=ne.CancellationSenderStrategy=ne.CancellationReceiverStrategy=ne.RequestCancellationReceiverStrategy=ne.IdCancellationReceiverStrategy=ne.ConnectionStrategy=ne.ConnectionError=ne.ConnectionErrors=ne.LogTraceNotification=ne.SetTraceNotification=ne.TraceFormat=ne.TraceValues=ne.Trace=ne.NullLogger=ne.ProgressType=ne.ProgressToken=void 0;var Ng=Gr(),tt=Zi(),oe=Wu(),qg=Uu(),vo=es(),rl=Fa(),yo;(function(n){n.type=new oe.NotificationType("$/cancelRequest")})(yo||(yo={}));var Lg;(function(n){function e(t){return typeof t=="string"||typeof t=="number"}n.is=e})(Lg=ne.ProgressToken||(ne.ProgressToken={}));var wo;(function(n){n.type=new oe.NotificationType("$/progress")})(wo||(wo={}));var Mg=class{constructor(){}};ne.ProgressType=Mg;var il;(function(n){function e(t){return tt.func(t)}n.is=e})(il||(il={}));ne.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var $e;(function(n){n[n.Off=0]="Off",n[n.Messages=1]="Messages",n[n.Compact=2]="Compact",n[n.Verbose=3]="Verbose"})($e=ne.Trace||(ne.Trace={}));var hT;(function(n){n.Off="off",n.Messages="messages",n.Compact="compact",n.Verbose="verbose"})(hT=ne.TraceValues||(ne.TraceValues={}));(function(n){function e(r){if(!tt.string(r))return n.Off;switch(r=r.toLowerCase(),r){case"off":return n.Off;case"messages":return n.Messages;case"compact":return n.Compact;case"verbose":return n.Verbose;default:return n.Off}}n.fromString=e;function t(r){switch(r){case n.Off:return"off";case n.Messages:return"messages";case n.Compact:return"compact";case n.Verbose:return"verbose";default:return"off"}}n.toString=t})($e=ne.Trace||(ne.Trace={}));var Mn;(function(n){n.Text="text",n.JSON="json"})(Mn=ne.TraceFormat||(ne.TraceFormat={}));(function(n){function e(t){return tt.string(t)?(t=t.toLowerCase(),t==="json"?n.JSON:n.Text):n.Text}n.fromString=e})(Mn=ne.TraceFormat||(ne.TraceFormat={}));var Ag;(function(n){n.type=new oe.NotificationType("$/setTrace")})(Ag=ne.SetTraceNotification||(ne.SetTraceNotification={}));var sl;(function(n){n.type=new oe.NotificationType("$/logTrace")})(sl=ne.LogTraceNotification||(ne.LogTraceNotification={}));var Na;(function(n){n[n.Closed=1]="Closed",n[n.Disposed=2]="Disposed",n[n.AlreadyListening=3]="AlreadyListening"})(Na=ne.ConnectionErrors||(ne.ConnectionErrors={}));var bi=class extends Error{constructor(e,t){super(t);this.code=e,Object.setPrototypeOf(this,bi.prototype)}};ne.ConnectionError=bi;var $g;(function(n){function e(t){let r=t;return r&&tt.func(r.cancelUndispatched)}n.is=e})($g=ne.ConnectionStrategy||(ne.ConnectionStrategy={}));var ol;(function(n){function e(t){let r=t;return r&&(r.kind===void 0||r.kind==="id")&&tt.func(r.createCancellationTokenSource)&&(r.dispose===void 0||tt.func(r.dispose))}n.is=e})(ol=ne.IdCancellationReceiverStrategy||(ne.IdCancellationReceiverStrategy={}));var jg;(function(n){function e(t){let r=t;return r&&r.kind==="request"&&tt.func(r.createCancellationTokenSource)&&(r.dispose===void 0||tt.func(r.dispose))}n.is=e})(jg=ne.RequestCancellationReceiverStrategy||(ne.RequestCancellationReceiverStrategy={}));var al;(function(n){n.Message=Object.freeze({createCancellationTokenSource(t){return new rl.CancellationTokenSource}});function e(t){return ol.is(t)||jg.is(t)}n.is=e})(al=ne.CancellationReceiverStrategy||(ne.CancellationReceiverStrategy={}));var cl;(function(n){n.Message=Object.freeze({sendCancellation(t,r){return t.sendNotification(yo.type,{id:r})},cleanup(t){}});function e(t){let r=t;return r&&tt.func(r.sendCancellation)&&tt.func(r.cleanup)}n.is=e})(cl=ne.CancellationSenderStrategy||(ne.CancellationSenderStrategy={}));var ul;(function(n){n.Message=Object.freeze({receiver:al.Message,sender:cl.Message});function e(t){let r=t;return r&&al.is(r.receiver)&&cl.is(r.sender)}n.is=e})(ul=ne.CancellationStrategy||(ne.CancellationStrategy={}));var ll;(function(n){function e(t){let r=t;return r&&tt.func(r.handleMessage)}n.is=e})(ll=ne.MessageStrategy||(ne.MessageStrategy={}));var pT;(function(n){function e(t){let r=t;return r&&(ul.is(r.cancellationStrategy)||$g.is(r.connectionStrategy)||ll.is(r.messageStrategy))}n.is=e})(pT=ne.ConnectionOptions||(ne.ConnectionOptions={}));var An;(function(n){n[n.New=1]="New",n[n.Listening=2]="Listening",n[n.Closed=3]="Closed",n[n.Disposed=4]="Disposed"})(An||(An={}));function gT(n,e,t,r){let i=t!==void 0?t:ne.NullLogger,s=0,o=0,a=0,c="2.0",u,l=new Map,h,f=new Map,C=new Map,b,y=new qg.LinkedMap,S=new Map,R=new Set,v=new Map,D=$e.Off,k=Mn.Text,x,F=An.New,N=new vo.Emitter,U=new vo.Emitter,J=new vo.Emitter,te=new vo.Emitter,ie=new vo.Emitter,_e=r&&r.cancellationStrategy?r.cancellationStrategy:ul.Message;function Tt(P){if(P===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+P.toString()}function dt(P){return P===null?"res-unknown-"+(++a).toString():"res-"+P.toString()}function ft(){return"not-"+(++o).toString()}function me(P,$){oe.Message.isRequest($)?P.set(Tt($.id),$):oe.Message.isResponse($)?P.set(dt($.id),$):P.set(ft(),$)}function et(P){}function Ge(){return F===An.Listening}function jt(){return F===An.Closed}function Zt(){return F===An.Disposed}function Yn(){(F===An.New||F===An.Listening)&&(F=An.Closed,U.fire(void 0))}function It(P){N.fire([P,void 0,void 0])}function ci(P){N.fire(P)}n.onClose(Yn),n.onError(It),e.onClose(Yn),e.onError(ci);function Lr(){b||y.size===0||(b=(0,Ng.default)().timer.setImmediate(()=>{b=void 0,lr()}))}function ur(P){oe.Message.isRequest(P)?ui(P):oe.Message.isNotification(P)?Ar(P):oe.Message.isResponse(P)?Mr(P):fr(P)}function lr(){if(y.size===0)return;let P=y.shift();try{let $=r==null?void 0:r.messageStrategy;ll.is($)?$.handleMessage(P,ur):ur(P)}finally{Lr()}}let dr=P=>{try{if(oe.Message.isNotification(P)&&P.method===yo.type.method){let $=P.params.id,X=Tt($),Y=y.get(X);if(oe.Message.isRequest(Y)){let Re=r==null?void 0:r.connectionStrategy,ke=Re&&Re.cancelUndispatched?Re.cancelUndispatched(Y,et):et(Y);if(ke&&(ke.error!==void 0||ke.result!==void 0)){y.delete(X),v.delete($),ke.id=Y.id,Cn(ke,P.method,Date.now()),e.write(ke).catch(()=>i.error("Sending response for canceled message failed."));return}}let Ee=v.get($);if(Ee!==void 0){Ee.cancel(),Wt(P);return}else R.add($)}me(y,P)}finally{Lr()}};function ui(P){if(Zt())return;function $(fe,xe,g){let M={jsonrpc:c,id:P.id};fe instanceof oe.ResponseError?M.error=fe.toJson():M.result=fe===void 0?null:fe,Cn(M,xe,g),e.write(M).catch(()=>i.error("Sending response failed."))}function X(fe,xe,g){let M={jsonrpc:c,id:P.id,error:fe.toJson()};Cn(M,xe,g),e.write(M).catch(()=>i.error("Sending response failed."))}function Y(fe,xe,g){fe===void 0&&(fe=null);let M={jsonrpc:c,id:P.id,result:fe};Cn(M,xe,g),e.write(M).catch(()=>i.error("Sending response failed."))}jr(P);let Ee=l.get(P.method),Re,ke;Ee&&(Re=Ee.type,ke=Ee.handler);let We=Date.now();if(ke||u){let fe=P.id??String(Date.now()),xe=ol.is(_e.receiver)?_e.receiver.createCancellationTokenSource(fe):_e.receiver.createCancellationTokenSource(P);P.id!==null&&R.has(P.id)&&xe.cancel(),P.id!==null&&v.set(fe,xe);try{let g;if(ke)if(P.params===void 0){if(Re!==void 0&&Re.numberOfParams!==0){X(new oe.ResponseError(oe.ErrorCodes.InvalidParams,`Request ${P.method} defines ${Re.numberOfParams} params but received none.`),P.method,We);return}g=ke(xe.token)}else if(Array.isArray(P.params)){if(Re!==void 0&&Re.parameterStructures===oe.ParameterStructures.byName){X(new oe.ResponseError(oe.ErrorCodes.InvalidParams,`Request ${P.method} defines parameters by name but received parameters by position`),P.method,We);return}g=ke(...P.params,xe.token)}else{if(Re!==void 0&&Re.parameterStructures===oe.ParameterStructures.byPosition){X(new oe.ResponseError(oe.ErrorCodes.InvalidParams,`Request ${P.method} defines parameters by position but received parameters by name`),P.method,We);return}g=ke(P.params,xe.token)}else u&&(g=u(P.method,P.params,xe.token));let M=g;g?M.then?M.then(z=>{v.delete(fe),$(z,P.method,We)},z=>{v.delete(fe),z instanceof oe.ResponseError?X(z,P.method,We):z&&tt.string(z.message)?X(new oe.ResponseError(oe.ErrorCodes.InternalError,`Request ${P.method} failed with message: ${z.message}`),P.method,We):X(new oe.ResponseError(oe.ErrorCodes.InternalError,`Request ${P.method} failed unexpectedly without providing any details.`),P.method,We)}):(v.delete(fe),$(g,P.method,We)):(v.delete(fe),Y(g,P.method,We))}catch(g){v.delete(fe),g instanceof oe.ResponseError?$(g,P.method,We):g&&tt.string(g.message)?X(new oe.ResponseError(oe.ErrorCodes.InternalError,`Request ${P.method} failed with message: ${g.message}`),P.method,We):X(new oe.ResponseError(oe.ErrorCodes.InternalError,`Request ${P.method} failed unexpectedly without providing any details.`),P.method,We)}}else X(new oe.ResponseError(oe.ErrorCodes.MethodNotFound,`Unhandled method ${P.method}`),P.method,We)}function Mr(P){if(!Zt())if(P.id===null)P.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(P.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let $=P.id,X=S.get($);if(hr(P,X),X!==void 0){S.delete($);try{if(P.error){let Y=P.error;X.reject(new oe.ResponseError(Y.code,Y.message,Y.data))}else if(P.result!==void 0)X.resolve(P.result);else throw new Error("Should never happen.")}catch(Y){Y.message?i.error(`Response handler '${X.method}' failed with message: ${Y.message}`):i.error(`Response handler '${X.method}' failed unexpectedly.`)}}}}function Ar(P){if(Zt())return;let $,X;if(P.method===yo.type.method){let Y=P.params.id;R.delete(Y),Wt(P);return}else{let Y=f.get(P.method);Y&&(X=Y.handler,$=Y.type)}if(X||h)try{if(Wt(P),X)if(P.params===void 0)$!==void 0&&$.numberOfParams!==0&&$.parameterStructures!==oe.ParameterStructures.byName&&i.error(`Notification ${P.method} defines ${$.numberOfParams} params but received none.`),X();else if(Array.isArray(P.params)){let Y=P.params;P.method===wo.type.method&&Y.length===2&&Lg.is(Y[0])?X({token:Y[0],value:Y[1]}):($!==void 0&&($.parameterStructures===oe.ParameterStructures.byName&&i.error(`Notification ${P.method} defines parameters by name but received parameters by position`),$.numberOfParams!==P.params.length&&i.error(`Notification ${P.method} defines ${$.numberOfParams} params but received ${Y.length} arguments`)),X(...Y))}else $!==void 0&&$.parameterStructures===oe.ParameterStructures.byPosition&&i.error(`Notification ${P.method} defines parameters by position but received parameters by name`),X(P.params);else h&&h(P.method,P.params)}catch(Y){Y.message?i.error(`Notification handler '${P.method}' failed with message: ${Y.message}`):i.error(`Notification handler '${P.method}' failed unexpectedly.`)}else J.fire(P)}function fr(P){if(!P){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(P,null,4)}`);let $=P;if(tt.string($.id)||tt.number($.id)){let X=$.id,Y=S.get(X);Y&&Y.reject(new Error("The received response has neither a result nor an error property."))}}function wt(P){if(P!=null)switch(D){case $e.Verbose:return JSON.stringify(P,null,4);case $e.Compact:return JSON.stringify(P);default:return}}function $r(P){if(!(D===$e.Off||!x))if(k===Mn.Text){let $;(D===$e.Verbose||D===$e.Compact)&&P.params&&($=`Params: ${wt(P.params)}

`),x.log(`Sending request '${P.method} - (${P.id})'.`,$)}else ht("send-request",P)}function Jn(P){if(!(D===$e.Off||!x))if(k===Mn.Text){let $;(D===$e.Verbose||D===$e.Compact)&&(P.params?$=`Params: ${wt(P.params)}

`:$=`No parameters provided.

`),x.log(`Sending notification '${P.method}'.`,$)}else ht("send-notification",P)}function Cn(P,$,X){if(!(D===$e.Off||!x))if(k===Mn.Text){let Y;(D===$e.Verbose||D===$e.Compact)&&(P.error&&P.error.data?Y=`Error data: ${wt(P.error.data)}

`:P.result?Y=`Result: ${wt(P.result)}

`:P.error===void 0&&(Y=`No result returned.

`)),x.log(`Sending response '${$} - (${P.id})'. Processing request took ${Date.now()-X}ms`,Y)}else ht("send-response",P)}function jr(P){if(!(D===$e.Off||!x))if(k===Mn.Text){let $;(D===$e.Verbose||D===$e.Compact)&&P.params&&($=`Params: ${wt(P.params)}

`),x.log(`Received request '${P.method} - (${P.id})'.`,$)}else ht("receive-request",P)}function Wt(P){if(!(D===$e.Off||!x||P.method===sl.type.method))if(k===Mn.Text){let $;(D===$e.Verbose||D===$e.Compact)&&(P.params?$=`Params: ${wt(P.params)}

`:$=`No parameters provided.

`),x.log(`Received notification '${P.method}'.`,$)}else ht("receive-notification",P)}function hr(P,$){if(!(D===$e.Off||!x))if(k===Mn.Text){let X;if((D===$e.Verbose||D===$e.Compact)&&(P.error&&P.error.data?X=`Error data: ${wt(P.error.data)}

`:P.result?X=`Result: ${wt(P.result)}

`:P.error===void 0&&(X=`No result returned.

`)),$){let Y=P.error?` Request failed: ${P.error.message} (${P.error.code}).`:"";x.log(`Received response '${$.method} - (${P.id})' in ${Date.now()-$.timerStart}ms.${Y}`,X)}else x.log(`Received response ${P.id} without active response promise.`,X)}else ht("receive-response",P)}function ht(P,$){if(!x||D===$e.Off)return;let X={isLSPMessage:!0,type:P,message:$,timestamp:Date.now()};x.log(X)}function In(){if(jt())throw new bi(Na.Closed,"Connection is closed.");if(Zt())throw new bi(Na.Disposed,"Connection is disposed.")}function Ht(){if(Ge())throw new bi(Na.AlreadyListening,"Connection is already listening")}function pr(){if(!Ge())throw new Error("Call listen() first.")}function dn(P){return P===void 0?null:P}function gr(P){if(P!==null)return P}function Wr(P){return P!=null&&!Array.isArray(P)&&typeof P=="object"}function en(P,$){switch(P){case oe.ParameterStructures.auto:return Wr($)?gr($):[dn($)];case oe.ParameterStructures.byName:if(!Wr($))throw new Error("Received parameters by name but param is not an object literal.");return gr($);case oe.ParameterStructures.byPosition:return[dn($)];default:throw new Error(`Unknown parameter structure ${P.toString()}`)}}function Hr(P,$){let X,Y=P.numberOfParams;switch(Y){case 0:X=void 0;break;case 1:X=en(P.parameterStructures,$[0]);break;default:X=[];for(let Ee=0;Ee<$.length&&Ee<Y;Ee++)X.push(dn($[Ee]));if($.length<Y)for(let Ee=$.length;Ee<Y;Ee++)X.push(null);break}return X}let fn={sendNotification:(P,...$)=>{In();let X,Y;if(tt.string(P)){X=P;let Re=$[0],ke=0,We=oe.ParameterStructures.auto;oe.ParameterStructures.is(Re)&&(ke=1,We=Re);let fe=$.length,xe=fe-ke;switch(xe){case 0:Y=void 0;break;case 1:Y=en(We,$[ke]);break;default:if(We===oe.ParameterStructures.byName)throw new Error(`Received ${xe} parameters for 'by Name' notification parameter structure.`);Y=$.slice(ke,fe).map(g=>dn(g));break}}else{let Re=$;X=P.method,Y=Hr(P,Re)}let Ee={jsonrpc:c,method:X,params:Y};return Jn(Ee),e.write(Ee).catch(Re=>{throw i.error("Sending notification failed."),Re})},onNotification:(P,$)=>{In();let X;return tt.func(P)?h=P:$&&(tt.string(P)?(X=P,f.set(P,{type:void 0,handler:$})):(X=P.method,f.set(P.method,{type:P,handler:$}))),{dispose:()=>{X!==void 0?f.delete(X):h=void 0}}},onProgress:(P,$,X)=>{if(C.has($))throw new Error(`Progress handler for token ${$} already registered`);return C.set($,X),{dispose:()=>{C.delete($)}}},sendProgress:(P,$,X)=>fn.sendNotification(wo.type,{token:$,value:X}),onUnhandledProgress:te.event,sendRequest:(P,...$)=>{In(),pr();let X,Y,Ee;if(tt.string(P)){X=P;let fe=$[0],xe=$[$.length-1],g=0,M=oe.ParameterStructures.auto;oe.ParameterStructures.is(fe)&&(g=1,M=fe);let z=$.length;rl.CancellationToken.is(xe)&&(z=z-1,Ee=xe);let he=z-g;switch(he){case 0:Y=void 0;break;case 1:Y=en(M,$[g]);break;default:if(M===oe.ParameterStructures.byName)throw new Error(`Received ${he} parameters for 'by Name' request parameter structure.`);Y=$.slice(g,z).map(I=>dn(I));break}}else{let fe=$;X=P.method,Y=Hr(P,fe);let xe=P.numberOfParams;Ee=rl.CancellationToken.is(fe[xe])?fe[xe]:void 0}let Re=s++,ke;Ee&&(ke=Ee.onCancellationRequested(()=>{let fe=_e.sender.sendCancellation(fn,Re);return fe===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${Re}`),Promise.resolve()):fe.catch(()=>{i.log(`Sending cancellation messages for id ${Re} failed`)})}));let We={jsonrpc:c,id:Re,method:X,params:Y};return $r(We),typeof _e.sender.enableCancellation=="function"&&_e.sender.enableCancellation(We),new Promise(async(fe,xe)=>{let g=he=>{fe(he),_e.sender.cleanup(Re),ke==null||ke.dispose()},M=he=>{xe(he),_e.sender.cleanup(Re),ke==null||ke.dispose()},z={method:X,timerStart:Date.now(),resolve:g,reject:M};try{await e.write(We),S.set(Re,z)}catch(he){throw i.error("Sending request failed."),z.reject(new oe.ResponseError(oe.ErrorCodes.MessageWriteError,he.message?he.message:"Unknown reason")),he}})},onRequest:(P,$)=>{In();let X=null;return il.is(P)?(X=void 0,u=P):tt.string(P)?(X=null,$!==void 0&&(X=P,l.set(P,{handler:$,type:void 0}))):$!==void 0&&(X=P.method,l.set(P.method,{type:P,handler:$})),{dispose:()=>{X!==null&&(X!==void 0?l.delete(X):u=void 0)}}},hasPendingResponse:()=>S.size>0,trace:async(P,$,X)=>{let Y=!1,Ee=Mn.Text;X!==void 0&&(tt.boolean(X)?Y=X:(Y=X.sendNotification||!1,Ee=X.traceFormat||Mn.Text)),D=P,k=Ee,D===$e.Off?x=void 0:x=$,Y&&!jt()&&!Zt()&&await fn.sendNotification(Ag.type,{value:$e.toString(P)})},onError:N.event,onClose:U.event,onUnhandledNotification:J.event,onDispose:ie.event,end:()=>{e.end()},dispose:()=>{if(Zt())return;F=An.Disposed,ie.fire(void 0);let P=new oe.ResponseError(oe.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let $ of S.values())$.reject(P);S=new Map,v=new Map,R=new Set,y=new qg.LinkedMap,tt.func(e.dispose)&&e.dispose(),tt.func(n.dispose)&&n.dispose()},listen:()=>{In(),Ht(),F=An.Listening,n.listen(dr)},inspect:()=>{(0,Ng.default)().console.log("inspect")}};return fn.onNotification(sl.type,P=>{if(D===$e.Off||!x)return;let $=D===$e.Verbose||D===$e.Compact;x.log(P.message,$?P.verbose:void 0)}),fn.onNotification(wo.type,P=>{let $=C.get(P.token);$?$(P.value):te.fire(P)}),fn}ne.createMessageConnection=gT});var qa=L(A=>{"use strict";Object.defineProperty(A,"__esModule",{value:!0});A.ProgressType=A.ProgressToken=A.createMessageConnection=A.NullLogger=A.ConnectionOptions=A.ConnectionStrategy=A.AbstractMessageBuffer=A.WriteableStreamMessageWriter=A.AbstractMessageWriter=A.MessageWriter=A.ReadableStreamMessageReader=A.AbstractMessageReader=A.MessageReader=A.SharedArrayReceiverStrategy=A.SharedArraySenderStrategy=A.CancellationToken=A.CancellationTokenSource=A.Emitter=A.Event=A.Disposable=A.LRUCache=A.Touch=A.LinkedMap=A.ParameterStructures=A.NotificationType9=A.NotificationType8=A.NotificationType7=A.NotificationType6=A.NotificationType5=A.NotificationType4=A.NotificationType3=A.NotificationType2=A.NotificationType1=A.NotificationType0=A.NotificationType=A.ErrorCodes=A.ResponseError=A.RequestType9=A.RequestType8=A.RequestType7=A.RequestType6=A.RequestType5=A.RequestType4=A.RequestType3=A.RequestType2=A.RequestType1=A.RequestType0=A.RequestType=A.Message=A.RAL=void 0;A.MessageStrategy=A.CancellationStrategy=A.CancellationSenderStrategy=A.CancellationReceiverStrategy=A.ConnectionError=A.ConnectionErrors=A.LogTraceNotification=A.SetTraceNotification=A.TraceFormat=A.TraceValues=A.Trace=void 0;var Ve=Wu();Object.defineProperty(A,"Message",{enumerable:!0,get:function(){return Ve.Message}});Object.defineProperty(A,"RequestType",{enumerable:!0,get:function(){return Ve.RequestType}});Object.defineProperty(A,"RequestType0",{enumerable:!0,get:function(){return Ve.RequestType0}});Object.defineProperty(A,"RequestType1",{enumerable:!0,get:function(){return Ve.RequestType1}});Object.defineProperty(A,"RequestType2",{enumerable:!0,get:function(){return Ve.RequestType2}});Object.defineProperty(A,"RequestType3",{enumerable:!0,get:function(){return Ve.RequestType3}});Object.defineProperty(A,"RequestType4",{enumerable:!0,get:function(){return Ve.RequestType4}});Object.defineProperty(A,"RequestType5",{enumerable:!0,get:function(){return Ve.RequestType5}});Object.defineProperty(A,"RequestType6",{enumerable:!0,get:function(){return Ve.RequestType6}});Object.defineProperty(A,"RequestType7",{enumerable:!0,get:function(){return Ve.RequestType7}});Object.defineProperty(A,"RequestType8",{enumerable:!0,get:function(){return Ve.RequestType8}});Object.defineProperty(A,"RequestType9",{enumerable:!0,get:function(){return Ve.RequestType9}});Object.defineProperty(A,"ResponseError",{enumerable:!0,get:function(){return Ve.ResponseError}});Object.defineProperty(A,"ErrorCodes",{enumerable:!0,get:function(){return Ve.ErrorCodes}});Object.defineProperty(A,"NotificationType",{enumerable:!0,get:function(){return Ve.NotificationType}});Object.defineProperty(A,"NotificationType0",{enumerable:!0,get:function(){return Ve.NotificationType0}});Object.defineProperty(A,"NotificationType1",{enumerable:!0,get:function(){return Ve.NotificationType1}});Object.defineProperty(A,"NotificationType2",{enumerable:!0,get:function(){return Ve.NotificationType2}});Object.defineProperty(A,"NotificationType3",{enumerable:!0,get:function(){return Ve.NotificationType3}});Object.defineProperty(A,"NotificationType4",{enumerable:!0,get:function(){return Ve.NotificationType4}});Object.defineProperty(A,"NotificationType5",{enumerable:!0,get:function(){return Ve.NotificationType5}});Object.defineProperty(A,"NotificationType6",{enumerable:!0,get:function(){return Ve.NotificationType6}});Object.defineProperty(A,"NotificationType7",{enumerable:!0,get:function(){return Ve.NotificationType7}});Object.defineProperty(A,"NotificationType8",{enumerable:!0,get:function(){return Ve.NotificationType8}});Object.defineProperty(A,"NotificationType9",{enumerable:!0,get:function(){return Ve.NotificationType9}});Object.defineProperty(A,"ParameterStructures",{enumerable:!0,get:function(){return Ve.ParameterStructures}});var dl=Uu();Object.defineProperty(A,"LinkedMap",{enumerable:!0,get:function(){return dl.LinkedMap}});Object.defineProperty(A,"LRUCache",{enumerable:!0,get:function(){return dl.LRUCache}});Object.defineProperty(A,"Touch",{enumerable:!0,get:function(){return dl.Touch}});var mT=mg();Object.defineProperty(A,"Disposable",{enumerable:!0,get:function(){return mT.Disposable}});var Hg=es();Object.defineProperty(A,"Event",{enumerable:!0,get:function(){return Hg.Event}});Object.defineProperty(A,"Emitter",{enumerable:!0,get:function(){return Hg.Emitter}});var Ug=Fa();Object.defineProperty(A,"CancellationTokenSource",{enumerable:!0,get:function(){return Ug.CancellationTokenSource}});Object.defineProperty(A,"CancellationToken",{enumerable:!0,get:function(){return Ug.CancellationToken}});var Kg=Tg();Object.defineProperty(A,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return Kg.SharedArraySenderStrategy}});Object.defineProperty(A,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return Kg.SharedArrayReceiverStrategy}});var fl=kg();Object.defineProperty(A,"MessageReader",{enumerable:!0,get:function(){return fl.MessageReader}});Object.defineProperty(A,"AbstractMessageReader",{enumerable:!0,get:function(){return fl.AbstractMessageReader}});Object.defineProperty(A,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return fl.ReadableStreamMessageReader}});var hl=Fg();Object.defineProperty(A,"MessageWriter",{enumerable:!0,get:function(){return hl.MessageWriter}});Object.defineProperty(A,"AbstractMessageWriter",{enumerable:!0,get:function(){return hl.AbstractMessageWriter}});Object.defineProperty(A,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return hl.WriteableStreamMessageWriter}});var vT=Og();Object.defineProperty(A,"AbstractMessageBuffer",{enumerable:!0,get:function(){return vT.AbstractMessageBuffer}});var Et=Wg();Object.defineProperty(A,"ConnectionStrategy",{enumerable:!0,get:function(){return Et.ConnectionStrategy}});Object.defineProperty(A,"ConnectionOptions",{enumerable:!0,get:function(){return Et.ConnectionOptions}});Object.defineProperty(A,"NullLogger",{enumerable:!0,get:function(){return Et.NullLogger}});Object.defineProperty(A,"createMessageConnection",{enumerable:!0,get:function(){return Et.createMessageConnection}});Object.defineProperty(A,"ProgressToken",{enumerable:!0,get:function(){return Et.ProgressToken}});Object.defineProperty(A,"ProgressType",{enumerable:!0,get:function(){return Et.ProgressType}});Object.defineProperty(A,"Trace",{enumerable:!0,get:function(){return Et.Trace}});Object.defineProperty(A,"TraceValues",{enumerable:!0,get:function(){return Et.TraceValues}});Object.defineProperty(A,"TraceFormat",{enumerable:!0,get:function(){return Et.TraceFormat}});Object.defineProperty(A,"SetTraceNotification",{enumerable:!0,get:function(){return Et.SetTraceNotification}});Object.defineProperty(A,"LogTraceNotification",{enumerable:!0,get:function(){return Et.LogTraceNotification}});Object.defineProperty(A,"ConnectionErrors",{enumerable:!0,get:function(){return Et.ConnectionErrors}});Object.defineProperty(A,"ConnectionError",{enumerable:!0,get:function(){return Et.ConnectionError}});Object.defineProperty(A,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return Et.CancellationReceiverStrategy}});Object.defineProperty(A,"CancellationSenderStrategy",{enumerable:!0,get:function(){return Et.CancellationSenderStrategy}});Object.defineProperty(A,"CancellationStrategy",{enumerable:!0,get:function(){return Et.CancellationStrategy}});Object.defineProperty(A,"MessageStrategy",{enumerable:!0,get:function(){return Et.MessageStrategy}});var yT=Gr();A.RAL=yT.default});var Gg=L(gl=>{"use strict";Object.defineProperty(gl,"__esModule",{value:!0});var Vg=require("util"),Sr=qa(),bo=class extends Sr.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return bo.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new Vg.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};bo.emptyBuffer=Buffer.allocUnsafe(0);var Xg=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Sr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Sr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Sr.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),Sr.Disposable.create(()=>this.stream.off("data",e))}},zg=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Sr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Sr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Sr.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((r,i)=>{let s=o=>{o==null?r():i(o)};typeof e=="string"?this.stream.write(e,t,s):this.stream.write(e,s)})}end(){this.stream.end()}},Bg=Object.freeze({messageBuffer:Object.freeze({create:n=>new bo(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(n,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{try{return n instanceof Buffer?Promise.resolve(JSON.parse(n.toString(e.charset))):Promise.resolve(JSON.parse(new Vg.TextDecoder(e.charset).decode(n)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:n=>new Xg(n),asWritableStream:n=>new zg(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){let r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){let t=setImmediate(n,...e);return{dispose:()=>clearImmediate(t)}},setInterval(n,e,...t){let r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function pl(){return Bg}(function(n){function e(){Sr.RAL.install(Bg)}n.install=e})(pl||(pl={}));gl.default=pl});var Ci=L(Te=>{"use strict";var wT=Te&&Te.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),bT=Te&&Te.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&wT(e,n,t)};Object.defineProperty(Te,"__esModule",{value:!0});Te.createMessageConnection=Te.createServerSocketTransport=Te.createClientSocketTransport=Te.createServerPipeTransport=Te.createClientPipeTransport=Te.generateRandomPipeName=Te.StreamMessageWriter=Te.StreamMessageReader=Te.SocketMessageWriter=Te.SocketMessageReader=Te.PortMessageWriter=Te.PortMessageReader=Te.IPCMessageWriter=Te.IPCMessageReader=void 0;var rs=Gg();rs.default.install();var Qg=require("path"),CT=require("os"),DT=require("crypto"),La=require("net"),gn=qa();bT(qa(),Te);var Yg=class extends gn.AbstractMessageReader{constructor(e){super();this.process=e;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),gn.Disposable.create(()=>this.process.off("message",e))}};Te.IPCMessageReader=Yg;var Jg=class extends gn.AbstractMessageWriter{constructor(e){super();this.process=e,this.errorCount=0;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};Te.IPCMessageWriter=Jg;var Zg=class extends gn.AbstractMessageReader{constructor(e){super();this.onData=new gn.Emitter,e.on("close",()=>this.fireClose),e.on("error",t=>this.fireError(t)),e.on("message",t=>{this.onData.fire(t)})}listen(e){return this.onData.event(e)}};Te.PortMessageReader=Zg;var em=class extends gn.AbstractMessageWriter{constructor(e){super();this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",t=>this.fireError(t))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};Te.PortMessageWriter=em;var is=class extends gn.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,rs.default)().stream.asReadableStream(e),t)}};Te.SocketMessageReader=is;var ss=class extends gn.WriteableStreamMessageWriter{constructor(e,t){super((0,rs.default)().stream.asWritableStream(e),t);this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};Te.SocketMessageWriter=ss;var ml=class extends gn.ReadableStreamMessageReader{constructor(e,t){super((0,rs.default)().stream.asReadableStream(e),t)}};Te.StreamMessageReader=ml;var vl=class extends gn.WriteableStreamMessageWriter{constructor(e,t){super((0,rs.default)().stream.asWritableStream(e),t)}};Te.StreamMessageWriter=vl;var tm=process.env.XDG_RUNTIME_DIR,TT=new Map([["linux",107],["darwin",103]]);function ST(){let n=(0,DT.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${n}-sock`;let e;tm?e=Qg.join(tm,`vscode-ipc-${n}.sock`):e=Qg.join(CT.tmpdir(),`vscode-${n}.sock`);let t=TT.get(process.platform);return t!==void 0&&e.length>t&&(0,rs.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}Te.generateRandomPipeName=ST;function RT(n,e="utf-8"){let t,r=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,La.createServer)(a=>{o.close(),t([new is(a,e),new ss(a,e)])});o.on("error",s),o.listen(n,()=>{o.removeListener("error",s),i({onConnected:()=>r})})})}Te.createClientPipeTransport=RT;function kT(n,e="utf-8"){let t=(0,La.createConnection)(n);return[new is(t,e),new ss(t,e)]}Te.createServerPipeTransport=kT;function PT(n,e="utf-8"){let t,r=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,La.createServer)(a=>{o.close(),t([new is(a,e),new ss(a,e)])});o.on("error",s),o.listen(n,"127.0.0.1",()=>{o.removeListener("error",s),i({onConnected:()=>r})})})}Te.createClientSocketTransport=PT;function _T(n,e="utf-8"){let t=(0,La.createConnection)(n,"127.0.0.1");return[new is(t,e),new ss(t,e)]}Te.createServerSocketTransport=_T;function ET(n){let e=n;return e.read!==void 0&&e.addListener!==void 0}function xT(n){let e=n;return e.write!==void 0&&e.addListener!==void 0}function FT(n,e,t,r){t||(t=gn.NullLogger);let i=ET(n)?new ml(n):n,s=xT(e)?new vl(e):e;return gn.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,gn.createMessageConnection)(i,s,t,r)}Te.createMessageConnection=FT});var yl=L((UI,nm)=>{"use strict";nm.exports=Ci()});var Aa=L((rm,Ma)=>{(function(n){if(typeof Ma=="object"&&typeof Ma.exports=="object"){var e=n(require,rm);e!==void 0&&(Ma.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],n)})(function(n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var t;(function(m){function _(E){return typeof E=="string"}m.is=_})(t=e.DocumentUri||(e.DocumentUri={}));var r;(function(m){function _(E){return typeof E=="string"}m.is=_})(r=e.URI||(e.URI={}));var i;(function(m){m.MIN_VALUE=-2147483648,m.MAX_VALUE=2147483647;function _(E){return typeof E=="number"&&m.MIN_VALUE<=E&&E<=m.MAX_VALUE}m.is=_})(i=e.integer||(e.integer={}));var s;(function(m){m.MIN_VALUE=0,m.MAX_VALUE=2147483647;function _(E){return typeof E=="number"&&m.MIN_VALUE<=E&&E<=m.MAX_VALUE}m.is=_})(s=e.uinteger||(e.uinteger={}));var o;(function(m){function _(T,p){return T===Number.MAX_VALUE&&(T=s.MAX_VALUE),p===Number.MAX_VALUE&&(p=s.MAX_VALUE),{line:T,character:p}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&I.uinteger(p.line)&&I.uinteger(p.character)}m.is=E})(o=e.Position||(e.Position={}));var a;(function(m){function _(T,p,q,j){if(I.uinteger(T)&&I.uinteger(p)&&I.uinteger(q)&&I.uinteger(j))return{start:o.create(T,p),end:o.create(q,j)};if(o.is(T)&&o.is(p))return{start:T,end:p};throw new Error("Range#create called with invalid arguments[".concat(T,", ").concat(p,", ").concat(q,", ").concat(j,"]"))}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&o.is(p.start)&&o.is(p.end)}m.is=E})(a=e.Range||(e.Range={}));var c;(function(m){function _(T,p){return{uri:T,range:p}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&a.is(p.range)&&(I.string(p.uri)||I.undefined(p.uri))}m.is=E})(c=e.Location||(e.Location={}));var u;(function(m){function _(T,p,q,j){return{targetUri:T,targetRange:p,targetSelectionRange:q,originSelectionRange:j}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&a.is(p.targetRange)&&I.string(p.targetUri)&&a.is(p.targetSelectionRange)&&(a.is(p.originSelectionRange)||I.undefined(p.originSelectionRange))}m.is=E})(u=e.LocationLink||(e.LocationLink={}));var l;(function(m){function _(T,p,q,j){return{red:T,green:p,blue:q,alpha:j}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&I.numberRange(p.red,0,1)&&I.numberRange(p.green,0,1)&&I.numberRange(p.blue,0,1)&&I.numberRange(p.alpha,0,1)}m.is=E})(l=e.Color||(e.Color={}));var h;(function(m){function _(T,p){return{range:T,color:p}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&a.is(p.range)&&l.is(p.color)}m.is=E})(h=e.ColorInformation||(e.ColorInformation={}));var f;(function(m){function _(T,p,q){return{label:T,textEdit:p,additionalTextEdits:q}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&I.string(p.label)&&(I.undefined(p.textEdit)||x.is(p))&&(I.undefined(p.additionalTextEdits)||I.typedArray(p.additionalTextEdits,x.is))}m.is=E})(f=e.ColorPresentation||(e.ColorPresentation={}));var C;(function(m){m.Comment="comment",m.Imports="imports",m.Region="region"})(C=e.FoldingRangeKind||(e.FoldingRangeKind={}));var b;(function(m){function _(T,p,q,j,ce,Xe){var je={startLine:T,endLine:p};return I.defined(q)&&(je.startCharacter=q),I.defined(j)&&(je.endCharacter=j),I.defined(ce)&&(je.kind=ce),I.defined(Xe)&&(je.collapsedText=Xe),je}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&I.uinteger(p.startLine)&&I.uinteger(p.startLine)&&(I.undefined(p.startCharacter)||I.uinteger(p.startCharacter))&&(I.undefined(p.endCharacter)||I.uinteger(p.endCharacter))&&(I.undefined(p.kind)||I.string(p.kind))}m.is=E})(b=e.FoldingRange||(e.FoldingRange={}));var y;(function(m){function _(T,p){return{location:T,message:p}}m.create=_;function E(T){var p=T;return I.defined(p)&&c.is(p.location)&&I.string(p.message)}m.is=E})(y=e.DiagnosticRelatedInformation||(e.DiagnosticRelatedInformation={}));var S;(function(m){m.Error=1,m.Warning=2,m.Information=3,m.Hint=4})(S=e.DiagnosticSeverity||(e.DiagnosticSeverity={}));var R;(function(m){m.Unnecessary=1,m.Deprecated=2})(R=e.DiagnosticTag||(e.DiagnosticTag={}));var v;(function(m){function _(E){var T=E;return I.objectLiteral(T)&&I.string(T.href)}m.is=_})(v=e.CodeDescription||(e.CodeDescription={}));var D;(function(m){function _(T,p,q,j,ce,Xe){var je={range:T,message:p};return I.defined(q)&&(je.severity=q),I.defined(j)&&(je.code=j),I.defined(ce)&&(je.source=ce),I.defined(Xe)&&(je.relatedInformation=Xe),je}m.create=_;function E(T){var p,q=T;return I.defined(q)&&a.is(q.range)&&I.string(q.message)&&(I.number(q.severity)||I.undefined(q.severity))&&(I.integer(q.code)||I.string(q.code)||I.undefined(q.code))&&(I.undefined(q.codeDescription)||I.string((p=q.codeDescription)===null||p===void 0?void 0:p.href))&&(I.string(q.source)||I.undefined(q.source))&&(I.undefined(q.relatedInformation)||I.typedArray(q.relatedInformation,y.is))}m.is=E})(D=e.Diagnostic||(e.Diagnostic={}));var k;(function(m){function _(T,p){for(var q=[],j=2;j<arguments.length;j++)q[j-2]=arguments[j];var ce={title:T,command:p};return I.defined(q)&&q.length>0&&(ce.arguments=q),ce}m.create=_;function E(T){var p=T;return I.defined(p)&&I.string(p.title)&&I.string(p.command)}m.is=E})(k=e.Command||(e.Command={}));var x;(function(m){function _(q,j){return{range:q,newText:j}}m.replace=_;function E(q,j){return{range:{start:q,end:q},newText:j}}m.insert=E;function T(q){return{range:q,newText:""}}m.del=T;function p(q){var j=q;return I.objectLiteral(j)&&I.string(j.newText)&&a.is(j.range)}m.is=p})(x=e.TextEdit||(e.TextEdit={}));var F;(function(m){function _(T,p,q){var j={label:T};return p!==void 0&&(j.needsConfirmation=p),q!==void 0&&(j.description=q),j}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&I.string(p.label)&&(I.boolean(p.needsConfirmation)||p.needsConfirmation===void 0)&&(I.string(p.description)||p.description===void 0)}m.is=E})(F=e.ChangeAnnotation||(e.ChangeAnnotation={}));var N;(function(m){function _(E){var T=E;return I.string(T)}m.is=_})(N=e.ChangeAnnotationIdentifier||(e.ChangeAnnotationIdentifier={}));var U;(function(m){function _(q,j,ce){return{range:q,newText:j,annotationId:ce}}m.replace=_;function E(q,j,ce){return{range:{start:q,end:q},newText:j,annotationId:ce}}m.insert=E;function T(q,j){return{range:q,newText:"",annotationId:j}}m.del=T;function p(q){var j=q;return x.is(j)&&(F.is(j.annotationId)||N.is(j.annotationId))}m.is=p})(U=e.AnnotatedTextEdit||(e.AnnotatedTextEdit={}));var J;(function(m){function _(T,p){return{textDocument:T,edits:p}}m.create=_;function E(T){var p=T;return I.defined(p)&&jt.is(p.textDocument)&&Array.isArray(p.edits)}m.is=E})(J=e.TextDocumentEdit||(e.TextDocumentEdit={}));var te;(function(m){function _(T,p,q){var j={kind:"create",uri:T};return p!==void 0&&(p.overwrite!==void 0||p.ignoreIfExists!==void 0)&&(j.options=p),q!==void 0&&(j.annotationId=q),j}m.create=_;function E(T){var p=T;return p&&p.kind==="create"&&I.string(p.uri)&&(p.options===void 0||(p.options.overwrite===void 0||I.boolean(p.options.overwrite))&&(p.options.ignoreIfExists===void 0||I.boolean(p.options.ignoreIfExists)))&&(p.annotationId===void 0||N.is(p.annotationId))}m.is=E})(te=e.CreateFile||(e.CreateFile={}));var ie;(function(m){function _(T,p,q,j){var ce={kind:"rename",oldUri:T,newUri:p};return q!==void 0&&(q.overwrite!==void 0||q.ignoreIfExists!==void 0)&&(ce.options=q),j!==void 0&&(ce.annotationId=j),ce}m.create=_;function E(T){var p=T;return p&&p.kind==="rename"&&I.string(p.oldUri)&&I.string(p.newUri)&&(p.options===void 0||(p.options.overwrite===void 0||I.boolean(p.options.overwrite))&&(p.options.ignoreIfExists===void 0||I.boolean(p.options.ignoreIfExists)))&&(p.annotationId===void 0||N.is(p.annotationId))}m.is=E})(ie=e.RenameFile||(e.RenameFile={}));var _e;(function(m){function _(T,p,q){var j={kind:"delete",uri:T};return p!==void 0&&(p.recursive!==void 0||p.ignoreIfNotExists!==void 0)&&(j.options=p),q!==void 0&&(j.annotationId=q),j}m.create=_;function E(T){var p=T;return p&&p.kind==="delete"&&I.string(p.uri)&&(p.options===void 0||(p.options.recursive===void 0||I.boolean(p.options.recursive))&&(p.options.ignoreIfNotExists===void 0||I.boolean(p.options.ignoreIfNotExists)))&&(p.annotationId===void 0||N.is(p.annotationId))}m.is=E})(_e=e.DeleteFile||(e.DeleteFile={}));var Tt;(function(m){function _(E){var T=E;return T&&(T.changes!==void 0||T.documentChanges!==void 0)&&(T.documentChanges===void 0||T.documentChanges.every(function(p){return I.string(p.kind)?te.is(p)||ie.is(p)||_e.is(p):J.is(p)}))}m.is=_})(Tt=e.WorkspaceEdit||(e.WorkspaceEdit={}));var dt=function(){function m(_,E){this.edits=_,this.changeAnnotations=E}return m.prototype.insert=function(_,E,T){var p,q;if(T===void 0?p=x.insert(_,E):N.is(T)?(q=T,p=U.insert(_,E,T)):(this.assertChangeAnnotations(this.changeAnnotations),q=this.changeAnnotations.manage(T),p=U.insert(_,E,q)),this.edits.push(p),q!==void 0)return q},m.prototype.replace=function(_,E,T){var p,q;if(T===void 0?p=x.replace(_,E):N.is(T)?(q=T,p=U.replace(_,E,T)):(this.assertChangeAnnotations(this.changeAnnotations),q=this.changeAnnotations.manage(T),p=U.replace(_,E,q)),this.edits.push(p),q!==void 0)return q},m.prototype.delete=function(_,E){var T,p;if(E===void 0?T=x.del(_):N.is(E)?(p=E,T=U.del(_,E)):(this.assertChangeAnnotations(this.changeAnnotations),p=this.changeAnnotations.manage(E),T=U.del(_,p)),this.edits.push(T),p!==void 0)return p},m.prototype.add=function(_){this.edits.push(_)},m.prototype.all=function(){return this.edits},m.prototype.clear=function(){this.edits.splice(0,this.edits.length)},m.prototype.assertChangeAnnotations=function(_){if(_===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},m}(),ft=function(){function m(_){this._annotations=_===void 0?Object.create(null):_,this._counter=0,this._size=0}return m.prototype.all=function(){return this._annotations},Object.defineProperty(m.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),m.prototype.manage=function(_,E){var T;if(N.is(_)?T=_:(T=this.nextId(),E=_),this._annotations[T]!==void 0)throw new Error("Id ".concat(T," is already in use."));if(E===void 0)throw new Error("No annotation provided for id ".concat(T));return this._annotations[T]=E,this._size++,T},m.prototype.nextId=function(){return this._counter++,this._counter.toString()},m}(),me=function(){function m(_){var E=this;this._textEditChanges=Object.create(null),_!==void 0?(this._workspaceEdit=_,_.documentChanges?(this._changeAnnotations=new ft(_.changeAnnotations),_.changeAnnotations=this._changeAnnotations.all(),_.documentChanges.forEach(function(T){if(J.is(T)){var p=new dt(T.edits,E._changeAnnotations);E._textEditChanges[T.textDocument.uri]=p}})):_.changes&&Object.keys(_.changes).forEach(function(T){var p=new dt(_.changes[T]);E._textEditChanges[T]=p})):this._workspaceEdit={}}return Object.defineProperty(m.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),m.prototype.getTextEditChange=function(_){if(jt.is(_)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var E={uri:_.uri,version:_.version},T=this._textEditChanges[E.uri];if(!T){var p=[],q={textDocument:E,edits:p};this._workspaceEdit.documentChanges.push(q),T=new dt(p,this._changeAnnotations),this._textEditChanges[E.uri]=T}return T}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var T=this._textEditChanges[_];if(!T){var p=[];this._workspaceEdit.changes[_]=p,T=new dt(p),this._textEditChanges[_]=T}return T}},m.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new ft,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},m.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},m.prototype.createFile=function(_,E,T){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var p;F.is(E)||N.is(E)?p=E:T=E;var q,j;if(p===void 0?q=te.create(_,T):(j=N.is(p)?p:this._changeAnnotations.manage(p),q=te.create(_,T,j)),this._workspaceEdit.documentChanges.push(q),j!==void 0)return j},m.prototype.renameFile=function(_,E,T,p){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var q;F.is(T)||N.is(T)?q=T:p=T;var j,ce;if(q===void 0?j=ie.create(_,E,p):(ce=N.is(q)?q:this._changeAnnotations.manage(q),j=ie.create(_,E,p,ce)),this._workspaceEdit.documentChanges.push(j),ce!==void 0)return ce},m.prototype.deleteFile=function(_,E,T){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var p;F.is(E)||N.is(E)?p=E:T=E;var q,j;if(p===void 0?q=_e.create(_,T):(j=N.is(p)?p:this._changeAnnotations.manage(p),q=_e.create(_,T,j)),this._workspaceEdit.documentChanges.push(q),j!==void 0)return j},m}();e.WorkspaceChange=me;var et;(function(m){function _(T){return{uri:T}}m.create=_;function E(T){var p=T;return I.defined(p)&&I.string(p.uri)}m.is=E})(et=e.TextDocumentIdentifier||(e.TextDocumentIdentifier={}));var Ge;(function(m){function _(T,p){return{uri:T,version:p}}m.create=_;function E(T){var p=T;return I.defined(p)&&I.string(p.uri)&&I.integer(p.version)}m.is=E})(Ge=e.VersionedTextDocumentIdentifier||(e.VersionedTextDocumentIdentifier={}));var jt;(function(m){function _(T,p){return{uri:T,version:p}}m.create=_;function E(T){var p=T;return I.defined(p)&&I.string(p.uri)&&(p.version===null||I.integer(p.version))}m.is=E})(jt=e.OptionalVersionedTextDocumentIdentifier||(e.OptionalVersionedTextDocumentIdentifier={}));var Zt;(function(m){function _(T,p,q,j){return{uri:T,languageId:p,version:q,text:j}}m.create=_;function E(T){var p=T;return I.defined(p)&&I.string(p.uri)&&I.string(p.languageId)&&I.integer(p.version)&&I.string(p.text)}m.is=E})(Zt=e.TextDocumentItem||(e.TextDocumentItem={}));var Yn;(function(m){m.PlainText="plaintext",m.Markdown="markdown";function _(E){var T=E;return T===m.PlainText||T===m.Markdown}m.is=_})(Yn=e.MarkupKind||(e.MarkupKind={}));var It;(function(m){function _(E){var T=E;return I.objectLiteral(E)&&Yn.is(T.kind)&&I.string(T.value)}m.is=_})(It=e.MarkupContent||(e.MarkupContent={}));var ci;(function(m){m.Text=1,m.Method=2,m.Function=3,m.Constructor=4,m.Field=5,m.Variable=6,m.Class=7,m.Interface=8,m.Module=9,m.Property=10,m.Unit=11,m.Value=12,m.Enum=13,m.Keyword=14,m.Snippet=15,m.Color=16,m.File=17,m.Reference=18,m.Folder=19,m.EnumMember=20,m.Constant=21,m.Struct=22,m.Event=23,m.Operator=24,m.TypeParameter=25})(ci=e.CompletionItemKind||(e.CompletionItemKind={}));var Lr;(function(m){m.PlainText=1,m.Snippet=2})(Lr=e.InsertTextFormat||(e.InsertTextFormat={}));var ur;(function(m){m.Deprecated=1})(ur=e.CompletionItemTag||(e.CompletionItemTag={}));var lr;(function(m){function _(T,p,q){return{newText:T,insert:p,replace:q}}m.create=_;function E(T){var p=T;return p&&I.string(p.newText)&&a.is(p.insert)&&a.is(p.replace)}m.is=E})(lr=e.InsertReplaceEdit||(e.InsertReplaceEdit={}));var dr;(function(m){m.asIs=1,m.adjustIndentation=2})(dr=e.InsertTextMode||(e.InsertTextMode={}));var ui;(function(m){function _(E){var T=E;return T&&(I.string(T.detail)||T.detail===void 0)&&(I.string(T.description)||T.description===void 0)}m.is=_})(ui=e.CompletionItemLabelDetails||(e.CompletionItemLabelDetails={}));var Mr;(function(m){function _(E){return{label:E}}m.create=_})(Mr=e.CompletionItem||(e.CompletionItem={}));var Ar;(function(m){function _(E,T){return{items:E||[],isIncomplete:!!T}}m.create=_})(Ar=e.CompletionList||(e.CompletionList={}));var fr;(function(m){function _(T){return T.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}m.fromPlainText=_;function E(T){var p=T;return I.string(p)||I.objectLiteral(p)&&I.string(p.language)&&I.string(p.value)}m.is=E})(fr=e.MarkedString||(e.MarkedString={}));var wt;(function(m){function _(E){var T=E;return!!T&&I.objectLiteral(T)&&(It.is(T.contents)||fr.is(T.contents)||I.typedArray(T.contents,fr.is))&&(E.range===void 0||a.is(E.range))}m.is=_})(wt=e.Hover||(e.Hover={}));var $r;(function(m){function _(E,T){return T?{label:E,documentation:T}:{label:E}}m.create=_})($r=e.ParameterInformation||(e.ParameterInformation={}));var Jn;(function(m){function _(E,T){for(var p=[],q=2;q<arguments.length;q++)p[q-2]=arguments[q];var j={label:E};return I.defined(T)&&(j.documentation=T),I.defined(p)?j.parameters=p:j.parameters=[],j}m.create=_})(Jn=e.SignatureInformation||(e.SignatureInformation={}));var Cn;(function(m){m.Text=1,m.Read=2,m.Write=3})(Cn=e.DocumentHighlightKind||(e.DocumentHighlightKind={}));var jr;(function(m){function _(E,T){var p={range:E};return I.number(T)&&(p.kind=T),p}m.create=_})(jr=e.DocumentHighlight||(e.DocumentHighlight={}));var Wt;(function(m){m.File=1,m.Module=2,m.Namespace=3,m.Package=4,m.Class=5,m.Method=6,m.Property=7,m.Field=8,m.Constructor=9,m.Enum=10,m.Interface=11,m.Function=12,m.Variable=13,m.Constant=14,m.String=15,m.Number=16,m.Boolean=17,m.Array=18,m.Object=19,m.Key=20,m.Null=21,m.EnumMember=22,m.Struct=23,m.Event=24,m.Operator=25,m.TypeParameter=26})(Wt=e.SymbolKind||(e.SymbolKind={}));var hr;(function(m){m.Deprecated=1})(hr=e.SymbolTag||(e.SymbolTag={}));var ht;(function(m){function _(E,T,p,q,j){var ce={name:E,kind:T,location:{uri:q,range:p}};return j&&(ce.containerName=j),ce}m.create=_})(ht=e.SymbolInformation||(e.SymbolInformation={}));var In;(function(m){function _(E,T,p,q){return q!==void 0?{name:E,kind:T,location:{uri:p,range:q}}:{name:E,kind:T,location:{uri:p}}}m.create=_})(In=e.WorkspaceSymbol||(e.WorkspaceSymbol={}));var Ht;(function(m){function _(T,p,q,j,ce,Xe){var je={name:T,detail:p,kind:q,range:j,selectionRange:ce};return Xe!==void 0&&(je.children=Xe),je}m.create=_;function E(T){var p=T;return p&&I.string(p.name)&&I.number(p.kind)&&a.is(p.range)&&a.is(p.selectionRange)&&(p.detail===void 0||I.string(p.detail))&&(p.deprecated===void 0||I.boolean(p.deprecated))&&(p.children===void 0||Array.isArray(p.children))&&(p.tags===void 0||Array.isArray(p.tags))}m.is=E})(Ht=e.DocumentSymbol||(e.DocumentSymbol={}));var pr;(function(m){m.Empty="",m.QuickFix="quickfix",m.Refactor="refactor",m.RefactorExtract="refactor.extract",m.RefactorInline="refactor.inline",m.RefactorRewrite="refactor.rewrite",m.Source="source",m.SourceOrganizeImports="source.organizeImports",m.SourceFixAll="source.fixAll"})(pr=e.CodeActionKind||(e.CodeActionKind={}));var dn;(function(m){m.Invoked=1,m.Automatic=2})(dn=e.CodeActionTriggerKind||(e.CodeActionTriggerKind={}));var gr;(function(m){function _(T,p,q){var j={diagnostics:T};return p!=null&&(j.only=p),q!=null&&(j.triggerKind=q),j}m.create=_;function E(T){var p=T;return I.defined(p)&&I.typedArray(p.diagnostics,D.is)&&(p.only===void 0||I.typedArray(p.only,I.string))&&(p.triggerKind===void 0||p.triggerKind===dn.Invoked||p.triggerKind===dn.Automatic)}m.is=E})(gr=e.CodeActionContext||(e.CodeActionContext={}));var Wr;(function(m){function _(T,p,q){var j={title:T},ce=!0;return typeof p=="string"?(ce=!1,j.kind=p):k.is(p)?j.command=p:j.edit=p,ce&&q!==void 0&&(j.kind=q),j}m.create=_;function E(T){var p=T;return p&&I.string(p.title)&&(p.diagnostics===void 0||I.typedArray(p.diagnostics,D.is))&&(p.kind===void 0||I.string(p.kind))&&(p.edit!==void 0||p.command!==void 0)&&(p.command===void 0||k.is(p.command))&&(p.isPreferred===void 0||I.boolean(p.isPreferred))&&(p.edit===void 0||Tt.is(p.edit))}m.is=E})(Wr=e.CodeAction||(e.CodeAction={}));var en;(function(m){function _(T,p){var q={range:T};return I.defined(p)&&(q.data=p),q}m.create=_;function E(T){var p=T;return I.defined(p)&&a.is(p.range)&&(I.undefined(p.command)||k.is(p.command))}m.is=E})(en=e.CodeLens||(e.CodeLens={}));var Hr;(function(m){function _(T,p){return{tabSize:T,insertSpaces:p}}m.create=_;function E(T){var p=T;return I.defined(p)&&I.uinteger(p.tabSize)&&I.boolean(p.insertSpaces)}m.is=E})(Hr=e.FormattingOptions||(e.FormattingOptions={}));var fn;(function(m){function _(T,p,q){return{range:T,target:p,data:q}}m.create=_;function E(T){var p=T;return I.defined(p)&&a.is(p.range)&&(I.undefined(p.target)||I.string(p.target))}m.is=E})(fn=e.DocumentLink||(e.DocumentLink={}));var P;(function(m){function _(T,p){return{range:T,parent:p}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&a.is(p.range)&&(p.parent===void 0||m.is(p.parent))}m.is=E})(P=e.SelectionRange||(e.SelectionRange={}));var $;(function(m){m.namespace="namespace",m.type="type",m.class="class",m.enum="enum",m.interface="interface",m.struct="struct",m.typeParameter="typeParameter",m.parameter="parameter",m.variable="variable",m.property="property",m.enumMember="enumMember",m.event="event",m.function="function",m.method="method",m.macro="macro",m.keyword="keyword",m.modifier="modifier",m.comment="comment",m.string="string",m.number="number",m.regexp="regexp",m.operator="operator",m.decorator="decorator"})($=e.SemanticTokenTypes||(e.SemanticTokenTypes={}));var X;(function(m){m.declaration="declaration",m.definition="definition",m.readonly="readonly",m.static="static",m.deprecated="deprecated",m.abstract="abstract",m.async="async",m.modification="modification",m.documentation="documentation",m.defaultLibrary="defaultLibrary"})(X=e.SemanticTokenModifiers||(e.SemanticTokenModifiers={}));var Y;(function(m){function _(E){var T=E;return I.objectLiteral(T)&&(T.resultId===void 0||typeof T.resultId=="string")&&Array.isArray(T.data)&&(T.data.length===0||typeof T.data[0]=="number")}m.is=_})(Y=e.SemanticTokens||(e.SemanticTokens={}));var Ee;(function(m){function _(T,p){return{range:T,text:p}}m.create=_;function E(T){var p=T;return p!=null&&a.is(p.range)&&I.string(p.text)}m.is=E})(Ee=e.InlineValueText||(e.InlineValueText={}));var Re;(function(m){function _(T,p,q){return{range:T,variableName:p,caseSensitiveLookup:q}}m.create=_;function E(T){var p=T;return p!=null&&a.is(p.range)&&I.boolean(p.caseSensitiveLookup)&&(I.string(p.variableName)||p.variableName===void 0)}m.is=E})(Re=e.InlineValueVariableLookup||(e.InlineValueVariableLookup={}));var ke;(function(m){function _(T,p){return{range:T,expression:p}}m.create=_;function E(T){var p=T;return p!=null&&a.is(p.range)&&(I.string(p.expression)||p.expression===void 0)}m.is=E})(ke=e.InlineValueEvaluatableExpression||(e.InlineValueEvaluatableExpression={}));var We;(function(m){function _(T,p){return{frameId:T,stoppedLocation:p}}m.create=_;function E(T){var p=T;return I.defined(p)&&a.is(T.stoppedLocation)}m.is=E})(We=e.InlineValueContext||(e.InlineValueContext={}));var fe;(function(m){m.Type=1,m.Parameter=2;function _(E){return E===1||E===2}m.is=_})(fe=e.InlayHintKind||(e.InlayHintKind={}));var xe;(function(m){function _(T){return{value:T}}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&(p.tooltip===void 0||I.string(p.tooltip)||It.is(p.tooltip))&&(p.location===void 0||c.is(p.location))&&(p.command===void 0||k.is(p.command))}m.is=E})(xe=e.InlayHintLabelPart||(e.InlayHintLabelPart={}));var g;(function(m){function _(T,p,q){var j={position:T,label:p};return q!==void 0&&(j.kind=q),j}m.create=_;function E(T){var p=T;return I.objectLiteral(p)&&o.is(p.position)&&(I.string(p.label)||I.typedArray(p.label,xe.is))&&(p.kind===void 0||fe.is(p.kind))&&p.textEdits===void 0||I.typedArray(p.textEdits,x.is)&&(p.tooltip===void 0||I.string(p.tooltip)||It.is(p.tooltip))&&(p.paddingLeft===void 0||I.boolean(p.paddingLeft))&&(p.paddingRight===void 0||I.boolean(p.paddingRight))}m.is=E})(g=e.InlayHint||(e.InlayHint={}));var M;(function(m){function _(E){var T=E;return I.objectLiteral(T)&&r.is(T.uri)&&I.string(T.name)}m.is=_})(M=e.WorkspaceFolder||(e.WorkspaceFolder={})),e.EOL=[`
`,`\r
`,"\r"];var z;(function(m){function _(q,j,ce,Xe){return new he(q,j,ce,Xe)}m.create=_;function E(q){var j=q;return!!(I.defined(j)&&I.string(j.uri)&&(I.undefined(j.languageId)||I.string(j.languageId))&&I.uinteger(j.lineCount)&&I.func(j.getText)&&I.func(j.positionAt)&&I.func(j.offsetAt))}m.is=E;function T(q,j){for(var ce=q.getText(),Xe=p(j,function(Ur,Li){var xs=Ur.range.start.line-Li.range.start.line;return xs===0?Ur.range.start.character-Li.range.start.character:xs}),je=ce.length,hn=Xe.length-1;hn>=0;hn--){var tn=Xe[hn],On=q.offsetAt(tn.range.start),Ce=q.offsetAt(tn.range.end);if(Ce<=je)ce=ce.substring(0,On)+tn.newText+ce.substring(Ce,ce.length);else throw new Error("Overlapping edit");je=On}return ce}m.applyEdits=T;function p(q,j){if(q.length<=1)return q;var ce=q.length/2|0,Xe=q.slice(0,ce),je=q.slice(ce);p(Xe,j),p(je,j);for(var hn=0,tn=0,On=0;hn<Xe.length&&tn<je.length;){var Ce=j(Xe[hn],je[tn]);Ce<=0?q[On++]=Xe[hn++]:q[On++]=je[tn++]}for(;hn<Xe.length;)q[On++]=Xe[hn++];for(;tn<je.length;)q[On++]=je[tn++];return q}})(z=e.TextDocument||(e.TextDocument={}));var he=function(){function m(_,E,T,p){this._uri=_,this._languageId=E,this._version=T,this._content=p,this._lineOffsets=void 0}return Object.defineProperty(m.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(m.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),m.prototype.getText=function(_){if(_){var E=this.offsetAt(_.start),T=this.offsetAt(_.end);return this._content.substring(E,T)}return this._content},m.prototype.update=function(_,E){this._content=_.text,this._version=E,this._lineOffsets=void 0},m.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var _=[],E=this._content,T=!0,p=0;p<E.length;p++){T&&(_.push(p),T=!1);var q=E.charAt(p);T=q==="\r"||q===`
`,q==="\r"&&p+1<E.length&&E.charAt(p+1)===`
`&&p++}T&&E.length>0&&_.push(E.length),this._lineOffsets=_}return this._lineOffsets},m.prototype.positionAt=function(_){_=Math.max(Math.min(_,this._content.length),0);var E=this.getLineOffsets(),T=0,p=E.length;if(p===0)return o.create(0,_);for(;T<p;){var q=Math.floor((T+p)/2);E[q]>_?p=q:T=q+1}var j=T-1;return o.create(j,_-E[j])},m.prototype.offsetAt=function(_){var E=this.getLineOffsets();if(_.line>=E.length)return this._content.length;if(_.line<0)return 0;var T=E[_.line],p=_.line+1<E.length?E[_.line+1]:this._content.length;return Math.max(Math.min(T+_.character,p),T)},Object.defineProperty(m.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),m}(),I;(function(m){var _=Object.prototype.toString;function E(Ce){return typeof Ce!="undefined"}m.defined=E;function T(Ce){return typeof Ce=="undefined"}m.undefined=T;function p(Ce){return Ce===!0||Ce===!1}m.boolean=p;function q(Ce){return _.call(Ce)==="[object String]"}m.string=q;function j(Ce){return _.call(Ce)==="[object Number]"}m.number=j;function ce(Ce,Ur,Li){return _.call(Ce)==="[object Number]"&&Ur<=Ce&&Ce<=Li}m.numberRange=ce;function Xe(Ce){return _.call(Ce)==="[object Number]"&&-2147483648<=Ce&&Ce<=2147483647}m.integer=Xe;function je(Ce){return _.call(Ce)==="[object Number]"&&0<=Ce&&Ce<=2147483647}m.uinteger=je;function hn(Ce){return _.call(Ce)==="[object Function]"}m.func=hn;function tn(Ce){return Ce!==null&&typeof Ce=="object"}m.objectLiteral=tn;function On(Ce,Ur){return Array.isArray(Ce)&&Ce.every(Ur)}m.typedArray=On})(I||(I={}))})});var nt=L(Vt=>{"use strict";Object.defineProperty(Vt,"__esModule",{value:!0});Vt.ProtocolNotificationType=Vt.ProtocolNotificationType0=Vt.ProtocolRequestType=Vt.ProtocolRequestType0=Vt.RegistrationType=Vt.MessageDirection=void 0;var os=Ci(),IT;(function(n){n.clientToServer="clientToServer",n.serverToClient="serverToClient",n.both="both"})(IT=Vt.MessageDirection||(Vt.MessageDirection={}));var im=class{constructor(e){this.method=e}};Vt.RegistrationType=im;var sm=class extends os.RequestType0{constructor(e){super(e)}};Vt.ProtocolRequestType0=sm;var om=class extends os.RequestType{constructor(e){super(e,os.ParameterStructures.byName)}};Vt.ProtocolRequestType=om;var am=class extends os.NotificationType0{constructor(e){super(e)}};Vt.ProtocolNotificationType0=am;var cm=class extends os.NotificationType{constructor(e){super(e,os.ParameterStructures.byName)}};Vt.ProtocolNotificationType=cm});var $a=L(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.objectLiteral=gt.typedArray=gt.stringArray=gt.array=gt.func=gt.error=gt.number=gt.string=gt.boolean=void 0;function OT(n){return n===!0||n===!1}gt.boolean=OT;function um(n){return typeof n=="string"||n instanceof String}gt.string=um;function NT(n){return typeof n=="number"||n instanceof Number}gt.number=NT;function qT(n){return n instanceof Error}gt.error=qT;function LT(n){return typeof n=="function"}gt.func=LT;function lm(n){return Array.isArray(n)}gt.array=lm;function MT(n){return lm(n)&&n.every(e=>um(e))}gt.stringArray=MT;function AT(n,e){return Array.isArray(n)&&n.every(e)}gt.typedArray=AT;function $T(n){return n!==null&&typeof n=="object"}gt.objectLiteral=$T});var fm=L(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});Co.ImplementationRequest=void 0;var dm=nt(),jT;(function(n){n.method="textDocument/implementation",n.messageDirection=dm.MessageDirection.clientToServer,n.type=new dm.ProtocolRequestType(n.method)})(jT=Co.ImplementationRequest||(Co.ImplementationRequest={}))});var pm=L(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.TypeDefinitionRequest=void 0;var hm=nt(),WT;(function(n){n.method="textDocument/typeDefinition",n.messageDirection=hm.MessageDirection.clientToServer,n.type=new hm.ProtocolRequestType(n.method)})(WT=Do.TypeDefinitionRequest||(Do.TypeDefinitionRequest={}))});var gm=L(Qr=>{"use strict";Object.defineProperty(Qr,"__esModule",{value:!0});Qr.DidChangeWorkspaceFoldersNotification=Qr.WorkspaceFoldersRequest=void 0;var ja=nt(),HT;(function(n){n.method="workspace/workspaceFolders",n.messageDirection=ja.MessageDirection.serverToClient,n.type=new ja.ProtocolRequestType0(n.method)})(HT=Qr.WorkspaceFoldersRequest||(Qr.WorkspaceFoldersRequest={}));var UT;(function(n){n.method="workspace/didChangeWorkspaceFolders",n.messageDirection=ja.MessageDirection.clientToServer,n.type=new ja.ProtocolNotificationType(n.method)})(UT=Qr.DidChangeWorkspaceFoldersNotification||(Qr.DidChangeWorkspaceFoldersNotification={}))});var vm=L(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.ConfigurationRequest=void 0;var mm=nt(),KT;(function(n){n.method="workspace/configuration",n.messageDirection=mm.MessageDirection.serverToClient,n.type=new mm.ProtocolRequestType(n.method)})(KT=To.ConfigurationRequest||(To.ConfigurationRequest={}))});var ym=L(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.ColorPresentationRequest=Yr.DocumentColorRequest=void 0;var Wa=nt(),VT;(function(n){n.method="textDocument/documentColor",n.messageDirection=Wa.MessageDirection.clientToServer,n.type=new Wa.ProtocolRequestType(n.method)})(VT=Yr.DocumentColorRequest||(Yr.DocumentColorRequest={}));var XT;(function(n){n.method="textDocument/colorPresentation",n.messageDirection=Wa.MessageDirection.clientToServer,n.type=new Wa.ProtocolRequestType(n.method)})(XT=Yr.ColorPresentationRequest||(Yr.ColorPresentationRequest={}))});var bm=L(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.FoldingRangeRequest=void 0;var wm=nt(),zT;(function(n){n.method="textDocument/foldingRange",n.messageDirection=wm.MessageDirection.clientToServer,n.type=new wm.ProtocolRequestType(n.method)})(zT=So.FoldingRangeRequest||(So.FoldingRangeRequest={}))});var Dm=L(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.DeclarationRequest=void 0;var Cm=nt(),BT;(function(n){n.method="textDocument/declaration",n.messageDirection=Cm.MessageDirection.clientToServer,n.type=new Cm.ProtocolRequestType(n.method)})(BT=Ro.DeclarationRequest||(Ro.DeclarationRequest={}))});var Sm=L(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.SelectionRangeRequest=void 0;var Tm=nt(),GT;(function(n){n.method="textDocument/selectionRange",n.messageDirection=Tm.MessageDirection.clientToServer,n.type=new Tm.ProtocolRequestType(n.method)})(GT=ko.SelectionRangeRequest||(ko.SelectionRangeRequest={}))});var Rm=L($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.WorkDoneProgressCancelNotification=$n.WorkDoneProgressCreateRequest=$n.WorkDoneProgress=void 0;var QT=Ci(),Ha=nt(),YT;(function(n){n.type=new QT.ProgressType;function e(t){return t===n.type}n.is=e})(YT=$n.WorkDoneProgress||($n.WorkDoneProgress={}));var JT;(function(n){n.method="window/workDoneProgress/create",n.messageDirection=Ha.MessageDirection.serverToClient,n.type=new Ha.ProtocolRequestType(n.method)})(JT=$n.WorkDoneProgressCreateRequest||($n.WorkDoneProgressCreateRequest={}));var ZT;(function(n){n.method="window/workDoneProgress/cancel",n.messageDirection=Ha.MessageDirection.clientToServer,n.type=new Ha.ProtocolNotificationType(n.method)})(ZT=$n.WorkDoneProgressCancelNotification||($n.WorkDoneProgressCancelNotification={}))});var km=L(jn=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});jn.CallHierarchyOutgoingCallsRequest=jn.CallHierarchyIncomingCallsRequest=jn.CallHierarchyPrepareRequest=void 0;var as=nt(),eS;(function(n){n.method="textDocument/prepareCallHierarchy",n.messageDirection=as.MessageDirection.clientToServer,n.type=new as.ProtocolRequestType(n.method)})(eS=jn.CallHierarchyPrepareRequest||(jn.CallHierarchyPrepareRequest={}));var tS;(function(n){n.method="callHierarchy/incomingCalls",n.messageDirection=as.MessageDirection.clientToServer,n.type=new as.ProtocolRequestType(n.method)})(tS=jn.CallHierarchyIncomingCallsRequest||(jn.CallHierarchyIncomingCallsRequest={}));var nS;(function(n){n.method="callHierarchy/outgoingCalls",n.messageDirection=as.MessageDirection.clientToServer,n.type=new as.ProtocolRequestType(n.method)})(nS=jn.CallHierarchyOutgoingCallsRequest||(jn.CallHierarchyOutgoingCallsRequest={}))});var Pm=L(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.SemanticTokensRefreshRequest=mt.SemanticTokensRangeRequest=mt.SemanticTokensDeltaRequest=mt.SemanticTokensRequest=mt.SemanticTokensRegistrationType=mt.TokenFormat=void 0;var Rr=nt(),rS;(function(n){n.Relative="relative"})(rS=mt.TokenFormat||(mt.TokenFormat={}));var Ua;(function(n){n.method="textDocument/semanticTokens",n.type=new Rr.RegistrationType(n.method)})(Ua=mt.SemanticTokensRegistrationType||(mt.SemanticTokensRegistrationType={}));var iS;(function(n){n.method="textDocument/semanticTokens/full",n.messageDirection=Rr.MessageDirection.clientToServer,n.type=new Rr.ProtocolRequestType(n.method),n.registrationMethod=Ua.method})(iS=mt.SemanticTokensRequest||(mt.SemanticTokensRequest={}));var sS;(function(n){n.method="textDocument/semanticTokens/full/delta",n.messageDirection=Rr.MessageDirection.clientToServer,n.type=new Rr.ProtocolRequestType(n.method),n.registrationMethod=Ua.method})(sS=mt.SemanticTokensDeltaRequest||(mt.SemanticTokensDeltaRequest={}));var oS;(function(n){n.method="textDocument/semanticTokens/range",n.messageDirection=Rr.MessageDirection.clientToServer,n.type=new Rr.ProtocolRequestType(n.method),n.registrationMethod=Ua.method})(oS=mt.SemanticTokensRangeRequest||(mt.SemanticTokensRangeRequest={}));var aS;(function(n){n.method="workspace/semanticTokens/refresh",n.messageDirection=Rr.MessageDirection.serverToClient,n.type=new Rr.ProtocolRequestType0(n.method)})(aS=mt.SemanticTokensRefreshRequest||(mt.SemanticTokensRefreshRequest={}))});var Em=L(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.ShowDocumentRequest=void 0;var _m=nt(),cS;(function(n){n.method="window/showDocument",n.messageDirection=_m.MessageDirection.serverToClient,n.type=new _m.ProtocolRequestType(n.method)})(cS=Po.ShowDocumentRequest||(Po.ShowDocumentRequest={}))});var Fm=L(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.LinkedEditingRangeRequest=void 0;var xm=nt(),uS;(function(n){n.method="textDocument/linkedEditingRange",n.messageDirection=xm.MessageDirection.clientToServer,n.type=new xm.ProtocolRequestType(n.method)})(uS=_o.LinkedEditingRangeRequest||(_o.LinkedEditingRangeRequest={}))});var Im=L(rt=>{"use strict";Object.defineProperty(rt,"__esModule",{value:!0});rt.WillDeleteFilesRequest=rt.DidDeleteFilesNotification=rt.DidRenameFilesNotification=rt.WillRenameFilesRequest=rt.DidCreateFilesNotification=rt.WillCreateFilesRequest=rt.FileOperationPatternKind=void 0;var kn=nt(),lS;(function(n){n.file="file",n.folder="folder"})(lS=rt.FileOperationPatternKind||(rt.FileOperationPatternKind={}));var dS;(function(n){n.method="workspace/willCreateFiles",n.messageDirection=kn.MessageDirection.clientToServer,n.type=new kn.ProtocolRequestType(n.method)})(dS=rt.WillCreateFilesRequest||(rt.WillCreateFilesRequest={}));var fS;(function(n){n.method="workspace/didCreateFiles",n.messageDirection=kn.MessageDirection.clientToServer,n.type=new kn.ProtocolNotificationType(n.method)})(fS=rt.DidCreateFilesNotification||(rt.DidCreateFilesNotification={}));var hS;(function(n){n.method="workspace/willRenameFiles",n.messageDirection=kn.MessageDirection.clientToServer,n.type=new kn.ProtocolRequestType(n.method)})(hS=rt.WillRenameFilesRequest||(rt.WillRenameFilesRequest={}));var pS;(function(n){n.method="workspace/didRenameFiles",n.messageDirection=kn.MessageDirection.clientToServer,n.type=new kn.ProtocolNotificationType(n.method)})(pS=rt.DidRenameFilesNotification||(rt.DidRenameFilesNotification={}));var gS;(function(n){n.method="workspace/didDeleteFiles",n.messageDirection=kn.MessageDirection.clientToServer,n.type=new kn.ProtocolNotificationType(n.method)})(gS=rt.DidDeleteFilesNotification||(rt.DidDeleteFilesNotification={}));var mS;(function(n){n.method="workspace/willDeleteFiles",n.messageDirection=kn.MessageDirection.clientToServer,n.type=new kn.ProtocolRequestType(n.method)})(mS=rt.WillDeleteFilesRequest||(rt.WillDeleteFilesRequest={}))});var Nm=L(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});Wn.MonikerRequest=Wn.MonikerKind=Wn.UniquenessLevel=void 0;var Om=nt(),vS;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(vS=Wn.UniquenessLevel||(Wn.UniquenessLevel={}));var yS;(function(n){n.$import="import",n.$export="export",n.local="local"})(yS=Wn.MonikerKind||(Wn.MonikerKind={}));var wS;(function(n){n.method="textDocument/moniker",n.messageDirection=Om.MessageDirection.clientToServer,n.type=new Om.ProtocolRequestType(n.method)})(wS=Wn.MonikerRequest||(Wn.MonikerRequest={}))});var qm=L(Hn=>{"use strict";Object.defineProperty(Hn,"__esModule",{value:!0});Hn.TypeHierarchySubtypesRequest=Hn.TypeHierarchySupertypesRequest=Hn.TypeHierarchyPrepareRequest=void 0;var cs=nt(),bS;(function(n){n.method="textDocument/prepareTypeHierarchy",n.messageDirection=cs.MessageDirection.clientToServer,n.type=new cs.ProtocolRequestType(n.method)})(bS=Hn.TypeHierarchyPrepareRequest||(Hn.TypeHierarchyPrepareRequest={}));var CS;(function(n){n.method="typeHierarchy/supertypes",n.messageDirection=cs.MessageDirection.clientToServer,n.type=new cs.ProtocolRequestType(n.method)})(CS=Hn.TypeHierarchySupertypesRequest||(Hn.TypeHierarchySupertypesRequest={}));var DS;(function(n){n.method="typeHierarchy/subtypes",n.messageDirection=cs.MessageDirection.clientToServer,n.type=new cs.ProtocolRequestType(n.method)})(DS=Hn.TypeHierarchySubtypesRequest||(Hn.TypeHierarchySubtypesRequest={}))});var Lm=L(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.InlineValueRefreshRequest=Jr.InlineValueRequest=void 0;var Ka=nt(),TS;(function(n){n.method="textDocument/inlineValue",n.messageDirection=Ka.MessageDirection.clientToServer,n.type=new Ka.ProtocolRequestType(n.method)})(TS=Jr.InlineValueRequest||(Jr.InlineValueRequest={}));var SS;(function(n){n.method="workspace/inlineValue/refresh",n.messageDirection=Ka.MessageDirection.serverToClient,n.type=new Ka.ProtocolRequestType0(n.method)})(SS=Jr.InlineValueRefreshRequest||(Jr.InlineValueRefreshRequest={}))});var Mm=L(Un=>{"use strict";Object.defineProperty(Un,"__esModule",{value:!0});Un.InlayHintRefreshRequest=Un.InlayHintResolveRequest=Un.InlayHintRequest=void 0;var us=nt(),RS;(function(n){n.method="textDocument/inlayHint",n.messageDirection=us.MessageDirection.clientToServer,n.type=new us.ProtocolRequestType(n.method)})(RS=Un.InlayHintRequest||(Un.InlayHintRequest={}));var kS;(function(n){n.method="inlayHint/resolve",n.messageDirection=us.MessageDirection.clientToServer,n.type=new us.ProtocolRequestType(n.method)})(kS=Un.InlayHintResolveRequest||(Un.InlayHintResolveRequest={}));var PS;(function(n){n.method="workspace/inlayHint/refresh",n.messageDirection=us.MessageDirection.serverToClient,n.type=new us.ProtocolRequestType0(n.method)})(PS=Un.InlayHintRefreshRequest||(Un.InlayHintRefreshRequest={}))});var $m=L(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});xt.DiagnosticRefreshRequest=xt.WorkspaceDiagnosticRequest=xt.DocumentDiagnosticRequest=xt.DocumentDiagnosticReportKind=xt.DiagnosticServerCancellationData=void 0;var Am=Ci(),_S=$a(),ls=nt(),ES;(function(n){function e(t){let r=t;return r&&_S.boolean(r.retriggerRequest)}n.is=e})(ES=xt.DiagnosticServerCancellationData||(xt.DiagnosticServerCancellationData={}));var xS;(function(n){n.Full="full",n.Unchanged="unchanged"})(xS=xt.DocumentDiagnosticReportKind||(xt.DocumentDiagnosticReportKind={}));var FS;(function(n){n.method="textDocument/diagnostic",n.messageDirection=ls.MessageDirection.clientToServer,n.type=new ls.ProtocolRequestType(n.method),n.partialResult=new Am.ProgressType})(FS=xt.DocumentDiagnosticRequest||(xt.DocumentDiagnosticRequest={}));var IS;(function(n){n.method="workspace/diagnostic",n.messageDirection=ls.MessageDirection.clientToServer,n.type=new ls.ProtocolRequestType(n.method),n.partialResult=new Am.ProgressType})(IS=xt.WorkspaceDiagnosticRequest||(xt.WorkspaceDiagnosticRequest={}));var OS;(function(n){n.method="workspace/diagnostic/refresh",n.messageDirection=ls.MessageDirection.serverToClient,n.type=new ls.ProtocolRequestType0(n.method)})(OS=xt.DiagnosticRefreshRequest||(xt.DiagnosticRefreshRequest={}))});var Hm=L(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});Fe.DidCloseNotebookDocumentNotification=Fe.DidSaveNotebookDocumentNotification=Fe.DidChangeNotebookDocumentNotification=Fe.NotebookCellArrayChange=Fe.DidOpenNotebookDocumentNotification=Fe.NotebookDocumentSyncRegistrationType=Fe.NotebookDocument=Fe.NotebookCell=Fe.ExecutionSummary=Fe.NotebookCellKind=void 0;var Eo=Aa(),Kn=$a(),nr=nt(),jm;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(jm=Fe.NotebookCellKind||(Fe.NotebookCellKind={}));var Wm;(function(n){function e(i,s){let o={executionOrder:i};return(s===!0||s===!1)&&(o.success=s),o}n.create=e;function t(i){let s=i;return Kn.objectLiteral(s)&&Eo.uinteger.is(s.executionOrder)&&(s.success===void 0||Kn.boolean(s.success))}n.is=t;function r(i,s){return i===s?!0:i==null||s===null||s===void 0?!1:i.executionOrder===s.executionOrder&&i.success===s.success}n.equals=r})(Wm=Fe.ExecutionSummary||(Fe.ExecutionSummary={}));var wl;(function(n){function e(s,o){return{kind:s,document:o}}n.create=e;function t(s){let o=s;return Kn.objectLiteral(o)&&jm.is(o.kind)&&Eo.DocumentUri.is(o.document)&&(o.metadata===void 0||Kn.objectLiteral(o.metadata))}n.is=t;function r(s,o){let a=new Set;return s.document!==o.document&&a.add("document"),s.kind!==o.kind&&a.add("kind"),s.executionSummary!==o.executionSummary&&a.add("executionSummary"),(s.metadata!==void 0||o.metadata!==void 0)&&!i(s.metadata,o.metadata)&&a.add("metadata"),(s.executionSummary!==void 0||o.executionSummary!==void 0)&&!Wm.equals(s.executionSummary,o.executionSummary)&&a.add("executionSummary"),a}n.diff=r;function i(s,o){if(s===o)return!0;if(s==null||o===null||o===void 0||typeof s!=typeof o||typeof s!="object")return!1;let a=Array.isArray(s),c=Array.isArray(o);if(a!==c)return!1;if(a&&c){if(s.length!==o.length)return!1;for(let u=0;u<s.length;u++)if(!i(s[u],o[u]))return!1}if(Kn.objectLiteral(s)&&Kn.objectLiteral(o)){let u=Object.keys(s),l=Object.keys(o);if(u.length!==l.length||(u.sort(),l.sort(),!i(u,l)))return!1;for(let h=0;h<u.length;h++){let f=u[h];if(!i(s[f],o[f]))return!1}}return!0}})(wl=Fe.NotebookCell||(Fe.NotebookCell={}));var NS;(function(n){function e(r,i,s,o){return{uri:r,notebookType:i,version:s,cells:o}}n.create=e;function t(r){let i=r;return Kn.objectLiteral(i)&&Kn.string(i.uri)&&Eo.integer.is(i.version)&&Kn.typedArray(i.cells,wl.is)}n.is=t})(NS=Fe.NotebookDocument||(Fe.NotebookDocument={}));var xo;(function(n){n.method="notebookDocument/sync",n.messageDirection=nr.MessageDirection.clientToServer,n.type=new nr.RegistrationType(n.method)})(xo=Fe.NotebookDocumentSyncRegistrationType||(Fe.NotebookDocumentSyncRegistrationType={}));var qS;(function(n){n.method="notebookDocument/didOpen",n.messageDirection=nr.MessageDirection.clientToServer,n.type=new nr.ProtocolNotificationType(n.method),n.registrationMethod=xo.method})(qS=Fe.DidOpenNotebookDocumentNotification||(Fe.DidOpenNotebookDocumentNotification={}));var LS;(function(n){function e(r){let i=r;return Kn.objectLiteral(i)&&Eo.uinteger.is(i.start)&&Eo.uinteger.is(i.deleteCount)&&(i.cells===void 0||Kn.typedArray(i.cells,wl.is))}n.is=e;function t(r,i,s){let o={start:r,deleteCount:i};return s!==void 0&&(o.cells=s),o}n.create=t})(LS=Fe.NotebookCellArrayChange||(Fe.NotebookCellArrayChange={}));var MS;(function(n){n.method="notebookDocument/didChange",n.messageDirection=nr.MessageDirection.clientToServer,n.type=new nr.ProtocolNotificationType(n.method),n.registrationMethod=xo.method})(MS=Fe.DidChangeNotebookDocumentNotification||(Fe.DidChangeNotebookDocumentNotification={}));var AS;(function(n){n.method="notebookDocument/didSave",n.messageDirection=nr.MessageDirection.clientToServer,n.type=new nr.ProtocolNotificationType(n.method),n.registrationMethod=xo.method})(AS=Fe.DidSaveNotebookDocumentNotification||(Fe.DidSaveNotebookDocumentNotification={}));var $S;(function(n){n.method="notebookDocument/didClose",n.messageDirection=nr.MessageDirection.clientToServer,n.type=new nr.ProtocolNotificationType(n.method),n.registrationMethod=xo.method})($S=Fe.DidCloseNotebookDocumentNotification||(Fe.DidCloseNotebookDocumentNotification={}))});var Ym=L(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});w.WorkspaceSymbolRequest=w.CodeActionResolveRequest=w.CodeActionRequest=w.DocumentSymbolRequest=w.DocumentHighlightRequest=w.ReferencesRequest=w.DefinitionRequest=w.SignatureHelpRequest=w.SignatureHelpTriggerKind=w.HoverRequest=w.CompletionResolveRequest=w.CompletionRequest=w.CompletionTriggerKind=w.PublishDiagnosticsNotification=w.WatchKind=w.RelativePattern=w.FileChangeType=w.DidChangeWatchedFilesNotification=w.WillSaveTextDocumentWaitUntilRequest=w.WillSaveTextDocumentNotification=w.TextDocumentSaveReason=w.DidSaveTextDocumentNotification=w.DidCloseTextDocumentNotification=w.DidChangeTextDocumentNotification=w.TextDocumentContentChangeEvent=w.DidOpenTextDocumentNotification=w.TextDocumentSyncKind=w.TelemetryEventNotification=w.LogMessageNotification=w.ShowMessageRequest=w.ShowMessageNotification=w.MessageType=w.DidChangeConfigurationNotification=w.ExitNotification=w.ShutdownRequest=w.InitializedNotification=w.InitializeErrorCodes=w.InitializeRequest=w.WorkDoneProgressOptions=w.TextDocumentRegistrationOptions=w.StaticRegistrationOptions=w.PositionEncodingKind=w.FailureHandlingKind=w.ResourceOperationKind=w.UnregistrationRequest=w.RegistrationRequest=w.DocumentSelector=w.NotebookCellTextDocumentFilter=w.NotebookDocumentFilter=w.TextDocumentFilter=void 0;w.TypeHierarchySubtypesRequest=w.TypeHierarchyPrepareRequest=w.MonikerRequest=w.MonikerKind=w.UniquenessLevel=w.WillDeleteFilesRequest=w.DidDeleteFilesNotification=w.WillRenameFilesRequest=w.DidRenameFilesNotification=w.WillCreateFilesRequest=w.DidCreateFilesNotification=w.FileOperationPatternKind=w.LinkedEditingRangeRequest=w.ShowDocumentRequest=w.SemanticTokensRegistrationType=w.SemanticTokensRefreshRequest=w.SemanticTokensRangeRequest=w.SemanticTokensDeltaRequest=w.SemanticTokensRequest=w.TokenFormat=w.CallHierarchyPrepareRequest=w.CallHierarchyOutgoingCallsRequest=w.CallHierarchyIncomingCallsRequest=w.WorkDoneProgressCancelNotification=w.WorkDoneProgressCreateRequest=w.WorkDoneProgress=w.SelectionRangeRequest=w.DeclarationRequest=w.FoldingRangeRequest=w.ColorPresentationRequest=w.DocumentColorRequest=w.ConfigurationRequest=w.DidChangeWorkspaceFoldersNotification=w.WorkspaceFoldersRequest=w.TypeDefinitionRequest=w.ImplementationRequest=w.ApplyWorkspaceEditRequest=w.ExecuteCommandRequest=w.PrepareRenameRequest=w.RenameRequest=w.PrepareSupportDefaultBehavior=w.DocumentOnTypeFormattingRequest=w.DocumentRangeFormattingRequest=w.DocumentFormattingRequest=w.DocumentLinkResolveRequest=w.DocumentLinkRequest=w.CodeLensRefreshRequest=w.CodeLensResolveRequest=w.CodeLensRequest=w.WorkspaceSymbolResolveRequest=void 0;w.DidCloseNotebookDocumentNotification=w.DidSaveNotebookDocumentNotification=w.DidChangeNotebookDocumentNotification=w.NotebookCellArrayChange=w.DidOpenNotebookDocumentNotification=w.NotebookDocumentSyncRegistrationType=w.NotebookDocument=w.NotebookCell=w.ExecutionSummary=w.NotebookCellKind=w.DiagnosticRefreshRequest=w.WorkspaceDiagnosticRequest=w.DocumentDiagnosticRequest=w.DocumentDiagnosticReportKind=w.DiagnosticServerCancellationData=w.InlayHintRefreshRequest=w.InlayHintResolveRequest=w.InlayHintRequest=w.InlineValueRefreshRequest=w.InlineValueRequest=w.TypeHierarchySupertypesRequest=void 0;var V=nt(),Um=Aa(),Ft=$a(),jS=fm();Object.defineProperty(w,"ImplementationRequest",{enumerable:!0,get:function(){return jS.ImplementationRequest}});var WS=pm();Object.defineProperty(w,"TypeDefinitionRequest",{enumerable:!0,get:function(){return WS.TypeDefinitionRequest}});var Km=gm();Object.defineProperty(w,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return Km.WorkspaceFoldersRequest}});Object.defineProperty(w,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return Km.DidChangeWorkspaceFoldersNotification}});var HS=vm();Object.defineProperty(w,"ConfigurationRequest",{enumerable:!0,get:function(){return HS.ConfigurationRequest}});var Vm=ym();Object.defineProperty(w,"DocumentColorRequest",{enumerable:!0,get:function(){return Vm.DocumentColorRequest}});Object.defineProperty(w,"ColorPresentationRequest",{enumerable:!0,get:function(){return Vm.ColorPresentationRequest}});var US=bm();Object.defineProperty(w,"FoldingRangeRequest",{enumerable:!0,get:function(){return US.FoldingRangeRequest}});var KS=Dm();Object.defineProperty(w,"DeclarationRequest",{enumerable:!0,get:function(){return KS.DeclarationRequest}});var VS=Sm();Object.defineProperty(w,"SelectionRangeRequest",{enumerable:!0,get:function(){return VS.SelectionRangeRequest}});var bl=Rm();Object.defineProperty(w,"WorkDoneProgress",{enumerable:!0,get:function(){return bl.WorkDoneProgress}});Object.defineProperty(w,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return bl.WorkDoneProgressCreateRequest}});Object.defineProperty(w,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return bl.WorkDoneProgressCancelNotification}});var Cl=km();Object.defineProperty(w,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return Cl.CallHierarchyIncomingCallsRequest}});Object.defineProperty(w,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return Cl.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(w,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return Cl.CallHierarchyPrepareRequest}});var ds=Pm();Object.defineProperty(w,"TokenFormat",{enumerable:!0,get:function(){return ds.TokenFormat}});Object.defineProperty(w,"SemanticTokensRequest",{enumerable:!0,get:function(){return ds.SemanticTokensRequest}});Object.defineProperty(w,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return ds.SemanticTokensDeltaRequest}});Object.defineProperty(w,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return ds.SemanticTokensRangeRequest}});Object.defineProperty(w,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return ds.SemanticTokensRefreshRequest}});Object.defineProperty(w,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return ds.SemanticTokensRegistrationType}});var XS=Em();Object.defineProperty(w,"ShowDocumentRequest",{enumerable:!0,get:function(){return XS.ShowDocumentRequest}});var zS=Fm();Object.defineProperty(w,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return zS.LinkedEditingRangeRequest}});var Di=Im();Object.defineProperty(w,"FileOperationPatternKind",{enumerable:!0,get:function(){return Di.FileOperationPatternKind}});Object.defineProperty(w,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Di.DidCreateFilesNotification}});Object.defineProperty(w,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Di.WillCreateFilesRequest}});Object.defineProperty(w,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Di.DidRenameFilesNotification}});Object.defineProperty(w,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Di.WillRenameFilesRequest}});Object.defineProperty(w,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Di.DidDeleteFilesNotification}});Object.defineProperty(w,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Di.WillDeleteFilesRequest}});var Dl=Nm();Object.defineProperty(w,"UniquenessLevel",{enumerable:!0,get:function(){return Dl.UniquenessLevel}});Object.defineProperty(w,"MonikerKind",{enumerable:!0,get:function(){return Dl.MonikerKind}});Object.defineProperty(w,"MonikerRequest",{enumerable:!0,get:function(){return Dl.MonikerRequest}});var Tl=qm();Object.defineProperty(w,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return Tl.TypeHierarchyPrepareRequest}});Object.defineProperty(w,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return Tl.TypeHierarchySubtypesRequest}});Object.defineProperty(w,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return Tl.TypeHierarchySupertypesRequest}});var Xm=Lm();Object.defineProperty(w,"InlineValueRequest",{enumerable:!0,get:function(){return Xm.InlineValueRequest}});Object.defineProperty(w,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return Xm.InlineValueRefreshRequest}});var Sl=Mm();Object.defineProperty(w,"InlayHintRequest",{enumerable:!0,get:function(){return Sl.InlayHintRequest}});Object.defineProperty(w,"InlayHintResolveRequest",{enumerable:!0,get:function(){return Sl.InlayHintResolveRequest}});Object.defineProperty(w,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return Sl.InlayHintRefreshRequest}});var Fo=$m();Object.defineProperty(w,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return Fo.DiagnosticServerCancellationData}});Object.defineProperty(w,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return Fo.DocumentDiagnosticReportKind}});Object.defineProperty(w,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return Fo.DocumentDiagnosticRequest}});Object.defineProperty(w,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return Fo.WorkspaceDiagnosticRequest}});Object.defineProperty(w,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return Fo.DiagnosticRefreshRequest}});var rr=Hm();Object.defineProperty(w,"NotebookCellKind",{enumerable:!0,get:function(){return rr.NotebookCellKind}});Object.defineProperty(w,"ExecutionSummary",{enumerable:!0,get:function(){return rr.ExecutionSummary}});Object.defineProperty(w,"NotebookCell",{enumerable:!0,get:function(){return rr.NotebookCell}});Object.defineProperty(w,"NotebookDocument",{enumerable:!0,get:function(){return rr.NotebookDocument}});Object.defineProperty(w,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return rr.NotebookDocumentSyncRegistrationType}});Object.defineProperty(w,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return rr.DidOpenNotebookDocumentNotification}});Object.defineProperty(w,"NotebookCellArrayChange",{enumerable:!0,get:function(){return rr.NotebookCellArrayChange}});Object.defineProperty(w,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return rr.DidChangeNotebookDocumentNotification}});Object.defineProperty(w,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return rr.DidSaveNotebookDocumentNotification}});Object.defineProperty(w,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return rr.DidCloseNotebookDocumentNotification}});var zm;(function(n){function e(t){let r=t;return Ft.string(r.language)||Ft.string(r.scheme)||Ft.string(r.pattern)}n.is=e})(zm=w.TextDocumentFilter||(w.TextDocumentFilter={}));var Bm;(function(n){function e(t){let r=t;return Ft.objectLiteral(r)&&(Ft.string(r.notebookType)||Ft.string(r.scheme)||Ft.string(r.pattern))}n.is=e})(Bm=w.NotebookDocumentFilter||(w.NotebookDocumentFilter={}));var Gm;(function(n){function e(t){let r=t;return Ft.objectLiteral(r)&&(Ft.string(r.notebook)||Bm.is(r.notebook))&&(r.language===void 0||Ft.string(r.language))}n.is=e})(Gm=w.NotebookCellTextDocumentFilter||(w.NotebookCellTextDocumentFilter={}));var Qm;(function(n){function e(t){if(!Array.isArray(t))return!1;for(let r of t)if(!Ft.string(r)&&!zm.is(r)&&!Gm.is(r))return!1;return!0}n.is=e})(Qm=w.DocumentSelector||(w.DocumentSelector={}));var BS;(function(n){n.method="client/registerCapability",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolRequestType(n.method)})(BS=w.RegistrationRequest||(w.RegistrationRequest={}));var GS;(function(n){n.method="client/unregisterCapability",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolRequestType(n.method)})(GS=w.UnregistrationRequest||(w.UnregistrationRequest={}));var QS;(function(n){n.Create="create",n.Rename="rename",n.Delete="delete"})(QS=w.ResourceOperationKind||(w.ResourceOperationKind={}));var YS;(function(n){n.Abort="abort",n.Transactional="transactional",n.TextOnlyTransactional="textOnlyTransactional",n.Undo="undo"})(YS=w.FailureHandlingKind||(w.FailureHandlingKind={}));var JS;(function(n){n.UTF8="utf-8",n.UTF16="utf-16",n.UTF32="utf-32"})(JS=w.PositionEncodingKind||(w.PositionEncodingKind={}));var ZS;(function(n){function e(t){let r=t;return r&&Ft.string(r.id)&&r.id.length>0}n.hasId=e})(ZS=w.StaticRegistrationOptions||(w.StaticRegistrationOptions={}));var eR;(function(n){function e(t){let r=t;return r&&(r.documentSelector===null||Qm.is(r.documentSelector))}n.is=e})(eR=w.TextDocumentRegistrationOptions||(w.TextDocumentRegistrationOptions={}));var tR;(function(n){function e(r){let i=r;return Ft.objectLiteral(i)&&(i.workDoneProgress===void 0||Ft.boolean(i.workDoneProgress))}n.is=e;function t(r){let i=r;return i&&Ft.boolean(i.workDoneProgress)}n.hasWorkDoneProgress=t})(tR=w.WorkDoneProgressOptions||(w.WorkDoneProgressOptions={}));var nR;(function(n){n.method="initialize",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(nR=w.InitializeRequest||(w.InitializeRequest={}));var rR;(function(n){n.unknownProtocolVersion=1})(rR=w.InitializeErrorCodes||(w.InitializeErrorCodes={}));var iR;(function(n){n.method="initialized",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(iR=w.InitializedNotification||(w.InitializedNotification={}));var sR;(function(n){n.method="shutdown",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType0(n.method)})(sR=w.ShutdownRequest||(w.ShutdownRequest={}));var oR;(function(n){n.method="exit",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType0(n.method)})(oR=w.ExitNotification||(w.ExitNotification={}));var aR;(function(n){n.method="workspace/didChangeConfiguration",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(aR=w.DidChangeConfigurationNotification||(w.DidChangeConfigurationNotification={}));var cR;(function(n){n.Error=1,n.Warning=2,n.Info=3,n.Log=4})(cR=w.MessageType||(w.MessageType={}));var uR;(function(n){n.method="window/showMessage",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolNotificationType(n.method)})(uR=w.ShowMessageNotification||(w.ShowMessageNotification={}));var lR;(function(n){n.method="window/showMessageRequest",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolRequestType(n.method)})(lR=w.ShowMessageRequest||(w.ShowMessageRequest={}));var dR;(function(n){n.method="window/logMessage",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolNotificationType(n.method)})(dR=w.LogMessageNotification||(w.LogMessageNotification={}));var fR;(function(n){n.method="telemetry/event",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolNotificationType(n.method)})(fR=w.TelemetryEventNotification||(w.TelemetryEventNotification={}));var hR;(function(n){n.None=0,n.Full=1,n.Incremental=2})(hR=w.TextDocumentSyncKind||(w.TextDocumentSyncKind={}));var pR;(function(n){n.method="textDocument/didOpen",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(pR=w.DidOpenTextDocumentNotification||(w.DidOpenTextDocumentNotification={}));var gR;(function(n){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}n.isIncremental=e;function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}n.isFull=t})(gR=w.TextDocumentContentChangeEvent||(w.TextDocumentContentChangeEvent={}));var mR;(function(n){n.method="textDocument/didChange",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(mR=w.DidChangeTextDocumentNotification||(w.DidChangeTextDocumentNotification={}));var vR;(function(n){n.method="textDocument/didClose",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(vR=w.DidCloseTextDocumentNotification||(w.DidCloseTextDocumentNotification={}));var yR;(function(n){n.method="textDocument/didSave",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(yR=w.DidSaveTextDocumentNotification||(w.DidSaveTextDocumentNotification={}));var wR;(function(n){n.Manual=1,n.AfterDelay=2,n.FocusOut=3})(wR=w.TextDocumentSaveReason||(w.TextDocumentSaveReason={}));var bR;(function(n){n.method="textDocument/willSave",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(bR=w.WillSaveTextDocumentNotification||(w.WillSaveTextDocumentNotification={}));var CR;(function(n){n.method="textDocument/willSaveWaitUntil",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(CR=w.WillSaveTextDocumentWaitUntilRequest||(w.WillSaveTextDocumentWaitUntilRequest={}));var DR;(function(n){n.method="workspace/didChangeWatchedFiles",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolNotificationType(n.method)})(DR=w.DidChangeWatchedFilesNotification||(w.DidChangeWatchedFilesNotification={}));var TR;(function(n){n.Created=1,n.Changed=2,n.Deleted=3})(TR=w.FileChangeType||(w.FileChangeType={}));var SR;(function(n){function e(t){let r=t;return Ft.objectLiteral(r)&&(Um.URI.is(r.baseUri)||Um.WorkspaceFolder.is(r.baseUri))&&Ft.string(r.pattern)}n.is=e})(SR=w.RelativePattern||(w.RelativePattern={}));var RR;(function(n){n.Create=1,n.Change=2,n.Delete=4})(RR=w.WatchKind||(w.WatchKind={}));var kR;(function(n){n.method="textDocument/publishDiagnostics",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolNotificationType(n.method)})(kR=w.PublishDiagnosticsNotification||(w.PublishDiagnosticsNotification={}));var PR;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.TriggerForIncompleteCompletions=3})(PR=w.CompletionTriggerKind||(w.CompletionTriggerKind={}));var _R;(function(n){n.method="textDocument/completion",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(_R=w.CompletionRequest||(w.CompletionRequest={}));var ER;(function(n){n.method="completionItem/resolve",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(ER=w.CompletionResolveRequest||(w.CompletionResolveRequest={}));var xR;(function(n){n.method="textDocument/hover",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(xR=w.HoverRequest||(w.HoverRequest={}));var FR;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.ContentChange=3})(FR=w.SignatureHelpTriggerKind||(w.SignatureHelpTriggerKind={}));var IR;(function(n){n.method="textDocument/signatureHelp",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(IR=w.SignatureHelpRequest||(w.SignatureHelpRequest={}));var OR;(function(n){n.method="textDocument/definition",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(OR=w.DefinitionRequest||(w.DefinitionRequest={}));var NR;(function(n){n.method="textDocument/references",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(NR=w.ReferencesRequest||(w.ReferencesRequest={}));var qR;(function(n){n.method="textDocument/documentHighlight",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(qR=w.DocumentHighlightRequest||(w.DocumentHighlightRequest={}));var LR;(function(n){n.method="textDocument/documentSymbol",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(LR=w.DocumentSymbolRequest||(w.DocumentSymbolRequest={}));var MR;(function(n){n.method="textDocument/codeAction",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(MR=w.CodeActionRequest||(w.CodeActionRequest={}));var AR;(function(n){n.method="codeAction/resolve",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(AR=w.CodeActionResolveRequest||(w.CodeActionResolveRequest={}));var $R;(function(n){n.method="workspace/symbol",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})($R=w.WorkspaceSymbolRequest||(w.WorkspaceSymbolRequest={}));var jR;(function(n){n.method="workspaceSymbol/resolve",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(jR=w.WorkspaceSymbolResolveRequest||(w.WorkspaceSymbolResolveRequest={}));var WR;(function(n){n.method="textDocument/codeLens",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(WR=w.CodeLensRequest||(w.CodeLensRequest={}));var HR;(function(n){n.method="codeLens/resolve",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(HR=w.CodeLensResolveRequest||(w.CodeLensResolveRequest={}));var UR;(function(n){n.method="workspace/codeLens/refresh",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolRequestType0(n.method)})(UR=w.CodeLensRefreshRequest||(w.CodeLensRefreshRequest={}));var KR;(function(n){n.method="textDocument/documentLink",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(KR=w.DocumentLinkRequest||(w.DocumentLinkRequest={}));var VR;(function(n){n.method="documentLink/resolve",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(VR=w.DocumentLinkResolveRequest||(w.DocumentLinkResolveRequest={}));var XR;(function(n){n.method="textDocument/formatting",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(XR=w.DocumentFormattingRequest||(w.DocumentFormattingRequest={}));var zR;(function(n){n.method="textDocument/rangeFormatting",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(zR=w.DocumentRangeFormattingRequest||(w.DocumentRangeFormattingRequest={}));var BR;(function(n){n.method="textDocument/onTypeFormatting",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(BR=w.DocumentOnTypeFormattingRequest||(w.DocumentOnTypeFormattingRequest={}));var GR;(function(n){n.Identifier=1})(GR=w.PrepareSupportDefaultBehavior||(w.PrepareSupportDefaultBehavior={}));var QR;(function(n){n.method="textDocument/rename",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(QR=w.RenameRequest||(w.RenameRequest={}));var YR;(function(n){n.method="textDocument/prepareRename",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(YR=w.PrepareRenameRequest||(w.PrepareRenameRequest={}));var JR;(function(n){n.method="workspace/executeCommand",n.messageDirection=V.MessageDirection.clientToServer,n.type=new V.ProtocolRequestType(n.method)})(JR=w.ExecuteCommandRequest||(w.ExecuteCommandRequest={}));var ZR;(function(n){n.method="workspace/applyEdit",n.messageDirection=V.MessageDirection.serverToClient,n.type=new V.ProtocolRequestType("workspace/applyEdit")})(ZR=w.ApplyWorkspaceEditRequest||(w.ApplyWorkspaceEditRequest={}))});var Zm=L(Va=>{"use strict";Object.defineProperty(Va,"__esModule",{value:!0});Va.createProtocolConnection=void 0;var Jm=Ci();function ek(n,e,t,r){return Jm.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Jm.createMessageConnection)(n,e,t,r)}Va.createProtocolConnection=ek});var ev=L(Xt=>{"use strict";var tk=Xt&&Xt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Xa=Xt&&Xt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&tk(e,n,t)};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.LSPErrorCodes=Xt.createProtocolConnection=void 0;Xa(Ci(),Xt);Xa(Aa(),Xt);Xa(nt(),Xt);Xa(Ym(),Xt);var nk=Zm();Object.defineProperty(Xt,"createProtocolConnection",{enumerable:!0,get:function(){return nk.createProtocolConnection}});var rk;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(rk=Xt.LSPErrorCodes||(Xt.LSPErrorCodes={}))});var ue=L(ir=>{"use strict";var ik=ir&&ir.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),tv=ir&&ir.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ik(e,n,t)};Object.defineProperty(ir,"__esModule",{value:!0});ir.createProtocolConnection=void 0;var sk=yl();tv(yl(),ir);tv(ev(),ir);function ok(n,e,t,r){return(0,sk.createMessageConnection)(n,e,t,r)}ir.createProtocolConnection=ok});var Ba=L(Mt=>{"use strict";Object.defineProperty(Mt,"__esModule",{value:!0});Mt.forEach=Mt.mapAsync=Mt.map=Mt.clearTestMode=Mt.setTestMode=Mt.Semaphore=Mt.Delayer=void 0;var Io=ue(),nv=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,Io.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};Mt.Delayer=nv;var rv=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Io.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};Mt.Semaphore=rv;var Rl=!1;function ak(){Rl=!0}Mt.setTestMode=ak;function ck(){Rl=!1}Mt.clearTestMode=ck;var iv=15,za=class{constructor(e=iv){this.yieldAfter=Rl===!0?Math.max(e,2):Math.max(e,iv),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function uk(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),s=new za(r==null?void 0:r.yieldAfter);function o(c){s.start();for(let u=c;u<n.length;u++)if(i[u]=e(n[u]),s.shouldYield())return(r==null?void 0:r.yieldCallback)&&r.yieldCallback(),u+1;return-1}let a=o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,Io.RAL)().timer.setImmediate(()=>{c(o(a))})});return i}Mt.map=uk;async function lk(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),s=new za(r==null?void 0:r.yieldAfter);async function o(c){s.start();for(let u=c;u<n.length;u++)if(i[u]=await e(n[u],t),s.shouldYield())return(r==null?void 0:r.yieldCallback)&&r.yieldCallback(),u+1;return-1}let a=await o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,Io.RAL)().timer.setImmediate(()=>{c(o(a))})});return i}Mt.mapAsync=lk;async function dk(n,e,t,r){if(n.length===0)return;let i=new za(r==null?void 0:r.yieldAfter);function s(a){i.start();for(let c=a;c<n.length;c++)if(e(n[c]),i.shouldYield())return(r==null?void 0:r.yieldCallback)&&r.yieldCallback(),c+1;return-1}let o=s(0);for(;o!==-1&&!(t!==void 0&&t.isCancellationRequested);)o=await new Promise(a=>{(0,Io.RAL)().timer.setImmediate(()=>{a(s(o))})})}Mt.forEach=dk});var Pl=L(kl=>{"use strict";Object.defineProperty(kl,"__esModule",{value:!0});var fk=require("vscode"),sv=class extends fk.CompletionItem{constructor(e){super(e)}};kl.default=sv});var El=L(_l=>{"use strict";Object.defineProperty(_l,"__esModule",{value:!0});var hk=require("vscode"),ov=class extends hk.CodeLens{constructor(e){super(e)}};_l.default=ov});var Fl=L(xl=>{"use strict";Object.defineProperty(xl,"__esModule",{value:!0});var pk=require("vscode"),av=class extends pk.DocumentLink{constructor(e,t){super(e,t)}};xl.default=av});var Ol=L(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});var gk=require("vscode"),cv=class extends gk.CodeAction{constructor(e,t){super(e);this.data=t}};Il.default=cv});var ql=L(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.ProtocolDiagnostic=Ti.DiagnosticCode=void 0;var mk=require("vscode"),Nl=Rn(),vk;(function(n){function e(t){let r=t;return r!=null&&(Nl.number(r.value)||Nl.string(r.value))&&Nl.string(r.target)}n.is=e})(vk=Ti.DiagnosticCode||(Ti.DiagnosticCode={}));var uv=class extends mk.Diagnostic{constructor(e,t,r,i){super(e,t,r);this.data=i,this.hasDiagnosticCode=!1}};Ti.ProtocolDiagnostic=uv});var Ml=L(Ll=>{"use strict";Object.defineProperty(Ll,"__esModule",{value:!0});var yk=require("vscode"),lv=class extends yk.CallHierarchyItem{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,o);a!==void 0&&(this.data=a)}};Ll.default=lv});var $l=L(Al=>{"use strict";Object.defineProperty(Al,"__esModule",{value:!0});var wk=require("vscode"),dv=class extends wk.TypeHierarchyItem{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s,o);a!==void 0&&(this.data=a)}};Al.default=dv});var Wl=L(jl=>{"use strict";Object.defineProperty(jl,"__esModule",{value:!0});var Ga=require("vscode"),fv=class extends Ga.SymbolInformation{constructor(e,t,r,i,s){let o=!(i instanceof Ga.Uri);super(e,t,r,o?i:new Ga.Location(i,new Ga.Range(0,0,0,0)));this.hasRange=o,s!==void 0&&(this.data=s)}};jl.default=fv});var Ul=L(Hl=>{"use strict";Object.defineProperty(Hl,"__esModule",{value:!0});var bk=require("vscode"),hv=class extends bk.InlayHint{constructor(e,t,r){super(e,t,r)}};Hl.default=hv});var mv=L(Qa=>{"use strict";Object.defineProperty(Qa,"__esModule",{value:!0});Qa.createConverter=void 0;var vt=require("vscode"),pe=ue(),fs=Rn(),pv=Ba(),Ck=Pl(),Dk=El(),Tk=Fl(),Sk=Ol(),gv=ql(),Rk=Ml(),kk=$l(),Pk=Wl(),_k=Ul(),Kl;(function(n){function e(t){let r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(Kl||(Kl={}));function Ek(n){let t=n||(g=>g.toString());function r(g){return t(g)}function i(g){return{uri:t(g.uri)}}function s(g){return{uri:t(g.uri),languageId:g.languageId,version:g.version,text:g.getText()}}function o(g){return{uri:t(g.uri),version:g.version}}function a(g){return{textDocument:s(g)}}function c(g){let M=g;return!!M.document&&!!M.contentChanges}function u(g){let M=g;return!!M.uri&&!!M.version}function l(g,M,z){if(u(g))return{textDocument:{uri:t(g.uri),version:g.version},contentChanges:[{text:g.getText()}]};if(c(g)){let he=M,I=z;return{textDocument:{uri:t(he),version:I},contentChanges:g.contentChanges.map(_=>{let E=_.range;return{range:{start:{line:E.start.line,character:E.start.character},end:{line:E.end.line,character:E.end.character}},rangeLength:_.rangeLength,text:_.text}})}}else throw Error("Unsupported text document change parameter")}function h(g){return{textDocument:i(g)}}function f(g,M=!1){let z={textDocument:i(g)};return M&&(z.text=g.getText()),z}function C(g){switch(g){case vt.TextDocumentSaveReason.Manual:return pe.TextDocumentSaveReason.Manual;case vt.TextDocumentSaveReason.AfterDelay:return pe.TextDocumentSaveReason.AfterDelay;case vt.TextDocumentSaveReason.FocusOut:return pe.TextDocumentSaveReason.FocusOut}return pe.TextDocumentSaveReason.Manual}function b(g){return{textDocument:i(g.document),reason:C(g.reason)}}function y(g){return{files:g.files.map(M=>({uri:t(M)}))}}function S(g){return{files:g.files.map(M=>({oldUri:t(M.oldUri),newUri:t(M.newUri)}))}}function R(g){return{files:g.files.map(M=>({uri:t(M)}))}}function v(g){return{files:g.files.map(M=>({uri:t(M)}))}}function D(g){return{files:g.files.map(M=>({oldUri:t(M.oldUri),newUri:t(M.newUri)}))}}function k(g){return{files:g.files.map(M=>({uri:t(M)}))}}function x(g,M){return{textDocument:i(g),position:ft(M)}}function F(g){switch(g){case vt.CompletionTriggerKind.TriggerCharacter:return pe.CompletionTriggerKind.TriggerCharacter;case vt.CompletionTriggerKind.TriggerForIncompleteCompletions:return pe.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return pe.CompletionTriggerKind.Invoked}}function N(g,M,z){return{textDocument:i(g),position:ft(M),context:{triggerKind:F(z.triggerKind),triggerCharacter:z.triggerCharacter}}}function U(g){switch(g){case vt.SignatureHelpTriggerKind.Invoke:return pe.SignatureHelpTriggerKind.Invoked;case vt.SignatureHelpTriggerKind.TriggerCharacter:return pe.SignatureHelpTriggerKind.TriggerCharacter;case vt.SignatureHelpTriggerKind.ContentChange:return pe.SignatureHelpTriggerKind.ContentChange}}function J(g){return{label:g.label}}function te(g){return g.map(J)}function ie(g){return{label:g.label,parameters:te(g.parameters)}}function _e(g){return g.map(ie)}function Tt(g){return g===void 0?g:{signatures:_e(g.signatures),activeSignature:g.activeSignature,activeParameter:g.activeParameter}}function dt(g,M,z){return{textDocument:i(g),position:ft(M),context:{isRetrigger:z.isRetrigger,triggerCharacter:z.triggerCharacter,triggerKind:U(z.triggerKind),activeSignatureHelp:Tt(z.activeSignatureHelp)}}}function ft(g){return{line:g.line,character:g.character}}function me(g){return g==null?g:{line:g.line>pe.uinteger.MAX_VALUE?pe.uinteger.MAX_VALUE:g.line,character:g.character>pe.uinteger.MAX_VALUE?pe.uinteger.MAX_VALUE:g.character}}function et(g,M){return pv.map(g,me,M)}function Ge(g){return g==null?g:{start:me(g.start),end:me(g.end)}}function jt(g){return g==null?g:pe.Location.create(r(g.uri),Ge(g.range))}function Zt(g){switch(g){case vt.DiagnosticSeverity.Error:return pe.DiagnosticSeverity.Error;case vt.DiagnosticSeverity.Warning:return pe.DiagnosticSeverity.Warning;case vt.DiagnosticSeverity.Information:return pe.DiagnosticSeverity.Information;case vt.DiagnosticSeverity.Hint:return pe.DiagnosticSeverity.Hint}}function Yn(g){if(!g)return;let M=[];for(let z of g){let he=It(z);he!==void 0&&M.push(he)}return M.length>0?M:void 0}function It(g){switch(g){case vt.DiagnosticTag.Unnecessary:return pe.DiagnosticTag.Unnecessary;case vt.DiagnosticTag.Deprecated:return pe.DiagnosticTag.Deprecated;default:return}}function ci(g){return{message:g.message,location:jt(g.location)}}function Lr(g){return g.map(ci)}function ur(g){if(g!=null)return fs.number(g)||fs.string(g)?g:{value:g.value,target:r(g.target)}}function lr(g){let M=pe.Diagnostic.create(Ge(g.range),g.message),z=g instanceof gv.ProtocolDiagnostic?g:void 0;z!==void 0&&z.data!==void 0&&(M.data=z.data);let he=ur(g.code);return gv.DiagnosticCode.is(he)?z!==void 0&&z.hasDiagnosticCode?M.code=he:(M.code=he.value,M.codeDescription={href:he.target}):M.code=he,fs.number(g.severity)&&(M.severity=Zt(g.severity)),Array.isArray(g.tags)&&(M.tags=Yn(g.tags)),g.relatedInformation&&(M.relatedInformation=Lr(g.relatedInformation)),g.source&&(M.source=g.source),M}function dr(g,M){return g==null?g:pv.map(g,lr,M)}function ui(g,M){switch(g){case"$string":return M;case pe.MarkupKind.PlainText:return{kind:g,value:M};case pe.MarkupKind.Markdown:return{kind:g,value:M.value};default:return`Unsupported Markup content received. Kind is: ${g}`}}function Mr(g){switch(g){case vt.CompletionItemTag.Deprecated:return pe.CompletionItemTag.Deprecated}}function Ar(g){if(g===void 0)return g;let M=[];for(let z of g){let he=Mr(z);he!==void 0&&M.push(he)}return M}function fr(g,M){return M!==void 0?M:g+1}function wt(g,M=!1){let z,he;fs.string(g.label)?z=g.label:(z=g.label.label,M&&(g.label.detail!==void 0||g.label.description!==void 0)&&(he={detail:g.label.detail,description:g.label.description}));let I={label:z};he!==void 0&&(I.labelDetails=he);let m=g instanceof Ck.default?g:void 0;g.detail&&(I.detail=g.detail),g.documentation&&(!m||m.documentationFormat==="$string"?I.documentation=g.documentation:I.documentation=ui(m.documentationFormat,g.documentation)),g.filterText&&(I.filterText=g.filterText),$r(I,g),fs.number(g.kind)&&(I.kind=fr(g.kind,m&&m.originalItemKind)),g.sortText&&(I.sortText=g.sortText),g.additionalTextEdits&&(I.additionalTextEdits=jr(g.additionalTextEdits)),g.commitCharacters&&(I.commitCharacters=g.commitCharacters.slice()),g.command&&(I.command=en(g.command)),(g.preselect===!0||g.preselect===!1)&&(I.preselect=g.preselect);let _=Ar(g.tags);if(m){if(m.data!==void 0&&(I.data=m.data),m.deprecated===!0||m.deprecated===!1){if(m.deprecated===!0&&_!==void 0&&_.length>0){let E=_.indexOf(vt.CompletionItemTag.Deprecated);E!==-1&&_.splice(E,1)}I.deprecated=m.deprecated}m.insertTextMode!==void 0&&(I.insertTextMode=m.insertTextMode)}return _!==void 0&&_.length>0&&(I.tags=_),I.insertTextMode===void 0&&g.keepWhitespace===!0&&(I.insertTextMode=pe.InsertTextMode.adjustIndentation),I}function $r(g,M){let z=pe.InsertTextFormat.PlainText,he,I;M.textEdit?(he=M.textEdit.newText,I=M.textEdit.range):M.insertText instanceof vt.SnippetString?(z=pe.InsertTextFormat.Snippet,he=M.insertText.value):he=M.insertText,M.range&&(I=M.range),g.insertTextFormat=z,M.fromEdit&&he!==void 0&&I!==void 0?g.textEdit=Jn(he,I):g.insertText=he}function Jn(g,M){return Kl.is(M)?pe.InsertReplaceEdit.create(g,Ge(M.inserting),Ge(M.replacing)):{newText:g,range:Ge(M)}}function Cn(g){return{range:Ge(g.range),newText:g.newText}}function jr(g){return g==null?g:g.map(Cn)}function Wt(g){return g<=vt.SymbolKind.TypeParameter?g+1:pe.SymbolKind.Property}function hr(g){return g}function ht(g){return g.map(hr)}function In(g,M,z){return{textDocument:i(g),position:ft(M),context:{includeDeclaration:z.includeDeclaration}}}async function Ht(g,M){let z=pe.CodeAction.create(g.title);if(g instanceof Sk.default&&g.data!==void 0&&(z.data=g.data),g.kind!==void 0&&(z.kind=gr(g.kind)),g.diagnostics!==void 0&&(z.diagnostics=await dr(g.diagnostics,M)),g.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return g.command!==void 0&&(z.command=en(g.command)),g.isPreferred!==void 0&&(z.isPreferred=g.isPreferred),g.disabled!==void 0&&(z.disabled={reason:g.disabled.reason}),z}async function pr(g,M){if(g==null)return g;let z;return g.only&&fs.string(g.only.value)&&(z=[g.only.value]),pe.CodeActionContext.create(await dr(g.diagnostics,M),z,dn(g.triggerKind))}function dn(g){switch(g){case vt.CodeActionTriggerKind.Invoke:return pe.CodeActionTriggerKind.Invoked;case vt.CodeActionTriggerKind.Automatic:return pe.CodeActionTriggerKind.Automatic;default:return}}function gr(g){if(g!=null)return g.value}function Wr(g){return g==null?g:pe.InlineValueContext.create(g.frameId,Ge(g.stoppedLocation))}function en(g){let M=pe.Command.create(g.title,g.command);return g.arguments&&(M.arguments=g.arguments),M}function Hr(g){let M=pe.CodeLens.create(Ge(g.range));return g.command&&(M.command=en(g.command)),g instanceof Dk.default&&g.data&&(M.data=g.data),M}function fn(g,M){let z={tabSize:g.tabSize,insertSpaces:g.insertSpaces};return M.trimTrailingWhitespace&&(z.trimTrailingWhitespace=!0),M.trimFinalNewlines&&(z.trimFinalNewlines=!0),M.insertFinalNewline&&(z.insertFinalNewline=!0),z}function P(g){return{textDocument:i(g)}}function $(g){return{textDocument:i(g)}}function X(g){let M=pe.DocumentLink.create(Ge(g.range));g.target&&(M.target=r(g.target)),g.tooltip!==void 0&&(M.tooltip=g.tooltip);let z=g instanceof Tk.default?g:void 0;return z&&z.data&&(M.data=z.data),M}function Y(g){return{textDocument:i(g)}}function Ee(g){let M={name:g.name,kind:Wt(g.kind),uri:r(g.uri),range:Ge(g.range),selectionRange:Ge(g.selectionRange)};return g.detail!==void 0&&g.detail.length>0&&(M.detail=g.detail),g.tags!==void 0&&(M.tags=ht(g.tags)),g instanceof Rk.default&&g.data!==void 0&&(M.data=g.data),M}function Re(g){let M={name:g.name,kind:Wt(g.kind),uri:r(g.uri),range:Ge(g.range),selectionRange:Ge(g.selectionRange)};return g.detail!==void 0&&g.detail.length>0&&(M.detail=g.detail),g.tags!==void 0&&(M.tags=ht(g.tags)),g instanceof kk.default&&g.data!==void 0&&(M.data=g.data),M}function ke(g){let M=g instanceof Pk.default?{name:g.name,kind:Wt(g.kind),location:g.hasRange?jt(g.location):{uri:t(g.location.uri)},data:g.data}:{name:g.name,kind:Wt(g.kind),location:jt(g.location)};return g.tags!==void 0&&(M.tags=ht(g.tags)),g.containerName!==""&&(M.containerName=g.containerName),M}function We(g){let M=typeof g.label=="string"?g.label:g.label.map(fe),z=pe.InlayHint.create(me(g.position),M);return g.kind!==void 0&&(z.kind=g.kind),g.textEdits!==void 0&&(z.textEdits=jr(g.textEdits)),g.tooltip!==void 0&&(z.tooltip=xe(g.tooltip)),g.paddingLeft!==void 0&&(z.paddingLeft=g.paddingLeft),g.paddingRight!==void 0&&(z.paddingRight=g.paddingRight),g instanceof _k.default&&g.data!==void 0&&(z.data=g.data),z}function fe(g){let M=pe.InlayHintLabelPart.create(g.value);return g.location!==void 0&&(M.location=jt(g.location)),g.command!==void 0&&(M.command=en(g.command)),g.tooltip!==void 0&&(M.tooltip=xe(g.tooltip)),M}function xe(g){return typeof g=="string"?g:{kind:pe.MarkupKind.Markdown,value:g.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:s,asVersionedTextDocumentIdentifier:o,asOpenTextDocumentParams:a,asChangeTextDocumentParams:l,asCloseTextDocumentParams:h,asSaveTextDocumentParams:f,asWillSaveTextDocumentParams:b,asDidCreateFilesParams:y,asDidRenameFilesParams:S,asDidDeleteFilesParams:R,asWillCreateFilesParams:v,asWillRenameFilesParams:D,asWillDeleteFilesParams:k,asTextDocumentPositionParams:x,asCompletionParams:N,asSignatureHelpParams:dt,asWorkerPosition:ft,asRange:Ge,asPosition:me,asPositions:et,asLocation:jt,asDiagnosticSeverity:Zt,asDiagnosticTag:It,asDiagnostic:lr,asDiagnostics:dr,asCompletionItem:wt,asTextEdit:Cn,asSymbolKind:Wt,asSymbolTag:hr,asSymbolTags:ht,asReferenceParams:In,asCodeAction:Ht,asCodeActionContext:pr,asInlineValueContext:Wr,asCommand:en,asCodeLens:Hr,asFormattingOptions:fn,asDocumentSymbolParams:P,asCodeLensParams:$,asDocumentLink:X,asDocumentLinkParams:Y,asCallHierarchyItem:Ee,asTypeHierarchyItem:Re,asInlayHint:We,asWorkspaceSymbol:ke}}Qa.createConverter=Ek});var wv=L(Ja=>{"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});Ja.createConverter=void 0;var B=require("vscode"),ae=ue(),Pn=Rn(),Oe=Ba(),xk=Pl(),Fk=El(),Ik=Fl(),Ok=Ol(),vv=ql(),Nk=Ml(),qk=$l(),Lk=Wl(),Mk=Ul(),yv=ue(),Ya;(function(n){function e(t){let r=t;return r&&Pn.string(r.language)&&Pn.string(r.value)}n.is=e})(Ya||(Ya={}));function Ak(n,e,t){let i=n||(d=>B.Uri.parse(d));function s(d){return i(d)}function o(d){let O=[];for(let H of d)if(typeof H=="string")O.push(H);else if(yv.NotebookCellTextDocumentFilter.is(H))if(typeof H.notebook=="string")O.push({notebookType:H.notebook,language:H.language});else{let se=H.notebook.notebookType??"*";O.push({notebookType:se,scheme:H.notebook.scheme,pattern:H.notebook.pattern,language:H.language})}else yv.TextDocumentFilter.is(H)&&O.push({language:H.language,scheme:H.scheme,pattern:H.pattern});return O}async function a(d,O){return Oe.map(d,u,O)}function c(d){let O=new Array(d.length);for(let H=0;H<d.length;H++)O[H]=u(d[H]);return O}function u(d){let O=new vv.ProtocolDiagnostic(b(d.range),d.message,S(d.severity),d.data);if(d.code!==void 0){if(typeof d.code=="string"||typeof d.code=="number")ae.CodeDescription.is(d.codeDescription)?O.code={value:d.code,target:s(d.codeDescription.href)}:O.code=d.code;else if(vv.DiagnosticCode.is(d.code)){O.hasDiagnosticCode=!0;let H=d.code;O.code={value:H.value,target:s(H.target)}}}return d.source&&(O.source=d.source),d.relatedInformation&&(O.relatedInformation=l(d.relatedInformation)),Array.isArray(d.tags)&&(O.tags=h(d.tags)),O}function l(d){let O=new Array(d.length);for(let H=0;H<d.length;H++){let se=d[H];O[H]=new B.DiagnosticRelatedInformation(It(se.location),se.message)}return O}function h(d){if(!d)return;let O=[];for(let H of d){let se=f(H);se!==void 0&&O.push(se)}return O.length>0?O:void 0}function f(d){switch(d){case ae.DiagnosticTag.Unnecessary:return B.DiagnosticTag.Unnecessary;case ae.DiagnosticTag.Deprecated:return B.DiagnosticTag.Deprecated;default:return}}function C(d){return d?new B.Position(d.line,d.character):void 0}function b(d){return d?new B.Range(d.start.line,d.start.character,d.end.line,d.end.character):void 0}async function y(d,O){return Oe.map(d,H=>new B.Range(H.start.line,H.start.character,H.end.line,H.end.character),O)}function S(d){if(d==null)return B.DiagnosticSeverity.Error;switch(d){case ae.DiagnosticSeverity.Error:return B.DiagnosticSeverity.Error;case ae.DiagnosticSeverity.Warning:return B.DiagnosticSeverity.Warning;case ae.DiagnosticSeverity.Information:return B.DiagnosticSeverity.Information;case ae.DiagnosticSeverity.Hint:return B.DiagnosticSeverity.Hint}return B.DiagnosticSeverity.Error}function R(d){if(Pn.string(d))return D(d);if(Ya.is(d))return D().appendCodeblock(d.value,d.language);if(Array.isArray(d)){let O=[];for(let H of d){let se=D();Ya.is(H)?se.appendCodeblock(H.value,H.language):se.appendMarkdown(H),O.push(se)}return O}else return D(d)}function v(d){if(Pn.string(d))return d;switch(d.kind){case ae.MarkupKind.Markdown:return D(d.value);case ae.MarkupKind.PlainText:return d.value;default:return`Unsupported Markup content received. Kind is: ${d.kind}`}}function D(d){let O;if(d===void 0||typeof d=="string")O=new B.MarkdownString(d);else switch(d.kind){case ae.MarkupKind.Markdown:O=new B.MarkdownString(d.value);break;case ae.MarkupKind.PlainText:O=new B.MarkdownString,O.appendText(d.value);break;default:O=new B.MarkdownString,O.appendText(`Unsupported Markup content received. Kind is: ${d.kind}`);break}return O.isTrusted=e,O.supportHtml=t,O}function k(d){if(!!d)return new B.Hover(R(d.contents),b(d.range))}async function x(d,O,H){if(!d)return;if(Array.isArray(d))return Oe.map(d,Zn=>te(Zn,O),H);let se=d,{defaultRange:Pt,commitCharacters:pt}=F(se,O),Ae=await Oe.map(se.items,Zn=>{var qe,li,Fs;return te(Zn,pt,Pt,(qe=se.itemDefaults)==null?void 0:qe.insertTextMode,(li=se.itemDefaults)==null?void 0:li.insertTextFormat,(Fs=se.itemDefaults)==null?void 0:Fs.data)},H);return new B.CompletionList(Ae,se.isIncomplete)}function F(d,O){var Pt,pt;let H=(Pt=d.itemDefaults)==null?void 0:Pt.editRange,se=((pt=d.itemDefaults)==null?void 0:pt.commitCharacters)??O;return ae.Range.is(H)?{defaultRange:b(H),commitCharacters:se}:H!==void 0?{defaultRange:{inserting:b(H.insert),replacing:b(H.replace)},commitCharacters:se}:{defaultRange:void 0,commitCharacters:se}}function N(d){return ae.CompletionItemKind.Text<=d&&d<=ae.CompletionItemKind.TypeParameter?[d-1,void 0]:[B.CompletionItemKind.Text,d]}function U(d){switch(d){case ae.CompletionItemTag.Deprecated:return B.CompletionItemTag.Deprecated}}function J(d){if(d==null)return[];let O=[];for(let H of d){let se=U(H);se!==void 0&&O.push(se)}return O}function te(d,O,H,se,Pt,pt){let Ae=J(d.tags),Zn=ie(d),qe=new xk.default(Zn);d.detail&&(qe.detail=d.detail),d.documentation&&(qe.documentation=v(d.documentation),qe.documentationFormat=Pn.string(d.documentation)?"$string":d.documentation.kind),d.filterText&&(qe.filterText=d.filterText);let li=_e(d,H,Pt);if(li&&(qe.insertText=li.text,qe.range=li.range,qe.fromEdit=li.fromEdit),Pn.number(d.kind)){let[OC,bf]=N(d.kind);qe.kind=OC,bf&&(qe.originalItemKind=bf)}d.sortText&&(qe.sortText=d.sortText),d.additionalTextEdits&&(qe.additionalTextEdits=me(d.additionalTextEdits));let Fs=d.commitCharacters!==void 0?Pn.stringArray(d.commitCharacters)?d.commitCharacters:void 0:O;Fs&&(qe.commitCharacters=Fs.slice()),d.command&&(qe.command=ht(d.command)),(d.deprecated===!0||d.deprecated===!1)&&(qe.deprecated=d.deprecated,d.deprecated===!0&&Ae.push(B.CompletionItemTag.Deprecated)),(d.preselect===!0||d.preselect===!1)&&(qe.preselect=d.preselect);let wf=d.data??pt;wf!==void 0&&(qe.data=wf),Ae.length>0&&(qe.tags=Ae);let nu=d.insertTextMode??se;return nu!==void 0&&(qe.insertTextMode=nu,nu===ae.InsertTextMode.asIs&&(qe.keepWhitespace=!0)),qe}function ie(d){return ae.CompletionItemLabelDetails.is(d.labelDetails)?{label:d.label,detail:d.labelDetails.detail,description:d.labelDetails.description}:d.label}function _e(d,O,H){let se=d.insertTextFormat??H;if(d.textEdit!==void 0||O!==void 0){let[Pt,pt]=d.textEdit!==void 0?Tt(d.textEdit):[O,d.textEditText??d.label];return se===ae.InsertTextFormat.Snippet?{text:new B.SnippetString(pt),range:Pt,fromEdit:!0}:{text:pt,range:Pt,fromEdit:!0}}else return d.insertText?se===ae.InsertTextFormat.Snippet?{text:new B.SnippetString(d.insertText),fromEdit:!1}:{text:d.insertText,fromEdit:!1}:void 0}function Tt(d){return ae.InsertReplaceEdit.is(d)?[{inserting:b(d.insert),replacing:b(d.replace)},d.newText]:[b(d.range),d.newText]}function dt(d){if(!!d)return new B.TextEdit(b(d.range),d.newText)}async function ft(d,O){if(!!d)return Oe.map(d,dt,O)}function me(d){if(!d)return;let O=new Array(d.length);for(let H=0;H<d.length;H++)O[H]=dt(d[H]);return O}async function et(d,O){if(!d)return;let H=new B.SignatureHelp;return Pn.number(d.activeSignature)?H.activeSignature=d.activeSignature:H.activeSignature=0,Pn.number(d.activeParameter)?H.activeParameter=d.activeParameter:H.activeParameter=0,d.signatures&&(H.signatures=await Ge(d.signatures,O)),H}async function Ge(d,O){return Oe.mapAsync(d,jt,O)}async function jt(d,O){let H=new B.SignatureInformation(d.label);return d.documentation!==void 0&&(H.documentation=v(d.documentation)),d.parameters!==void 0&&(H.parameters=await Zt(d.parameters,O)),d.activeParameter!==void 0&&(H.activeParameter=d.activeParameter),H}function Zt(d,O){return Oe.map(d,Yn,O)}function Yn(d){let O=new B.ParameterInformation(d.label);return d.documentation&&(O.documentation=v(d.documentation)),O}function It(d){return d?new B.Location(i(d.uri),b(d.range)):void 0}async function ci(d,O){if(!!d)return lr(d,O)}async function Lr(d,O){if(!!d)return lr(d,O)}function ur(d){if(!d)return;let O={targetUri:i(d.targetUri),targetRange:b(d.targetRange),originSelectionRange:b(d.originSelectionRange),targetSelectionRange:b(d.targetSelectionRange)};if(!O.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return O}async function lr(d,O){if(!!d)if(Pn.array(d)){if(d.length===0)return[];if(ae.LocationLink.is(d[0])){let H=d;return Oe.map(H,ur,O)}else{let H=d;return Oe.map(H,It,O)}}else return ae.LocationLink.is(d)?[ur(d)]:It(d)}async function dr(d,O){if(!!d)return Oe.map(d,It,O)}async function ui(d,O){if(!!d)return Oe.map(d,Mr,O)}function Mr(d){let O=new B.DocumentHighlight(b(d.range));return Pn.number(d.kind)&&(O.kind=Ar(d.kind)),O}function Ar(d){switch(d){case ae.DocumentHighlightKind.Text:return B.DocumentHighlightKind.Text;case ae.DocumentHighlightKind.Read:return B.DocumentHighlightKind.Read;case ae.DocumentHighlightKind.Write:return B.DocumentHighlightKind.Write}return B.DocumentHighlightKind.Text}async function fr(d,O){if(!!d)return Oe.map(d,Cn,O)}function wt(d){return d<=ae.SymbolKind.TypeParameter?d-1:B.SymbolKind.Property}function $r(d){switch(d){case ae.SymbolTag.Deprecated:return B.SymbolTag.Deprecated;default:return}}function Jn(d){if(d==null)return;let O=[];for(let H of d){let se=$r(H);se!==void 0&&O.push(se)}return O.length===0?void 0:O}function Cn(d){let O=d.data,H=d.location,se=H.range===void 0||O!==void 0?new Lk.default(d.name,wt(d.kind),d.containerName??"",H.range===void 0?i(H.uri):new B.Location(i(d.location.uri),b(H.range)),O):new B.SymbolInformation(d.name,wt(d.kind),d.containerName??"",new B.Location(i(d.location.uri),b(H.range)));return hr(se,d),se}async function jr(d,O){if(d!=null)return Oe.map(d,Wt,O)}function Wt(d){let O=new B.DocumentSymbol(d.name,d.detail||"",wt(d.kind),b(d.range),b(d.selectionRange));if(hr(O,d),d.children!==void 0&&d.children.length>0){let H=[];for(let se of d.children)H.push(Wt(se));O.children=H}return O}function hr(d,O){d.tags=Jn(O.tags),O.deprecated&&(d.tags?d.tags.includes(B.SymbolTag.Deprecated)||(d.tags=d.tags.concat(B.SymbolTag.Deprecated)):d.tags=[B.SymbolTag.Deprecated])}function ht(d){let O={title:d.title,command:d.command};return d.arguments&&(O.arguments=d.arguments),O}async function In(d,O){if(!!d)return Oe.map(d,ht,O)}let Ht=new Map;Ht.set(ae.CodeActionKind.Empty,B.CodeActionKind.Empty),Ht.set(ae.CodeActionKind.QuickFix,B.CodeActionKind.QuickFix),Ht.set(ae.CodeActionKind.Refactor,B.CodeActionKind.Refactor),Ht.set(ae.CodeActionKind.RefactorExtract,B.CodeActionKind.RefactorExtract),Ht.set(ae.CodeActionKind.RefactorInline,B.CodeActionKind.RefactorInline),Ht.set(ae.CodeActionKind.RefactorRewrite,B.CodeActionKind.RefactorRewrite),Ht.set(ae.CodeActionKind.Source,B.CodeActionKind.Source),Ht.set(ae.CodeActionKind.SourceOrganizeImports,B.CodeActionKind.SourceOrganizeImports);function pr(d){if(d==null)return;let O=Ht.get(d);if(O)return O;let H=d.split(".");O=B.CodeActionKind.Empty;for(let se of H)O=O.append(se);return O}function dn(d){if(d!=null)return d.map(O=>pr(O))}async function gr(d,O){if(d==null)return;let H=new Ok.default(d.title,d.data);return d.kind!==void 0&&(H.kind=pr(d.kind)),d.diagnostics!==void 0&&(H.diagnostics=c(d.diagnostics)),d.edit!==void 0&&(H.edit=await fn(d.edit,O)),d.command!==void 0&&(H.command=ht(d.command)),d.isPreferred!==void 0&&(H.isPreferred=d.isPreferred),d.disabled!==void 0&&(H.disabled={reason:d.disabled.reason}),H}function Wr(d,O){return Oe.mapAsync(d,async H=>ae.Command.is(H)?ht(H):gr(H,O),O)}function en(d){if(!d)return;let O=new Fk.default(b(d.range));return d.command&&(O.command=ht(d.command)),d.data!==void 0&&d.data!==null&&(O.data=d.data),O}async function Hr(d,O){if(!!d)return Oe.map(d,en,O)}async function fn(d,O){if(!d)return;let H=new Map;if(d.changeAnnotations!==void 0){let pt=d.changeAnnotations;await Oe.forEach(Object.keys(pt),Ae=>{let Zn=P(pt[Ae]);H.set(Ae,Zn)},O)}let se=pt=>{if(pt!==void 0)return H.get(pt)},Pt=new B.WorkspaceEdit;if(d.documentChanges){let pt=d.documentChanges;await Oe.forEach(pt,Ae=>{if(ae.CreateFile.is(Ae))Pt.createFile(i(Ae.uri),Ae.options,se(Ae.annotationId));else if(ae.RenameFile.is(Ae))Pt.renameFile(i(Ae.oldUri),i(Ae.newUri),Ae.options,se(Ae.annotationId));else if(ae.DeleteFile.is(Ae))Pt.deleteFile(i(Ae.uri),Ae.options,se(Ae.annotationId));else if(ae.TextDocumentEdit.is(Ae)){let Zn=i(Ae.textDocument.uri);for(let qe of Ae.edits)ae.AnnotatedTextEdit.is(qe)?Pt.replace(Zn,b(qe.range),qe.newText,se(qe.annotationId)):Pt.replace(Zn,b(qe.range),qe.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(Ae,void 0,4)}`)},O)}else if(d.changes){let pt=d.changes;await Oe.forEach(Object.keys(pt),Ae=>{Pt.set(i(Ae),me(pt[Ae]))},O)}return Pt}function P(d){if(d!==void 0)return{label:d.label,needsConfirmation:!!d.needsConfirmation,description:d.description}}function $(d){let O=b(d.range),H=d.target?s(d.target):void 0,se=new Ik.default(O,H);return d.tooltip!==void 0&&(se.tooltip=d.tooltip),d.data!==void 0&&d.data!==null&&(se.data=d.data),se}async function X(d,O){if(!!d)return Oe.map(d,$,O)}function Y(d){return new B.Color(d.red,d.green,d.blue,d.alpha)}function Ee(d){return new B.ColorInformation(b(d.range),Y(d.color))}async function Re(d,O){if(!!d)return Oe.map(d,Ee,O)}function ke(d){let O=new B.ColorPresentation(d.label);return O.additionalTextEdits=me(d.additionalTextEdits),d.textEdit&&(O.textEdit=dt(d.textEdit)),O}async function We(d,O){if(!!d)return Oe.map(d,ke,O)}function fe(d){if(d)switch(d){case ae.FoldingRangeKind.Comment:return B.FoldingRangeKind.Comment;case ae.FoldingRangeKind.Imports:return B.FoldingRangeKind.Imports;case ae.FoldingRangeKind.Region:return B.FoldingRangeKind.Region}}function xe(d){return new B.FoldingRange(d.startLine,d.endLine,fe(d.kind))}async function g(d,O){if(!!d)return Oe.map(d,xe,O)}function M(d){return new B.SelectionRange(b(d.range),d.parent?M(d.parent):void 0)}async function z(d,O){return Array.isArray(d)?Oe.map(d,M,O):[]}function he(d){return ae.InlineValueText.is(d)?new B.InlineValueText(b(d.range),d.text):ae.InlineValueVariableLookup.is(d)?new B.InlineValueVariableLookup(b(d.range),d.variableName,d.caseSensitiveLookup):new B.InlineValueEvaluatableExpression(b(d.range),d.expression)}async function I(d,O){return Array.isArray(d)?Oe.map(d,he,O):[]}async function m(d,O){let H=typeof d.label=="string"?d.label:await Oe.map(d.label,_,O),se=new Mk.default(C(d.position),H);return d.kind!==void 0&&(se.kind=d.kind),d.textEdits!==void 0&&(se.textEdits=await ft(d.textEdits,O)),d.tooltip!==void 0&&(se.tooltip=E(d.tooltip)),d.paddingLeft!==void 0&&(se.paddingLeft=d.paddingLeft),d.paddingRight!==void 0&&(se.paddingRight=d.paddingRight),d.data!==void 0&&(se.data=d.data),se}function _(d){let O=new B.InlayHintLabelPart(d.value);return d.location!==void 0&&(O.location=It(d.location)),d.tooltip!==void 0&&(O.tooltip=E(d.tooltip)),d.command!==void 0&&(O.command=ht(d.command)),O}function E(d){return typeof d=="string"?d:D(d)}async function T(d,O){if(!!Array.isArray(d))return Oe.mapAsync(d,m,O)}function p(d){if(d===null)return;let O=new Nk.default(wt(d.kind),d.name,d.detail||"",s(d.uri),b(d.range),b(d.selectionRange),d.data);return d.tags!==void 0&&(O.tags=Jn(d.tags)),O}async function q(d,O){if(d!==null)return Oe.map(d,p,O)}async function j(d,O){return new B.CallHierarchyIncomingCall(p(d.from),await y(d.fromRanges,O))}async function ce(d,O){if(d!==null)return Oe.mapAsync(d,j,O)}async function Xe(d,O){return new B.CallHierarchyOutgoingCall(p(d.to),await y(d.fromRanges,O))}async function je(d,O){if(d!==null)return Oe.mapAsync(d,Xe,O)}async function hn(d,O){if(d!=null)return new B.SemanticTokens(new Uint32Array(d.data),d.resultId)}function tn(d){return new B.SemanticTokensEdit(d.start,d.deleteCount,d.data!==void 0?new Uint32Array(d.data):void 0)}async function On(d,O){if(d!=null)return new B.SemanticTokensEdits(d.edits.map(tn),d.resultId)}function Ce(d){return d}async function Ur(d,O){if(d!=null)return new B.LinkedEditingRanges(await y(d.ranges,O),Li(d.wordPattern))}function Li(d){if(d!=null)return new RegExp(d)}function xs(d){if(d===null)return;let O=new qk.default(wt(d.kind),d.name,d.detail||"",s(d.uri),b(d.range),b(d.selectionRange),d.data);return d.tags!==void 0&&(O.tags=Jn(d.tags)),O}async function FC(d,O){if(d!==null)return Oe.map(d,xs,O)}function IC(d){if(Pn.string(d))return d;if(ae.RelativePattern.is(d)){if(ae.URI.is(d.baseUri))return new B.RelativePattern(s(d.baseUri),d.pattern);if(ae.WorkspaceFolder.is(d.baseUri)){let O=B.workspace.getWorkspaceFolder(s(d.baseUri.uri));return O!==void 0?new B.RelativePattern(O,d.pattern):void 0}}}return{asUri:s,asDocumentSelector:o,asDiagnostics:a,asDiagnostic:u,asRange:b,asRanges:y,asPosition:C,asDiagnosticSeverity:S,asDiagnosticTag:f,asHover:k,asCompletionResult:x,asCompletionItem:te,asTextEdit:dt,asTextEdits:ft,asSignatureHelp:et,asSignatureInformations:Ge,asSignatureInformation:jt,asParameterInformations:Zt,asParameterInformation:Yn,asDeclarationResult:ci,asDefinitionResult:Lr,asLocation:It,asReferences:dr,asDocumentHighlights:ui,asDocumentHighlight:Mr,asDocumentHighlightKind:Ar,asSymbolKind:wt,asSymbolTag:$r,asSymbolTags:Jn,asSymbolInformations:fr,asSymbolInformation:Cn,asDocumentSymbols:jr,asDocumentSymbol:Wt,asCommand:ht,asCommands:In,asCodeAction:gr,asCodeActionKind:pr,asCodeActionKinds:dn,asCodeActionResult:Wr,asCodeLens:en,asCodeLenses:Hr,asWorkspaceEdit:fn,asDocumentLink:$,asDocumentLinks:X,asFoldingRangeKind:fe,asFoldingRange:xe,asFoldingRanges:g,asColor:Y,asColorInformation:Ee,asColorInformations:Re,asColorPresentation:ke,asColorPresentations:We,asSelectionRange:M,asSelectionRanges:z,asInlineValue:he,asInlineValues:I,asInlayHint:m,asInlayHints:T,asSemanticTokensLegend:Ce,asSemanticTokens:hn,asSemanticTokensEdit:tn,asSemanticTokensEdits:On,asCallHierarchyItem:p,asCallHierarchyItems:q,asCallHierarchyIncomingCall:j,asCallHierarchyIncomingCalls:ce,asCallHierarchyOutgoingCall:Xe,asCallHierarchyOutgoingCalls:je,asLinkedEditingRanges:Ur,asTypeHierarchyItem:xs,asTypeHierarchyItems:FC,asGlobPattern:IC}}Ja.createConverter=Ak});var it=L(_n=>{"use strict";Object.defineProperty(_n,"__esModule",{value:!0});_n.generateUuid=_n.parse=_n.isUUID=_n.v4=_n.empty=void 0;var Za=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},ve=class extends Za{constructor(){super([ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),"-",ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),"-","4",ve._randomHex(),ve._randomHex(),ve._randomHex(),"-",ve._oneOf(ve._timeHighBits),ve._randomHex(),ve._randomHex(),ve._randomHex(),"-",ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex(),ve._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return ve._oneOf(ve._chars)}};ve._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];ve._timeHighBits=["8","9","a","b"];_n.empty=new Za("00000000-0000-0000-0000-000000000000");function bv(){return new ve}_n.v4=bv;var $k=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Cv(n){return $k.test(n)}_n.isUUID=Cv;function jk(n){if(!Cv(n))throw new Error("invalid uuid");return new Za(n)}_n.parse=jk;function Wk(){return bv().asHex()}_n.generateUuid=Wk});var Vl=L(ec=>{"use strict";Object.defineProperty(ec,"__esModule",{value:!0});ec.ProgressPart=void 0;var Dv=require("vscode"),Tv=ue(),Sv=Rn(),Rv=class{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(Tv.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&Dv.window.withProgress({location:Dv.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(Tv.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,s)=>{this._resolve=i,this._reject=s})})}report(e){if(this._infinite&&Sv.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(Sv.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};ec.ProgressPart=Rv});var Pe=L(yt=>{"use strict";Object.defineProperty(yt,"__esModule",{value:!0});yt.WorkspaceFeature=yt.TextDocumentLanguageFeature=yt.TextDocumentEventFeature=yt.DynamicDocumentFeature=yt.DynamicFeature=yt.StaticFeature=yt.ensure=yt.LSPCancellationError=void 0;var Si=require("vscode"),Xl=ue(),zt=Rn(),kv=it(),Pv=class extends Si.CancellationError{constructor(e){super();this.data=e}};yt.LSPCancellationError=Pv;function Hk(n,e){return n[e]===void 0&&(n[e]={}),n[e]}yt.ensure=Hk;var Uk;(function(n){function e(t){let r=t;return r!=null&&zt.func(r.fillClientCapabilities)&&zt.func(r.initialize)&&zt.func(r.getState)&&zt.func(r.dispose)&&(r.fillInitializeParams===void 0||zt.func(r.fillInitializeParams))}n.is=e})(Uk=yt.StaticFeature||(yt.StaticFeature={}));var Kk;(function(n){function e(t){let r=t;return r!=null&&zt.func(r.fillClientCapabilities)&&zt.func(r.initialize)&&zt.func(r.getState)&&zt.func(r.dispose)&&(r.fillInitializeParams===void 0||zt.func(r.fillInitializeParams))&&zt.func(r.register)&&zt.func(r.unregister)&&r.registrationType!==void 0}n.is=e})(Kk=yt.DynamicFeature||(yt.DynamicFeature={}));var tc=class{constructor(e){this._client=e}getState(){let e=this.getDocumentSelectors(),t=0;for(let i of e){t++;for(let s of Si.workspace.textDocuments)if(Si.languages.match(i,s)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}let r=t>0;return{kind:"document",id:this.registrationType.method,registrations:r,matches:!1}}};yt.DynamicDocumentFeature=tc;var _v=class extends tc{constructor(e,t,r,i,s,o,a){super(e);this._event=t,this._type=r,this._middleware=i,this._createParams=s,this._textDocument=o,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new Si.EventEmitter}static textDocumentFilter(e,t){for(let r of e)if(Si.languages.match(r,t)>0)return!0;return!1}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async r=>{let i=this._createParams(r);await this._client.sendNotification(this._type,i),this.notificationSent(this.getTextDocument(r),this._type,i)};if(this.matches(e)){let r=this._middleware();return r?r(e,i=>t(i)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(Si.languages.match(t,e)>0)return{send:r=>this.callback(r)}}};yt.TextDocumentEventFeature=_v;var Ev=class extends tc{constructor(e,t){super(e);this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(let e of this._registrations.values()){let t=e.data.registerOptions.documentSelector;t!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(Xl.TextDocumentRegistrationOptions.is(t)){let r=Xl.StaticRegistrationOptions.hasId(t)?t.id:kv.generateUuid(),i=t.documentSelector??e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(zt.boolean(t)&&t===!0||Xl.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let r=zt.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[kv.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return zt.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&Si.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e)>0)return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};yt.TextDocumentLanguageFeature=Ev;var xv=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){let e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};yt.WorkspaceFeature=xv});var Iv=L((F0,Fv)=>{var Vk=typeof process=="object"&&process&&process.platform==="win32";Fv.exports=Vk?{sep:"\\"}:{sep:"/"}});var Mv=L((I0,Lv)=>{"use strict";Lv.exports=Ov;function Ov(n,e,t){n instanceof RegExp&&(n=Nv(n,t)),e instanceof RegExp&&(e=Nv(e,t));var r=qv(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function Nv(n,e){var t=e.match(n);return t?t[0]:null}Ov.range=qv;function qv(n,e,t){var r,i,s,o,a,c=t.indexOf(n),u=t.indexOf(e,c+1),l=c;if(c>=0&&u>0){if(n===e)return[c,u];for(r=[],s=t.length;l>=0&&!a;)l==c?(r.push(l),c=t.indexOf(n,l+1)):r.length==1?a=[r.pop(),u]:(i=r.pop(),i<s&&(s=i,o=u),u=t.indexOf(e,l+1)),l=c<u&&c>=0?c:u;r.length&&(a=[s,o])}return a}});var Vv=L((O0,Kv)=>{var Av=Mv();Kv.exports=Bk;var $v="\0SLASH"+Math.random()+"\0",jv="\0OPEN"+Math.random()+"\0",zl="\0CLOSE"+Math.random()+"\0",Wv="\0COMMA"+Math.random()+"\0",Hv="\0PERIOD"+Math.random()+"\0";function Bl(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function Xk(n){return n.split("\\\\").join($v).split("\\{").join(jv).split("\\}").join(zl).split("\\,").join(Wv).split("\\.").join(Hv)}function zk(n){return n.split($v).join("\\").split(jv).join("{").split(zl).join("}").split(Wv).join(",").split(Hv).join(".")}function Uv(n){if(!n)return[""];var e=[],t=Av("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,s=t.post,o=r.split(",");o[o.length-1]+="{"+i+"}";var a=Uv(s);return s.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),e.push.apply(e,o),e}function Bk(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),Oo(Xk(n),!0).map(zk)):[]}function Gk(n){return"{"+n+"}"}function Qk(n){return/^-?0\d/.test(n)}function Yk(n,e){return n<=e}function Jk(n,e){return n>=e}function Oo(n,e){var t=[],r=Av("{","}",n);if(!r)return[n];var i=r.pre,s=r.post.length?Oo(r.post,!1):[""];if(/\$$/.test(r.pre))for(var o=0;o<s.length;o++){var a=i+"{"+r.body+"}"+s[o];t.push(a)}else{var c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),u=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),l=c||u,h=r.body.indexOf(",")>=0;if(!l&&!h)return r.post.match(/,.*\}/)?(n=r.pre+"{"+r.body+zl+r.post,Oo(n)):[n];var f;if(l)f=r.body.split(/\.\./);else if(f=Uv(r.body),f.length===1&&(f=Oo(f[0],!1).map(Gk),f.length===1))return s.map(function(te){return r.pre+f[0]+te});var C;if(l){var b=Bl(f[0]),y=Bl(f[1]),S=Math.max(f[0].length,f[1].length),R=f.length==3?Math.abs(Bl(f[2])):1,v=Yk,D=y<b;D&&(R*=-1,v=Jk);var k=f.some(Qk);C=[];for(var x=b;v(x,y);x+=R){var F;if(u)F=String.fromCharCode(x),F==="\\"&&(F="");else if(F=String(x),k){var N=S-F.length;if(N>0){var U=new Array(N+1).join("0");x<0?F="-"+U+F.slice(1):F=U+F}}C.push(F)}}else{C=[];for(var J=0;J<f.length;J++)C.push.apply(C,Oo(f[J],!1))}for(var J=0;J<C.length;J++)for(var o=0;o<s.length;o++){var a=i+C[J]+s[o];(!e||l||a)&&t.push(a)}}return t}});var rc=L((q0,Zl)=>{var mn=Zl.exports=(n,e,t={})=>(nc(e),!t.nocomment&&e.charAt(0)==="#"?!1:new No(e,t).match(n));Zl.exports=mn;var Gl=Iv();mn.sep=Gl.sep;var Vn=Symbol("globstar **");mn.GLOBSTAR=Vn;var Zk=Vv(),Xv={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Ql="[^/]",Yl=Ql+"*?",eP="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",tP="(?:(?!(?:\\/|^)\\.).)*?",zv=n=>n.split("").reduce((e,t)=>(e[t]=!0,e),{}),Bv=zv("().*{}+?[]^$\\!"),nP=zv("[.("),Gv=/\/+/;mn.filter=(n,e={})=>(t,r,i)=>mn(t,n,e);var Zr=(n,e={})=>{let t={};return Object.keys(n).forEach(r=>t[r]=n[r]),Object.keys(e).forEach(r=>t[r]=e[r]),t};mn.defaults=n=>{if(!n||typeof n!="object"||!Object.keys(n).length)return mn;let e=mn,t=(r,i,s)=>e(r,i,Zr(n,s));return t.Minimatch=class extends e.Minimatch{constructor(i,s){super(i,Zr(n,s))}},t.Minimatch.defaults=r=>e.defaults(Zr(n,r)).Minimatch,t.filter=(r,i)=>e.filter(r,Zr(n,i)),t.defaults=r=>e.defaults(Zr(n,r)),t.makeRe=(r,i)=>e.makeRe(r,Zr(n,i)),t.braceExpand=(r,i)=>e.braceExpand(r,Zr(n,i)),t.match=(r,i,s)=>e.match(r,i,Zr(n,s)),t};mn.braceExpand=(n,e)=>Qv(n,e);var Qv=(n,e={})=>(nc(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:Zk(n)),rP=1024*64,nc=n=>{if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>rP)throw new TypeError("pattern is too long")},Jl=Symbol("subparse");mn.makeRe=(n,e)=>new No(n,e||{}).makeRe();mn.match=(n,e,t={})=>{let r=new No(e,t);return n=n.filter(i=>r.match(i)),r.options.nonull&&!n.length&&n.push(e),n};var iP=n=>n.replace(/\\(.)/g,"$1"),sP=n=>n.replace(/\\([^-\]])/g,"$1"),oP=n=>n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),aP=n=>n.replace(/[[\]\\]/g,"\\$&"),No=class{constructor(e,t){nc(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let r=this.globSet=this.braceExpand();t.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,r),r=this.globParts=r.map(i=>i.split(Gv)),this.debug(this.pattern,r),r=r.map((i,s,o)=>i.map(this.parse,this)),this.debug(this.pattern,r),r=r.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,r),this.set=r}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,t=!1,r=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)t=!t,r++;r&&(this.pattern=e.slice(r)),this.negate=t}matchOne(e,t,r){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var s=0,o=0,a=e.length,c=t.length;s<a&&o<c;s++,o++){this.debug("matchOne loop");var u=t[o],l=e[s];if(this.debug(t,u,l),u===!1)return!1;if(u===Vn){this.debug("GLOBSTAR",[t,u,l]);var h=s,f=o+1;if(f===c){for(this.debug("** at the end");s<a;s++)if(e[s]==="."||e[s]===".."||!i.dot&&e[s].charAt(0)===".")return!1;return!0}for(;h<a;){var C=e[h];if(this.debug(`
globstar while`,e,h,t,f,C),this.matchOne(e.slice(h),t.slice(f),r))return this.debug("globstar found match!",h,a,C),!0;if(C==="."||C===".."||!i.dot&&C.charAt(0)==="."){this.debug("dot detected!",e,h,t,f);break}this.debug("globstar swallow a segment, and continue"),h++}return!!(r&&(this.debug(`
>>> no match, partial?`,e,h,t,f),h===a))}var b;if(typeof u=="string"?(b=l===u,this.debug("string match",u,l,b)):(b=l.match(u),this.debug("pattern match",u,l,b)),!b)return!1}if(s===a&&o===c)return!0;if(s===a)return r;if(o===c)return s===a-1&&e[s]==="";throw new Error("wtf?")}braceExpand(){return Qv(this.pattern,this.options)}parse(e,t){nc(e);let r=this.options;if(e==="**")if(r.noglobstar)e="*";else return Vn;if(e==="")return"";let i="",s=!!r.nocase,o=!1,a=[],c=[],u,l=!1,h=-1,f=-1,C,b,y,S=e.charAt(0)==="."?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",R=()=>{if(u){switch(u){case"*":i+=Yl,s=!0;break;case"?":i+=Ql,s=!0;break;default:i+="\\"+u;break}this.debug("clearStateChar %j %j",u,i),u=!1}};for(let k=0,x;k<e.length&&(x=e.charAt(k));k++){if(this.debug("%s	%s %s %j",e,k,i,x),o){if(x==="/")return!1;Bv[x]&&(i+="\\"),i+=x,o=!1;continue}switch(x){case"/":return!1;case"\\":if(l&&e.charAt(k+1)==="-"){i+=x;continue}R(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,k,i,x),l){this.debug("  in class"),x==="!"&&k===f+1&&(x="^"),i+=x;continue}this.debug("call clearStateChar %j",u),R(),u=x,r.noext&&R();continue;case"(":if(l){i+="(";continue}if(!u){i+="\\(";continue}a.push({type:u,start:k-1,reStart:i.length,open:Xv[u].open,close:Xv[u].close}),i+=u==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",u,i),u=!1;continue;case")":if(l||!a.length){i+="\\)";continue}R(),s=!0,b=a.pop(),i+=b.close,b.type==="!"&&c.push(b),b.reEnd=i.length;continue;case"|":if(l||!a.length){i+="\\|";continue}R(),i+="|";continue;case"[":if(R(),l){i+="\\"+x;continue}l=!0,f=k,h=i.length,i+=x;continue;case"]":if(k===f+1||!l){i+="\\"+x;continue}C=e.substring(f+1,k);try{RegExp("["+aP(sP(C))+"]"),i+=x}catch{i=i.substring(0,h)+"(?:$.)"}s=!0,l=!1;continue;default:R(),Bv[x]&&!(x==="^"&&l)&&(i+="\\"),i+=x;break}}for(l&&(C=e.slice(f+1),y=this.parse(C,Jl),i=i.substring(0,h)+"\\["+y[0],s=s||y[1]),b=a.pop();b;b=a.pop()){let k;k=i.slice(b.reStart+b.open.length),this.debug("setting tail",i,b),k=k.replace(/((?:\\{2}){0,64})(\\?)\|/g,(F,N,U)=>(U||(U="\\"),N+N+U+"|")),this.debug(`tail=%j
   %s`,k,k,b,i);let x=b.type==="*"?Yl:b.type==="?"?Ql:"\\"+b.type;s=!0,i=i.slice(0,b.reStart)+x+"\\("+k}R(),o&&(i+="\\\\");let v=nP[i.charAt(0)];for(let k=c.length-1;k>-1;k--){let x=c[k],F=i.slice(0,x.reStart),N=i.slice(x.reStart,x.reEnd-8),U=i.slice(x.reEnd),J=i.slice(x.reEnd-8,x.reEnd)+U,te=F.split("(").length-1,ie=U;for(let Tt=0;Tt<te;Tt++)ie=ie.replace(/\)[+*?]?/,"");U=ie;let _e=U===""&&t!==Jl?"$":"";i=F+N+U+_e+J}if(i!==""&&s&&(i="(?=.)"+i),v&&(i=S+i),t===Jl)return[i,s];if(!s)return iP(e);let D=r.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",D),{_glob:e,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,r=t.noglobstar?Yl:t.dot?eP:tP,i=t.nocase?"i":"",s=e.map(o=>(o=o.map(a=>typeof a=="string"?oP(a):a===Vn?Vn:a._src).reduce((a,c)=>(a[a.length-1]===Vn&&c===Vn||a.push(c),a),[]),o.forEach((a,c)=>{a!==Vn||o[c-1]===Vn||(c===0?o.length>1?o[c+1]="(?:\\/|"+r+"\\/)?"+o[c+1]:o[c]=r:c===o.length-1?o[c-1]+="(?:\\/|"+r+")?":(o[c-1]+="(?:\\/|\\/"+r+"\\/)"+o[c+1],o[c+1]=Vn))}),o.filter(a=>a!==Vn).join("/"))).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,i)}catch{this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let r=this.options;Gl.sep!=="/"&&(e=e.split(Gl.sep).join("/")),e=e.split(Gv),this.debug(this.pattern,"split",e);let i=this.set;this.debug(this.pattern,"set",i);let s;for(let o=e.length-1;o>=0&&(s=e[o],!s);o--);for(let o=0;o<i.length;o++){let a=i[o],c=e;if(r.matchBase&&a.length===1&&(c=[s]),this.matchOne(c,a,t))return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate}static defaults(e){return mn.defaults(e).Minimatch}};mn.Minimatch=No});var nd=L(sr=>{"use strict";Object.defineProperty(sr,"__esModule",{value:!0});sr.DiagnosticFeature=sr.DiagnosticPullMode=sr.vsdiag=void 0;var cP=rc(),Se=require("vscode"),ut=ue(),uP=it(),ed=Pe();function ic(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Xn;(function(n){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(Xn=sr.vsdiag||(sr.vsdiag={}));var td;(function(n){n.onType="onType",n.onSave="onSave"})(td=sr.DiagnosticPullMode||(sr.DiagnosticPullMode={}));var At;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})(At||(At={}));var hs=class{constructor(){this.open=new Set,this._onOpen=new Se.EventEmitter,this._onClose=new Se.EventEmitter,hs.fillTabResources(this.open);let e=t=>{if(t.closed.length===0&&t.opened.length===0)return;let r=this.open,i=new Set;hs.fillTabResources(i);let s=new Set,o=new Set(i);for(let a of r.values())i.has(a)?o.delete(a):s.add(a);if(this.open=i,s.size>0){let a=new Set;for(let c of s)a.add(Se.Uri.parse(c));this._onClose.fire(a)}if(o.size>0){let a=new Set;for(let c of o)a.add(Se.Uri.parse(c));this._onOpen.fire(a)}};Se.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=Se.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){var t,r;return e instanceof Se.Uri?((t=Se.window.activeTextEditor)==null?void 0:t.document.uri)===e:((r=Se.window.activeTextEditor)==null?void 0:r.document)===e}isVisible(e){let t=e instanceof Se.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){let e=new Set;return hs.fillTabResources(new Set,e),e}static fillTabResources(e,t){let r=e??new Set;for(let i of Se.window.tabGroups.all)for(let s of i.tabs){let o=s.input,a;o instanceof Se.TabInputText?a=o.uri:o instanceof Se.TabInputTextDiff&&(a=o.modified),a!==void 0&&!r.has(a.toString())&&(r.add(a.toString()),t!==void 0&&t.add(a))}}},bt;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(bt||(bt={}));var kr;(function(n){function e(t){return t instanceof Se.Uri?t.toString():t.uri.toString()}n.asKey=e})(kr||(kr={}));var Yv=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){let i=e===bt.document?this.documentPullStates:this.workspacePullStates,[s,o,a]=t instanceof Se.Uri?[t.toString(),t,r]:[t.uri.toString(),t.uri,t.version],c=i.get(s);return c===void 0&&(c={document:o,pulledVersion:a,resultId:void 0},i.set(s,c)),c}update(e,t,r,i){let s=e===bt.document?this.documentPullStates:this.workspacePullStates,[o,a,c,u]=t instanceof Se.Uri?[t.toString(),t,r,i]:[t.uri.toString(),t.uri,t.version,r],l=s.get(o);l===void 0?(l={document:a,pulledVersion:c,resultId:u},s.set(o,l)):(l.pulledVersion=c,l.resultId=u)}unTrack(e,t){let r=kr.asKey(t);(e===bt.document?this.documentPullStates:this.workspacePullStates).delete(r)}tracks(e,t){let r=kr.asKey(t);return(e===bt.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){var s;let r=kr.asKey(t);return(s=(e===bt.document?this.documentPullStates:this.workspacePullStates).get(r))==null?void 0:s.resultId}getAllResultIds(){let e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}},Jv=class{constructor(e,t,r){this.client=e,this.tabs=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new Se.EventEmitter,this.provider=this.createProvider(),this.diagnostics=Se.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new Yv,this.workspaceErrorCounter=0}knows(e,t){let r=t instanceof Se.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(r.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;let r=e instanceof Se.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},i=>{this.client.error(`Document pull failed for text document ${r.toString()}`,i,!1)})}async pullAsync(e,t){if(this.isDisposed)return;let r=e instanceof Se.Uri,i=r?e:e.uri,s=i.toString();t=r?t:e.version;let o=this.openRequests.get(s),a=r?this.documentStates.track(bt.document,e,t):this.documentStates.track(bt.document,e);if(o===void 0){let c=new Se.CancellationTokenSource;this.openRequests.set(s,{state:At.active,document:e,version:t,tokenSource:c});let u,l;try{u=await this.provider.provideDiagnostics(e,a.resultId,c.token)??{kind:Xn.DocumentDiagnosticReportKind.full,items:[]}}catch(h){if(h instanceof ed.LSPCancellationError&&ut.DiagnosticServerCancellationData.is(h.data)&&h.data.retriggerRequest===!1&&(l={state:At.outDated,document:e}),l===void 0&&h instanceof Se.CancellationError)l={state:At.reschedule,document:e};else throw h}if(l=l??this.openRequests.get(s),l===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${s}`),this.diagnostics.delete(i);return}if(this.openRequests.delete(s),!this.tabs.isVisible(e)){this.documentStates.unTrack(bt.document,e);return}if(l.state===At.outDated)return;u!==void 0&&(u.kind===Xn.DocumentDiagnosticReportKind.full&&this.diagnostics.set(i,u.items),a.pulledVersion=t,a.resultId=u.resultId),l.state===At.reschedule&&this.pull(e)}else o.state===At.active?(o.tokenSource.cancel(),this.openRequests.set(s,{state:At.reschedule,document:o.document})):o.state===At.outDated&&this.openRequests.set(s,{state:At.reschedule,document:o.document})}forgetDocument(e){let t=e instanceof Se.Uri?e:e.uri,r=t.toString(),i=this.openRequests.get(r);this.options.workspaceDiagnostics?i!==void 0?this.openRequests.set(r,{state:At.reschedule,document:e}):this.pull(e,()=>{this.forget(bt.document,e)}):(i!==void 0&&(i.state===At.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:At.outDated,document:e})),this.diagnostics.delete(t),this.forget(bt.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,ut.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof ed.LSPCancellationError)&&!ut.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,ut.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new Se.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let r of t.items)r.kind===Xn.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(bt.document,r.uri)||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(bt.workspace,r.uri,r.version??void 0,r.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{let s=(a,c,u)=>{let l={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a instanceof Se.Uri?a:a.uri)},previousResultId:c};return this.isDisposed===!0||!this.client.isRunning()?{kind:Xn.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(ut.DocumentDiagnosticRequest.type,l,u).then(async h=>h==null||this.isDisposed||u.isCancellationRequested?{kind:Xn.DocumentDiagnosticReportKind.full,items:[]}:h.kind===ut.DocumentDiagnosticReportKind.Full?{kind:Xn.DocumentDiagnosticReportKind.full,resultId:h.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(h.items,u)}:{kind:Xn.DocumentDiagnosticReportKind.unChanged,resultId:h.resultId},h=>this.client.handleFailedRequest(ut.DocumentDiagnosticRequest.type,u,h,{kind:Xn.DocumentDiagnosticReportKind.full,items:[]}))},o=this.client.middleware;return o.provideDiagnostics?o.provideDiagnostics(t,r,i,s):s(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{let s=async u=>u.kind===ut.DocumentDiagnosticReportKind.Full?{kind:Xn.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(u.uri),resultId:u.resultId,version:u.version,items:await this.client.protocol2CodeConverter.asDiagnostics(u.items,r)}:{kind:Xn.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(u.uri),resultId:u.resultId,version:u.version},o=u=>{let l=[];for(let h of u)l.push({uri:this.client.code2ProtocolConverter.asUri(h.uri),value:h.value});return l},a=(u,l)=>{let h=(0,uP.generateUuid)(),f=this.client.onProgress(ut.WorkspaceDiagnosticRequest.partialResult,h,async b=>{if(b==null){i(null);return}let y={items:[]};for(let S of b.items)try{y.items.push(await s(S))}catch(R){this.client.error("Converting workspace diagnostics failed.",R)}i(y)}),C={identifier:this.options.identifier,previousResultIds:o(u),partialResultToken:h};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(ut.WorkspaceDiagnosticRequest.type,C,l).then(async b=>{if(l.isCancellationRequested)return{items:[]};let y={items:[]};for(let S of b.items)y.items.push(await s(S));return f.dispose(),i(y),{items:[]}},b=>(f.dispose(),this.client.handleFailedRequest(ut.DocumentDiagnosticRequest.type,l,b,{items:[]})))},c=this.client.middleware;return c.provideWorkspaceDiagnostics?c.provideWorkspaceDiagnostics(t,r,i,a):a(t,r,i)}),e}dispose(){var e,t;this.isDisposed=!0,(e=this.workspaceCancellation)==null||e.cancel(),(t=this.workspaceTimeout)==null||t.dispose();for(let[r,i]of this.openRequests)i.state===At.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:At.outDated,document:i.document});this.diagnostics.dispose()}},Zv=class{constructor(e){this.diagnosticRequestor=e,this.documents=new ut.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;let t=kr.asKey(e);this.documents.has(t)||(this.documents.set(t,e,ut.Touch.Last),this.trigger())}remove(e){let t=kr.asKey(e);this.documents.delete(t),this.documents.size===0?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,ut.RAL)().timer.setInterval(()=>{let e=this.documents.first;if(e!==void 0){let t=kr.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,ut.Touch.Last),t===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){var e;(e=this.intervalHandle)==null||e.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?kr.asKey(this.endDocument):void 0}},ey=class{constructor(e,t,r){var b;let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},s=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),o=[],a=y=>{let S=r.documentSelector;if(i.match!==void 0)return i.match(S,y);for(let R of S)if(!!ut.TextDocumentFilter.is(R)){if(typeof R=="string"||R.language!==void 0&&R.language!=="*"||R.scheme!==void 0&&R.scheme!=="*"&&R.scheme!==y.scheme)return!1;if(R.pattern!==void 0){let v=new cP.Minimatch(R.pattern,{noext:!0});if(!v.makeRe()||!v.match(y.fsPath))return!1}}return!0},c=y=>y instanceof Se.Uri?a(y):Se.languages.match(s,y)>0&&t.isVisible(y),u=y=>{var S;return y instanceof Se.Uri?((S=this.activeTextDocument)==null?void 0:S.uri.toString())===y.toString():this.activeTextDocument===y};this.diagnosticRequestor=new Jv(e,t,r),this.backgroundScheduler=new Zv(this.diagnosticRequestor);let l=y=>{!c(y)||!r.interFileDependencies||u(y)||this.backgroundScheduler.add(y)};this.activeTextDocument=(b=Se.window.activeTextEditor)==null?void 0:b.document,Se.window.onDidChangeActiveTextEditor(y=>{let S=this.activeTextDocument;this.activeTextDocument=y==null?void 0:y.document,S!==void 0&&l(S),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let h=e.getFeature(ut.DidOpenTextDocumentNotification.method);o.push(h.onNotificationSent(y=>{let S=y.textDocument;this.diagnosticRequestor.knows(bt.document,S)||c(S)&&this.diagnosticRequestor.pull(S,()=>{l(S)})})),t.onOpen(y=>{for(let S of y){if(this.diagnosticRequestor.knows(bt.document,S))continue;let R=S.toString(),v;for(let D of Se.workspace.textDocuments)if(R===D.uri.toString()){v=D;break}v!==void 0&&c(v)?this.diagnosticRequestor.pull(v,()=>{l(v)}):c(S)&&this.diagnosticRequestor.pull(S,()=>{l(S)})}});let f=new Set;for(let y of Se.workspace.textDocuments)c(y)&&(this.diagnosticRequestor.pull(y,()=>{l(y)}),f.add(y.uri.toString()));if(i.onTabs===!0)for(let y of t.getTabResources())!f.has(y.toString())&&c(y)&&this.diagnosticRequestor.pull(y,()=>{l(y)});if(i.onChange===!0){let y=e.getFeature(ut.DidChangeTextDocumentNotification.method);o.push(y.onNotificationSent(async S=>{let R=S.textDocument;(i.filter===void 0||!i.filter(R,td.onType))&&this.diagnosticRequestor.knows(bt.document,R)&&this.diagnosticRequestor.pull(R,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave===!0){let y=e.getFeature(ut.DidSaveTextDocumentNotification.method);o.push(y.onNotificationSent(S=>{let R=S.textDocument;(i.filter===void 0||!i.filter(R,td.onSave))&&this.diagnosticRequestor.knows(bt.document,R)&&this.diagnosticRequestor.pull(S.textDocument,()=>{this.backgroundScheduler.trigger()})}))}let C=e.getFeature(ut.DidCloseTextDocumentNotification.method);o.push(C.onNotificationSent(y=>{this.cleanUpDocument(y.textDocument)})),t.onClose(y=>{for(let S of y)this.cleanUpDocument(S)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let y of Se.workspace.textDocuments)c(y)&&this.diagnosticRequestor.pull(y)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=Se.Disposable.from(...o,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(bt.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}},ty=class extends ed.TextDocumentLanguageFeature{constructor(e){super(e,ut.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=ic(ic(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,ic(ic(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(ut.DiagnosticRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeDiagnosticsEmitter.fire()});let[i,s]=this.getRegistration(t,e.diagnosticProvider);!i||!s||this.register({id:i,registerOptions:s})}dispose(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.dispose()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new hs);let t=new ey(this._client,this.tabs,e);return[t.disposable,t]}};sr.DiagnosticFeature=ty});var iy=L(ac=>{"use strict";Object.defineProperty(ac,"__esModule",{value:!0});ac.NotebookDocumentSyncFeature=void 0;var $t=require("vscode"),lP=rc(),Pr=ue(),dP=it(),ny=Rn();function ry(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var ps;(function(n){let e;(function(t){function r(f,C){return{version:f.version,uri:C.asUri(f.uri)}}t.asVersionedNotebookDocumentIdentifier=r;function i(f,C,b){let y=Pr.NotebookDocument.create(b.asUri(f.uri),f.notebookType,f.version,s(C,b));return Object.keys(f.metadata).length>0&&(y.metadata=o(f.metadata)),y}t.asNotebookDocument=i;function s(f,C){return f.map(b=>a(b,C))}t.asNotebookCells=s;function o(f){return u(new Set,f)}t.asMetadata=o;function a(f,C){let b=Pr.NotebookCell.create(c(f.kind),C.asUri(f.document.uri));return Object.keys(f.metadata).length>0&&(b.metadata=o(f.metadata)),f.executionSummary!==void 0&&ny.number(f.executionSummary.executionOrder)&&ny.boolean(f.executionSummary.success)&&(b.executionSummary={executionOrder:f.executionSummary.executionOrder,success:f.executionSummary.success}),b}t.asNotebookCell=a;function c(f){switch(f){case $t.NotebookCellKind.Markup:return Pr.NotebookCellKind.Markup;case $t.NotebookCellKind.Code:return Pr.NotebookCellKind.Code}}function u(f,C){if(f.has(C))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(C)){let b=[];for(let y of C)if(y!==null&&typeof y=="object"||Array.isArray(y))b.push(u(f,y));else{if(y instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");b.push(y)}return b}else{let b=Object.keys(C),y=Object.create(null);for(let S of b){let R=C[S];if(R!==null&&typeof R=="object"||Array.isArray(R))y[S]=u(f,R);else{if(R instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");y[S]=R}}return y}}function l(f,C){let b=C.asChangeTextDocumentParams(f,f.document.uri,f.document.version);return{document:b.textDocument,changes:b.contentChanges}}t.asTextContentChange=l;function h(f,C){let b=Object.create(null);if(f.metadata&&(b.metadata=n.c2p.asMetadata(f.metadata)),f.cells!==void 0){let y=Object.create(null),S=f.cells;S.structure&&(y.structure={array:{start:S.structure.array.start,deleteCount:S.structure.array.deleteCount,cells:S.structure.array.cells!==void 0?S.structure.array.cells.map(R=>n.c2p.asNotebookCell(R,C)):void 0},didOpen:S.structure.didOpen!==void 0?S.structure.didOpen.map(R=>C.asOpenTextDocumentParams(R.document).textDocument):void 0,didClose:S.structure.didClose!==void 0?S.structure.didClose.map(R=>C.asCloseTextDocumentParams(R.document).textDocument):void 0}),S.data!==void 0&&(y.data=S.data.map(R=>n.c2p.asNotebookCell(R,C))),S.textContent!==void 0&&(y.textContent=S.textContent.map(R=>n.c2p.asTextContentChange(R,C))),Object.keys(y).length>0&&(b.cells=y)}return b}t.asNotebookDocumentChangeEvent=h})(e=n.c2p||(n.c2p={}))})(ps||(ps={}));var rd;(function(n){function e(a,c,u){let l=a.length,h=c.length,f=0;for(;f<h&&f<l&&t(a[f],c[f],u);)f++;if(f<h&&f<l){let C=l-1,b=h-1;for(;C>=0&&b>=0&&t(a[C],c[b],u);)C--,b--;let y=C+1-f,S=f===b+1?void 0:c.slice(f,b+1);return S!==void 0?{start:f,deleteCount:y,cells:S}:{start:f,deleteCount:y}}else return f<h?{start:f,deleteCount:0,cells:c.slice(f)}:f<l?{start:f,deleteCount:l-f}:void 0}n.computeDiff=e;function t(a,c,u=!0){return a.kind!==c.kind||a.document.uri.toString()!==c.document.uri.toString()||a.document.languageId!==c.document.languageId||!r(a.executionSummary,c.executionSummary)?!1:!u||u&&s(a.metadata,c.metadata)}function r(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.executionOrder===c.executionOrder&&a.success===c.success&&i(a.timing,c.timing)}function i(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.startTime===c.startTime&&a.endTime===c.endTime}function s(a,c){if(a===c)return!0;if(a==null||c===null||c===void 0||typeof a!=typeof c||typeof a!="object")return!1;let u=Array.isArray(a),l=Array.isArray(c);if(u!==l)return!1;if(u&&l){if(a.length!==c.length)return!1;for(let h=0;h<a.length;h++)if(!s(a[h],c[h]))return!1}if(o(a)&&o(c)){let h=Object.keys(a),f=Object.keys(c);if(h.length!==f.length||(h.sort(),f.sort(),!s(h,f)))return!1;for(let C=0;C<h.length;C++){let b=h[C];if(!s(a[b],c[b]))return!1}return!0}return!1}function o(a){return a!==null&&typeof a=="object"}n.isObjectLiteral=o})(rd||(rd={}));var id;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;let i=r.uri;if(t.scheme!==void 0&&t.scheme!=="*"&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let s=new lP.Minimatch(t.pattern,{noext:!0});if(!s.makeRe()||!s.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(id||(id={}));var sc;(function(n){function e(r){var o,a,c;let i=r.notebookSelector,s=[];for(let u of i){let l=(typeof u.notebook=="string"?u.notebook:(o=u.notebook)==null?void 0:o.notebookType)??"*",h=typeof u.notebook=="string"||(a=u.notebook)==null?void 0:a.scheme,f=typeof u.notebook=="string"||(c=u.notebook)==null?void 0:c.pattern;if(u.cells!==void 0)for(let C of u.cells)s.push(t(l,h,f,C.language));else s.push(t(l,h,f,void 0))}return s}n.asDocumentSelector=e;function t(r,i,s,o){return i===void 0&&s===void 0?{notebook:r,language:o}:{notebook:{notebookType:r,scheme:i,pattern:s},language:o}}})(sc||(sc={}));var oc;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(oc||(oc={}));var qo=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(sc.asDocumentSelector(t)),$t.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(let r of $t.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);$t.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&$t.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),$t.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}getState(){for(let e of $t.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return $t.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if($t.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){let s=r.uris.has(t.document.uri.toString());if(i&&s||!i&&!s)return;if(i){let o=this.getMatchingCells(e);if(o!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,r,o);a!==void 0&&this.doSendChange(a,o).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){$t.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;let i=t.document.uri,s=r.cells.findIndex(o=>o.document.uri.toString()===i.toString());if(s!==-1)if(s===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{let o=r.cells.slice(),a=o.splice(s,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:s,deleteCount:1},didClose:a}}},o).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}let s=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);s!==void 0&&this.doSendChange(s,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){var s;let r=async(o,a)=>{let c=ps.c2p.asNotebookDocument(o,a,this.client.code2ProtocolConverter),u=a.map(l=>this.client.code2ProtocolConverter.asTextDocumentItem(l.document));try{await this.client.sendNotification(Pr.DidOpenNotebookDocumentNotification.type,{notebookDocument:c,cellTextDocuments:u})}catch(l){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",l),l}},i=(s=this.client.middleware)==null?void 0:s.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),oc.create(t)),(i==null?void 0:i.didOpen)!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){var s,o;let r=async a=>{try{await this.client.sendNotification(Pr.DidChangeNotebookDocumentNotification.type,{notebookDocument:ps.c2p.asVersionedNotebookDocumentIdentifier(a.notebook,this.client.code2ProtocolConverter),change:ps.c2p.asNotebookDocumentChangeEvent(a,this.client.code2ProtocolConverter)})}catch(c){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",c),c}},i=(s=this.client.middleware)==null?void 0:s.notebooks;return((o=e.cells)==null?void 0:o.structure)!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),oc.create(t??[])),(i==null?void 0:i.didChange)!==void 0?i==null?void 0:i.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){var i;let t=async s=>{try{await this.client.sendNotification(Pr.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)}})}catch(o){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",o),o}},r=(i=this.client.middleware)==null?void 0:i.notebooks;return(r==null?void 0:r.didSave)!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){var s;let r=async(o,a)=>{try{await this.client.sendNotification(Pr.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(o.uri)},cellTextDocuments:a.map(c=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(c.document))})}catch(c){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",c),c}},i=(s=this.client.middleware)==null?void 0:s.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),(i==null?void 0:i.didClose)!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let s={notebook:e};(t==null?void 0:t.metadata)!==void 0&&(s.metadata=ps.c2p.asMetadata(t.metadata));let o;if((t==null?void 0:t.cellChanges)!==void 0&&t.cellChanges.length>0){let a=[];o=new Set(i.map(c=>c.document.uri.toString()));for(let c of t.cellChanges)o.has(c.cell.document.uri.toString())&&(c.executionSummary!==void 0||c.metadata!==void 0)&&a.push(c.cell);a.length>0&&(s.cells=s.cells??{},s.cells.data=a)}if(((t==null?void 0:t.contentChanges)!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){let a=r.cells,c=i,u=rd.computeDiff(a,c,!1),l,h;if(u!==void 0){l=u.cells===void 0?new Map:new Map(u.cells.map(b=>[b.document.uri.toString(),b])),h=u.deleteCount===0?new Map:new Map(a.slice(u.start,u.start+u.deleteCount).map(b=>[b.document.uri.toString(),b]));for(let b of Array.from(h.keys()))l.has(b)&&(h.delete(b),l.delete(b));s.cells=s.cells??{};let f=[],C=[];if(l.size>0||h.size>0){for(let b of l.values())f.push(b);for(let b of h.values())C.push(b)}s.cells.structure={array:u,didOpen:f,didClose:C}}}return Object.keys(s).length>1?s:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let r of this.options.notebookSelector)if(r.notebook===void 0||id.matchNotebook(r.notebook,e)){let i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}}}cellMatches(e,t){let r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){var s;let i=r!==void 0?t.filter(o=>{let a=o.document.languageId;return r.some(c=>c.language==="*"||a===c.language)}):t;return typeof((s=this.client.clientOptions.notebookDocumentOptions)==null?void 0:s.filterCells)=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,i):i}},ei=class{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=Pr.NotebookDocumentSyncRegistrationType.type,$t.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==ei.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let s of this.registrations.values())s instanceof qo&&s.didOpenNotebookCellTextDocument(r,i)}),$t.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let r=t.document;if(r.uri.scheme!==ei.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(let s of this.registrations.values())s instanceof qo&&s.didChangeNotebookCellTextDocument(i,t)}),$t.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==ei.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let s of this.registrations.values())s instanceof qo&&s.didCloseNotebookCellTextDocument(r,i)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(let e of this.registrations.values()){let t=e.getState();if(t.kind==="document"&&t.registrations===!0&&t.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){let t=ry(ry(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){let t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(sc.asDocumentSelector(t)))}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let r=t.id??dP.generateUuid();this.register({id:r,registerOptions:t})}register(e){let t=new qo(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}dispose(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==ei.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&$t.languages.match(this.dedicatedChannel,e)>0)return!0;for(let t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(let t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let r of $t.workspace.notebookDocuments)for(let i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}};ac.NotebookDocumentSyncFeature=ei;ei.CellScheme="vscode-notebook-cell"});var cy=L(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.SyncConfigurationFeature=ti.toJSONObject=ti.ConfigurationFeature=void 0;var gs=require("vscode"),Lo=ue(),fP=Rn(),hP=it(),sy=Pe(),oy=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(Lo.ConfigurationRequest.type,(t,r)=>{let i=o=>{let a=[];for(let c of o.items){let u=c.scopeUri!==void 0&&c.scopeUri!==null?this._client.protocol2CodeConverter.asUri(c.scopeUri):void 0;a.push(this.getConfiguration(u,c.section!==null?c.section:void 0))}return a},s=e.middleware.workspace;return s&&s.configuration?s.configuration(t,r,i):i(t,r)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=Ri(gs.workspace.getConfiguration(void 0,e).get(t));else{let s=gs.workspace.getConfiguration(t.substr(0,i),e);s&&(r=Ri(s.get(t.substr(i+1))))}}else{let i=gs.workspace.getConfiguration(void 0,e);r={};for(let s of Object.keys(i))i.has(s)&&(r[s]=Ri(i.get(s)))}return r===void 0&&(r=null),r}dispose(){}};ti.ConfigurationFeature=oy;function Ri(n){if(n){if(Array.isArray(n))return n.map(Ri);if(typeof n=="object"){let e=Object.create(null);for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Ri(n[t]));return e}}return n}ti.toJSONObject=Ri;var ay=class{constructor(e){this._client=e,this.isDisposed=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Lo.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,sy.ensure)((0,sy.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){var t;let e=(t=this._client.clientOptions.synchronize)==null?void 0:t.configurationSection;e!==void 0&&this.register({id:hP.generateUuid(),registerOptions:{section:e}})}register(e){let t=gs.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear(),this.isDisposed=!0}onDidChangeConfiguration(e,t){var o;if(this.isDisposed)return;let r;if(fP.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(c=>t.affectsConfiguration(c)))return;let i=async a=>a===void 0?this._client.sendNotification(Lo.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(Lo.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(a)}),s=(o=this._client.middleware.workspace)==null?void 0:o.didChangeConfiguration;(s?s(r,i):i(r)).catch(a=>{this._client.error(`Sending notification ${Lo.DidChangeConfigurationNotification.type.method} failed`,a)})}extractSettingsInformation(e){function t(s,o){let a=s;for(let c=0;c<o.length-1;c++){let u=a[o[c]];u||(u=Object.create(null),a[o[c]]=u),a=u}return a}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let s=0;s<e.length;s++){let o=e[s],a=o.indexOf("."),c=null;if(a>=0?c=gs.workspace.getConfiguration(o.substr(0,a),r).get(o.substr(a+1)):c=gs.workspace.getConfiguration(void 0,r).get(o),c){let u=e[s].split(".");t(i,u)[u[u.length-1]]=Ri(c)}}return i}};ti.SyncConfigurationFeature=ay});var gy=L(cn=>{"use strict";Object.defineProperty(cn,"__esModule",{value:!0});cn.DidSaveTextDocumentFeature=cn.WillSaveWaitUntilFeature=cn.WillSaveFeature=cn.DidChangeTextDocumentFeature=cn.DidCloseTextDocumentFeature=cn.DidOpenTextDocumentFeature=void 0;var vn=require("vscode"),Ke=ue(),st=Pe(),ms=it(),uy=class extends st.TextDocumentEventFeature{constructor(e,t){super(e,vn.workspace.onDidOpenTextDocument,Ke.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),r=>r,st.TextDocumentEventFeature.textDocumentFilter);this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,st.ensure)((0,st.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:ms.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return Ke.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);vn.workspace.textDocuments.forEach(r=>{let i=r.uri.toString();if(!this._syncedDocuments.has(i)&&vn.languages.match(t,r)>0&&!this._client.hasDedicatedTextSynchronizationFeature(r)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));(s.didOpen?s.didOpen(r,o):o(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,r)}})}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,r)}};cn.DidOpenTextDocumentFeature=uy;var ly=class extends st.TextDocumentEventFeature{constructor(e,t,r){super(e,vn.workspace.onDidCloseTextDocument,Ke.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,i=>e.code2ProtocolConverter.asCloseTextDocumentParams(i),i=>i,st.TextDocumentEventFeature.textDocumentFilter);this._syncedDocuments=t,this._pendingTextDocumentChanges=r}get registrationType(){return Ke.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,st.ensure)((0,st.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:ms.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,r){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,r)}unregister(e){let t=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(vn.languages.match(t,i)>0&&!this._selectorFilter(r,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(s.didClose?s.didClose(i,o):o(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}};cn.DidCloseTextDocumentFeature=ly;var dy=class extends st.DynamicDocumentFeature{constructor(e,t){super(e);this._changeData=new Map,this._onNotificationSent=new vn.EventEmitter,this._onPendingChangeAdded=new vn.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=Ke.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return Ke.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,st.ensure)((0,st.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==Ke.TextDocumentSyncKind.None&&this.register({id:ms.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=vn.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(let e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;let t=e.document.uri,r=e.document.version,i=[];for(let s of this._changeData.values())if(vn.languages.match(s.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let o=this._client.middleware;if(s.syncKind===Ke.TextDocumentSyncKind.Incremental){let a=async c=>{let u=this._client.code2ProtocolConverter.asChangeTextDocumentParams(c,t,r);await this._client.sendNotification(Ke.DidChangeTextDocumentNotification.type,u),this.notificationSent(c.document,Ke.DidChangeTextDocumentNotification.type,u)};i.push(o.didChange?o.didChange(e,c=>a(c)):a(e))}else if(s.syncKind===Ke.TextDocumentSyncKind.Full){let a=async c=>{let u=c.document.uri.toString();this._pendingTextDocumentChanges.set(u,c.document),this._onPendingChangeAdded.fire()};i.push(o.didChange?o.didChange(e,c=>a(c)):a(e))}}return Promise.all(i).then(void 0,s=>{throw this._client.error(`Sending document notification ${Ke.DidChangeTextDocumentNotification.type.method} failed`,s),s})}notificationSent(e,t,r){this._onNotificationSent.fire({textDocument:e,type:t,params:r})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=Ke.TextDocumentSyncKind.None;else{this._syncKind=Ke.TextDocumentSyncKind.None;for(let t of this._changeData.values())if(this.updateSyncKind(t.syncKind),this._syncKind===Ke.TextDocumentSyncKind.Full)break}}dispose(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=Ke.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let t;if(e.size===0)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(let r of this._pendingTextDocumentChanges)e.has(r[0])||(t.push(r[1]),this._pendingTextDocumentChanges.delete(r[0]))}return t}getProvider(e){for(let t of this._changeData.values())if(vn.languages.match(t.documentSelector,e)>0)return{send:r=>this.callback(r)}}updateSyncKind(e){if(this._syncKind!==Ke.TextDocumentSyncKind.Full)switch(e){case Ke.TextDocumentSyncKind.Full:this._syncKind=e;break;case Ke.TextDocumentSyncKind.Incremental:this._syncKind===Ke.TextDocumentSyncKind.None&&(this._syncKind=Ke.TextDocumentSyncKind.Incremental);break}}};cn.DidChangeTextDocumentFeature=dy;var fy=class extends st.TextDocumentEventFeature{constructor(e){super(e,vn.workspace.onWillSaveTextDocument,Ke.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),t=>t.document,(t,r)=>st.TextDocumentEventFeature.textDocumentFilter(t,r.document))}get registrationType(){return Ke.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,st.ensure)((0,st.ensure)(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:ms.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}};cn.WillSaveFeature=fy;var hy=class extends st.DynamicDocumentFeature{constructor(e){super(e);this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return Ke.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,st.ensure)((0,st.ensure)(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:ms.generateUuid(),registerOptions:{documentSelector:t}})}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=vn.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(st.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,r=i=>this._client.sendRequest(Ke.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async s=>{let o=await this._client.protocol2CodeConverter.asTextEdits(s);return o===void 0?[]:o});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}};cn.WillSaveWaitUntilFeature=hy;var py=class extends st.TextDocumentEventFeature{constructor(e){super(e,vn.workspace.onDidSaveTextDocument,Ke.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),t=>t,st.TextDocumentEventFeature.textDocumentFilter);this._includeText=!1}get registrationType(){return Ke.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,st.ensure)((0,st.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;if(t&&r&&r.save){let i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:ms.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}};cn.DidSaveTextDocumentFeature=py});var vy=L(cc=>{"use strict";Object.defineProperty(cc,"__esModule",{value:!0});cc.CompletionItemFeature=void 0;var pP=require("vscode"),De=ue(),sd=Pe(),gP=it(),mP=[De.CompletionItemKind.Text,De.CompletionItemKind.Method,De.CompletionItemKind.Function,De.CompletionItemKind.Constructor,De.CompletionItemKind.Field,De.CompletionItemKind.Variable,De.CompletionItemKind.Class,De.CompletionItemKind.Interface,De.CompletionItemKind.Module,De.CompletionItemKind.Property,De.CompletionItemKind.Unit,De.CompletionItemKind.Value,De.CompletionItemKind.Enum,De.CompletionItemKind.Keyword,De.CompletionItemKind.Snippet,De.CompletionItemKind.Color,De.CompletionItemKind.File,De.CompletionItemKind.Reference,De.CompletionItemKind.Folder,De.CompletionItemKind.EnumMember,De.CompletionItemKind.Constant,De.CompletionItemKind.Struct,De.CompletionItemKind.Event,De.CompletionItemKind.Operator,De.CompletionItemKind.TypeParameter],my=class extends sd.TextDocumentLanguageFeature{constructor(e){super(e,De.CompletionRequest.type);this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,sd.ensure)((0,sd.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[De.MarkupKind.Markdown,De.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[De.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[De.InsertTextMode.asIs,De.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=De.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:mP},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode"]}}initialize(e,t){let r=this.getRegistrationOptions(t,e.completionProvider);!r||this.register({id:gP.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){var a;this.labelDetailsSupport.set(t,!!((a=e.completionItem)==null?void 0:a.labelDetailsSupport));let r=e.triggerCharacters??[],i=e.allCommitCharacters,s=e.documentSelector,o={provideCompletionItems:(c,u,l,h)=>{let f=this._client,C=this._client.middleware,b=(y,S,R,v)=>f.sendRequest(De.CompletionRequest.type,f.code2ProtocolConverter.asCompletionParams(y,S,R),v).then(D=>v.isCancellationRequested?null:f.protocol2CodeConverter.asCompletionResult(D,i,v),D=>f.handleFailedRequest(De.CompletionRequest.type,v,D,null));return C.provideCompletionItem?C.provideCompletionItem(c,u,h,l,b):b(c,u,h,l)},resolveCompletionItem:e.resolveProvider?(c,u)=>{let l=this._client,h=this._client.middleware,f=(C,b)=>l.sendRequest(De.CompletionResolveRequest.type,l.code2ProtocolConverter.asCompletionItem(C,!!this.labelDetailsSupport.get(t)),b).then(y=>b.isCancellationRequested?null:l.protocol2CodeConverter.asCompletionItem(y),y=>l.handleFailedRequest(De.CompletionResolveRequest.type,b,y,C));return h.resolveCompletionItem?h.resolveCompletionItem(c,u,f):f(c,u)}:void 0};return[pP.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),o,...r),o]}};cc.CompletionItemFeature=my});var wy=L(uc=>{"use strict";Object.defineProperty(uc,"__esModule",{value:!0});uc.HoverFeature=void 0;var vP=require("vscode"),Mo=ue(),od=Pe(),yP=it(),yy=class extends od.TextDocumentLanguageFeature{constructor(e){super(e,Mo.HoverRequest.type)}fillClientCapabilities(e){let t=(0,od.ensure)((0,od.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[Mo.MarkupKind.Markdown,Mo.MarkupKind.PlainText]}initialize(e,t){let r=this.getRegistrationOptions(t,e.hoverProvider);!r||this.register({id:yP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideHover:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(Mo.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asHover(C),C=>a.handleFailedRequest(Mo.HoverRequest.type,f,C,null)),u=a.middleware;return u.provideHover?u.provideHover(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return vP.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};uc.HoverFeature=yy});var Cy=L(lc=>{"use strict";Object.defineProperty(lc,"__esModule",{value:!0});lc.DefinitionFeature=void 0;var wP=require("vscode"),ad=ue(),cd=Pe(),bP=it(),by=class extends cd.TextDocumentLanguageFeature{constructor(e){super(e,ad.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,cd.ensure)((0,cd.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.definitionProvider);!r||this.register({id:bP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDefinition:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(ad.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,f),C=>a.handleFailedRequest(ad.DefinitionRequest.type,f,C,null)),u=a.middleware;return u.provideDefinition?u.provideDefinition(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return wP.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};lc.DefinitionFeature=by});var Sy=L(dc=>{"use strict";Object.defineProperty(dc,"__esModule",{value:!0});dc.SignatureHelpFeature=void 0;var Dy=require("vscode"),Ao=ue(),ud=Pe(),CP=it(),Ty=class extends ud.TextDocumentLanguageFeature{constructor(e){super(e,Ao.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,ud.ensure)((0,ud.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[Ao.MarkupKind.Markdown,Ao.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.signatureHelpProvider);!r||this.register({id:CP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t={provideSignatureHelp:(r,i,s,o)=>{let a=this._client,c=(l,h,f,C)=>a.sendRequest(Ao.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(l,h,f),C).then(b=>C.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(b,C),b=>a.handleFailedRequest(Ao.SignatureHelpRequest.type,C,b,null)),u=a.middleware;return u.provideSignatureHelp?u.provideSignatureHelp(r,i,o,s,c):c(r,i,o,s)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){let r=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){let i=e.triggerCharacters||[];return Dy.languages.registerSignatureHelpProvider(r,t,...i)}else{let i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return Dy.languages.registerSignatureHelpProvider(r,t,i)}}};dc.SignatureHelpFeature=Ty});var ky=L(fc=>{"use strict";Object.defineProperty(fc,"__esModule",{value:!0});fc.DocumentHighlightFeature=void 0;var DP=require("vscode"),ld=ue(),dd=Pe(),TP=it(),Ry=class extends dd.TextDocumentLanguageFeature{constructor(e){super(e,ld.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,dd.ensure)((0,dd.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentHighlightProvider);!r||this.register({id:TP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentHighlights:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(ld.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(C,f),C=>a.handleFailedRequest(ld.DocumentHighlightRequest.type,f,C,null)),u=a.middleware;return u.provideDocumentHighlights?u.provideDocumentHighlights(i,s,o,c):c(i,s,o)}};return[DP.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};fc.DocumentHighlightFeature=Ry});var hd=L(or=>{"use strict";Object.defineProperty(or,"__esModule",{value:!0});or.DocumentSymbolFeature=or.SupportedSymbolTags=or.SupportedSymbolKinds=void 0;var SP=require("vscode"),Ne=ue(),fd=Pe(),RP=it();or.SupportedSymbolKinds=[Ne.SymbolKind.File,Ne.SymbolKind.Module,Ne.SymbolKind.Namespace,Ne.SymbolKind.Package,Ne.SymbolKind.Class,Ne.SymbolKind.Method,Ne.SymbolKind.Property,Ne.SymbolKind.Field,Ne.SymbolKind.Constructor,Ne.SymbolKind.Enum,Ne.SymbolKind.Interface,Ne.SymbolKind.Function,Ne.SymbolKind.Variable,Ne.SymbolKind.Constant,Ne.SymbolKind.String,Ne.SymbolKind.Number,Ne.SymbolKind.Boolean,Ne.SymbolKind.Array,Ne.SymbolKind.Object,Ne.SymbolKind.Key,Ne.SymbolKind.Null,Ne.SymbolKind.EnumMember,Ne.SymbolKind.Struct,Ne.SymbolKind.Event,Ne.SymbolKind.Operator,Ne.SymbolKind.TypeParameter];or.SupportedSymbolTags=[Ne.SymbolTag.Deprecated];var Py=class extends fd.TextDocumentLanguageFeature{constructor(e){super(e,Ne.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=(0,fd.ensure)((0,fd.ensure)(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:or.SupportedSymbolKinds},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:or.SupportedSymbolTags},t.labelSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentSymbolProvider);!r||this.register({id:RP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentSymbols:(s,o)=>{let a=this._client,c=async(l,h)=>{try{let f=await a.sendRequest(Ne.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(l),h);if(h.isCancellationRequested||f===void 0||f===null)return null;if(f.length===0)return[];{let C=f[0];return Ne.DocumentSymbol.is(C)?await a.protocol2CodeConverter.asDocumentSymbols(f,h):await a.protocol2CodeConverter.asSymbolInformations(f,h)}}catch(f){return a.handleFailedRequest(Ne.DocumentSymbolRequest.type,h,f,null)}},u=a.middleware;return u.provideDocumentSymbols?u.provideDocumentSymbols(s,o,c):c(s,o)}},i=e.label!==void 0?{label:e.label}:void 0;return[SP.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,i),r]}};or.DocumentSymbolFeature=Py});var xy=L(hc=>{"use strict";Object.defineProperty(hc,"__esModule",{value:!0});hc.WorkspaceSymbolFeature=void 0;var kP=require("vscode"),$o=ue(),pd=Pe(),_y=hd(),PP=it(),Ey=class extends pd.WorkspaceFeature{constructor(e){super(e,$o.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,pd.ensure)((0,pd.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:_y.SupportedSymbolKinds},t.tagSupport={valueSet:_y.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){!e.workspaceSymbolProvider||this.register({id:PP.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(r,i)=>{let s=this._client,o=(c,u)=>s.sendRequest($o.WorkspaceSymbolRequest.type,{query:c},u).then(l=>u.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformations(l,u),l=>s.handleFailedRequest($o.WorkspaceSymbolRequest.type,u,l,null)),a=s.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(r,i,o):o(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{let s=this._client,o=(c,u)=>s.sendRequest($o.WorkspaceSymbolResolveRequest.type,s.code2ProtocolConverter.asWorkspaceSymbol(c),u).then(l=>u.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformation(l),l=>s.handleFailedRequest($o.WorkspaceSymbolResolveRequest.type,u,l,null)),a=s.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(r,i,o):o(r,i)}:void 0};return[kP.languages.registerWorkspaceSymbolProvider(t),t]}};hc.WorkspaceSymbolFeature=Ey});var Iy=L(pc=>{"use strict";Object.defineProperty(pc,"__esModule",{value:!0});pc.ReferencesFeature=void 0;var _P=require("vscode"),gd=ue(),md=Pe(),EP=it(),Fy=class extends md.TextDocumentLanguageFeature{constructor(e){super(e,gd.ReferencesRequest.type)}fillClientCapabilities(e){(0,md.ensure)((0,md.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.referencesProvider);!r||this.register({id:EP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideReferences:(i,s,o,a)=>{let c=this._client,u=(h,f,C,b)=>c.sendRequest(gd.ReferencesRequest.type,c.code2ProtocolConverter.asReferenceParams(h,f,C),b).then(y=>b.isCancellationRequested?null:c.protocol2CodeConverter.asReferences(y,b),y=>c.handleFailedRequest(gd.ReferencesRequest.type,b,y,null)),l=c.middleware;return l.provideReferences?l.provideReferences(i,s,o,a,u):u(i,s,o,a)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return _P.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};pc.ReferencesFeature=Fy});var Ny=L(gc=>{"use strict";Object.defineProperty(gc,"__esModule",{value:!0});gc.CodeActionFeature=void 0;var xP=require("vscode"),yn=ue(),FP=it(),vd=Pe(),Oy=class extends vd.TextDocumentLanguageFeature{constructor(e){super(e,yn.CodeActionRequest.type)}fillClientCapabilities(e){let t=(0,vd.ensure)((0,vd.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[yn.CodeActionKind.Empty,yn.CodeActionKind.QuickFix,yn.CodeActionKind.Refactor,yn.CodeActionKind.RefactorExtract,yn.CodeActionKind.RefactorInline,yn.CodeActionKind.RefactorRewrite,yn.CodeActionKind.Source,yn.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!1}initialize(e,t){let r=this.getRegistrationOptions(t,e.codeActionProvider);!r||this.register({id:FP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideCodeActions:(i,s,o,a)=>{let c=this._client,u=async(h,f,C,b)=>{let y={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(h),range:c.code2ProtocolConverter.asRange(f),context:await c.code2ProtocolConverter.asCodeActionContext(C,b)};return c.sendRequest(yn.CodeActionRequest.type,y,b).then(S=>b.isCancellationRequested||S===null||S===void 0?null:c.protocol2CodeConverter.asCodeActionResult(S,b),S=>c.handleFailedRequest(yn.CodeActionRequest.type,b,S,null))},l=c.middleware;return l.provideCodeActions?l.provideCodeActions(i,s,o,a,u):u(i,s,o,a)},resolveCodeAction:e.resolveProvider?(i,s)=>{let o=this._client,a=this._client.middleware,c=async(u,l)=>o.sendRequest(yn.CodeActionResolveRequest.type,await o.code2ProtocolConverter.asCodeAction(u,l),l).then(h=>l.isCancellationRequested?u:o.protocol2CodeConverter.asCodeAction(h,l),h=>o.handleFailedRequest(yn.CodeActionResolveRequest.type,l,h,u));return a.resolveCodeAction?a.resolveCodeAction(i,s,c):c(i,s)}:void 0};return[xP.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}};gc.CodeActionFeature=Oy});var My=L(mc=>{"use strict";Object.defineProperty(mc,"__esModule",{value:!0});mc.CodeLensFeature=void 0;var qy=require("vscode"),vs=ue(),IP=it(),jo=Pe(),Ly=class extends jo.TextDocumentLanguageFeature{constructor(e){super(e,vs.CodeLensRequest.type)}fillClientCapabilities(e){(0,jo.ensure)((0,jo.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,jo.ensure)((0,jo.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(vs.CodeLensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);!i||this.register({id:IP.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new qy.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(s,o)=>{let a=this._client,c=(l,h)=>a.sendRequest(vs.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(l),h).then(f=>h.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(f,h),f=>a.handleFailedRequest(vs.CodeLensRequest.type,h,f,null)),u=a.middleware;return u.provideCodeLenses?u.provideCodeLenses(s,o,c):c(s,o)},resolveCodeLens:e.resolveProvider?(s,o)=>{let a=this._client,c=(l,h)=>a.sendRequest(vs.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(l),h).then(f=>h.isCancellationRequested?l:a.protocol2CodeConverter.asCodeLens(f),f=>a.handleFailedRequest(vs.CodeLensResolveRequest.type,h,f,l)),u=a.middleware;return u.resolveCodeLens?u.resolveCodeLens(s,o,c):c(s,o)}:void 0};return[qy.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}};mc.CodeLensFeature=Ly});var Wy=L(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.DocumentOnTypeFormattingFeature=ni.DocumentRangeFormattingFeature=ni.DocumentFormattingFeature=void 0;var vc=require("vscode"),_r=ue(),yd=it(),Er=Pe(),Wo;(function(n){function e(t){let r=vc.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})(Wo||(Wo={}));var Ay=class extends Er.TextDocumentLanguageFeature{constructor(e){super(e,_r.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,Er.ensure)((0,Er.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentFormattingProvider);!r||this.register({id:yd.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentFormattingEdits:(i,s,o)=>{let a=this._client,c=(l,h,f)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l),options:a.code2ProtocolConverter.asFormattingOptions(h,Wo.fromConfiguration(l))};return a.sendRequest(_r.DocumentFormattingRequest.type,C,f).then(b=>f.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(b,f),b=>a.handleFailedRequest(_r.DocumentFormattingRequest.type,f,b,null))},u=a.middleware;return u.provideDocumentFormattingEdits?u.provideDocumentFormattingEdits(i,s,o,c):c(i,s,o)}};return[vc.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};ni.DocumentFormattingFeature=Ay;var $y=class extends Er.TextDocumentLanguageFeature{constructor(e){super(e,_r.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){(0,Er.ensure)((0,Er.ensure)(e,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);!r||this.register({id:yd.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,s,o,a)=>{let c=this._client,u=(h,f,C,b)=>{let y={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(h),range:c.code2ProtocolConverter.asRange(f),options:c.code2ProtocolConverter.asFormattingOptions(C,Wo.fromConfiguration(h))};return c.sendRequest(_r.DocumentRangeFormattingRequest.type,y,b).then(S=>b.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(S,b),S=>c.handleFailedRequest(_r.DocumentRangeFormattingRequest.type,b,S,null))},l=c.middleware;return l.provideDocumentRangeFormattingEdits?l.provideDocumentRangeFormattingEdits(i,s,o,a,u):u(i,s,o,a)}};return[vc.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};ni.DocumentRangeFormattingFeature=$y;var jy=class extends Er.TextDocumentLanguageFeature{constructor(e){super(e,_r.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,Er.ensure)((0,Er.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);!r||this.register({id:yd.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideOnTypeFormattingEdits:(s,o,a,c,u)=>{let l=this._client,h=(C,b,y,S,R)=>{let v={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(C),position:l.code2ProtocolConverter.asPosition(b),ch:y,options:l.code2ProtocolConverter.asFormattingOptions(S,Wo.fromConfiguration(C))};return l.sendRequest(_r.DocumentOnTypeFormattingRequest.type,v,R).then(D=>R.isCancellationRequested?null:l.protocol2CodeConverter.asTextEdits(D,R),D=>l.handleFailedRequest(_r.DocumentOnTypeFormattingRequest.type,R,D,null))},f=l.middleware;return f.provideOnTypeFormattingEdits?f.provideOnTypeFormattingEdits(s,o,a,c,u,h):h(s,o,a,c,u)}},i=e.moreTriggerCharacter||[];return[vc.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}};ni.DocumentOnTypeFormattingFeature=jy});var Ky=L(yc=>{"use strict";Object.defineProperty(yc,"__esModule",{value:!0});yc.RenameFeature=void 0;var OP=require("vscode"),ki=ue(),NP=it(),Hy=Rn(),wd=Pe(),Uy=class extends wd.TextDocumentLanguageFeature{constructor(e){super(e,ki.RenameRequest.type)}fillClientCapabilities(e){let t=(0,wd.ensure)((0,wd.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=ki.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.renameProvider);!r||(Hy.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:NP.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){let t=e.documentSelector,r={provideRenameEdits:(i,s,o,a)=>{let c=this._client,u=(h,f,C,b)=>{let y={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(h),position:c.code2ProtocolConverter.asPosition(f),newName:C};return c.sendRequest(ki.RenameRequest.type,y,b).then(S=>b.isCancellationRequested?null:c.protocol2CodeConverter.asWorkspaceEdit(S,b),S=>c.handleFailedRequest(ki.RenameRequest.type,b,S,null,!1))},l=c.middleware;return l.provideRenameEdits?l.provideRenameEdits(i,s,o,a,u):u(i,s,o,a)},prepareRename:e.prepareProvider?(i,s,o)=>{let a=this._client,c=(l,h,f)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l),position:a.code2ProtocolConverter.asPosition(h)};return a.sendRequest(ki.PrepareRenameRequest.type,C,f).then(b=>f.isCancellationRequested?null:ki.Range.is(b)?a.protocol2CodeConverter.asRange(b):this.isDefaultBehavior(b)?b.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):b&&ki.Range.is(b.range)?{range:a.protocol2CodeConverter.asRange(b.range),placeholder:b.placeholder}:Promise.reject(new Error("The element can't be renamed.")),b=>{throw typeof b.message=="string"?new Error(b.message):new Error("The element can't be renamed.")})},u=a.middleware;return u.prepareRename?u.prepareRename(i,s,o,c):c(i,s,o)}:void 0};return[this.registerProvider(t,r),r]}registerProvider(e,t){return OP.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){let t=e;return t&&Hy.boolean(t.defaultBehavior)}};yc.RenameFeature=Uy});var Xy=L(wc=>{"use strict";Object.defineProperty(wc,"__esModule",{value:!0});wc.DocumentLinkFeature=void 0;var qP=require("vscode"),Ho=ue(),bd=Pe(),LP=it(),Vy=class extends bd.TextDocumentLanguageFeature{constructor(e){super(e,Ho.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=(0,bd.ensure)((0,bd.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentLinkProvider);!r||this.register({id:LP.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentLinks:(i,s)=>{let o=this._client,a=(u,l)=>o.sendRequest(Ho.DocumentLinkRequest.type,o.code2ProtocolConverter.asDocumentLinkParams(u),l).then(h=>l.isCancellationRequested?null:o.protocol2CodeConverter.asDocumentLinks(h,l),h=>o.handleFailedRequest(Ho.DocumentLinkRequest.type,l,h,null)),c=o.middleware;return c.provideDocumentLinks?c.provideDocumentLinks(i,s,a):a(i,s)},resolveDocumentLink:e.resolveProvider?(i,s)=>{let o=this._client,a=(u,l)=>o.sendRequest(Ho.DocumentLinkResolveRequest.type,o.code2ProtocolConverter.asDocumentLink(u),l).then(h=>l.isCancellationRequested?u:o.protocol2CodeConverter.asDocumentLink(h),h=>o.handleFailedRequest(Ho.DocumentLinkResolveRequest.type,l,h,u)),c=o.middleware;return c.resolveDocumentLink?c.resolveDocumentLink(i,s,a):a(i,s)}:void 0};return[qP.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};wc.DocumentLinkFeature=Vy});var Gy=L(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0});bc.ExecuteCommandFeature=void 0;var MP=require("vscode"),Cd=ue(),AP=it(),zy=Pe(),By=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return Cd.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,zy.ensure)((0,zy.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){!e.executeCommandProvider||this.register({id:AP.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,r=t.middleware,i=(s,o)=>{let a={command:s,arguments:o};return t.sendRequest(Cd.ExecuteCommandRequest.type,a).then(void 0,c=>t.handleFailedRequest(Cd.ExecuteCommandRequest.type,void 0,c,void 0))};if(e.registerOptions.commands){let s=[];for(let o of e.registerOptions.commands)s.push(MP.commands.registerCommand(o,(...a)=>r.executeCommand?r.executeCommand(o,a,i):i(o,a)));this._commands.set(e.id,s)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}dispose(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}};bc.ExecuteCommandFeature=By});var Yy=L(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});Dc.FileSystemWatcherFeature=void 0;var $P=require("vscode"),Pi=ue(),Cc=Pe(),Qy=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return Pi.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,Cc.ensure)((0,Cc.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,Cc.ensure)((0,Cc.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let r of e.registerOptions.watchers){let i=this._client.protocol2CodeConverter.asGlobPattern(r.globPattern);if(i===void 0)continue;let s=!0,o=!0,a=!0;r.kind!==void 0&&r.kind!==null&&(s=(r.kind&Pi.WatchKind.Create)!=0,o=(r.kind&Pi.WatchKind.Change)!=0,a=(r.kind&Pi.WatchKind.Delete)!=0);let c=$P.workspace.createFileSystemWatcher(i,!s,!o,!a);this.hookListeners(c,s,o,a,t),t.push(c)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,s){t&&e.onDidCreate(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:Pi.FileChangeType.Created}),null,s),r&&e.onDidChange(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:Pi.FileChangeType.Changed}),null,s),i&&e.onDidDelete(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:Pi.FileChangeType.Deleted}),null,s)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}dispose(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}};Dc.FileSystemWatcherFeature=Qy});var Zy=L(Tc=>{"use strict";Object.defineProperty(Tc,"__esModule",{value:!0});Tc.ColorProviderFeature=void 0;var jP=require("vscode"),Uo=ue(),Dd=Pe(),Jy=class extends Dd.TextDocumentLanguageFeature{constructor(e){super(e,Uo.DocumentColorRequest.type)}fillClientCapabilities(e){(0,Dd.ensure)((0,Dd.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideColorPresentations:(i,s,o)=>{let a=this._client,c=(l,h,f)=>{let C={color:l,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(h.document),range:a.code2ProtocolConverter.asRange(h.range)};return a.sendRequest(Uo.ColorPresentationRequest.type,C,f).then(b=>f.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(b,f),b=>a.handleFailedRequest(Uo.ColorPresentationRequest.type,f,b,null))},u=a.middleware;return u.provideColorPresentations?u.provideColorPresentations(i,s,o,c):c(i,s,o)},provideDocumentColors:(i,s)=>{let o=this._client,a=(u,l)=>{let h={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(u)};return o.sendRequest(Uo.DocumentColorRequest.type,h,l).then(f=>l.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(f,l),f=>o.handleFailedRequest(Uo.DocumentColorRequest.type,l,f,null))},c=o.middleware;return c.provideDocumentColors?c.provideDocumentColors(i,s,a):a(i,s)}};return[jP.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Tc.ColorProviderFeature=Jy});var tw=L(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});Sc.ImplementationFeature=void 0;var WP=require("vscode"),Td=ue(),Sd=Pe(),ew=class extends Sd.TextDocumentLanguageFeature{constructor(e){super(e,Td.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,Sd.ensure)((0,Sd.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideImplementation:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(Td.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,f),C=>a.handleFailedRequest(Td.ImplementationRequest.type,f,C,null)),u=a.middleware;return u.provideImplementation?u.provideImplementation(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return WP.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Sc.ImplementationFeature=ew});var rw=L(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.TypeDefinitionFeature=void 0;var HP=require("vscode"),Rd=ue(),Ko=Pe(),nw=class extends Ko.TextDocumentLanguageFeature{constructor(e){super(e,Rd.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,Ko.ensure)((0,Ko.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,Ko.ensure)((0,Ko.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideTypeDefinition:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(Rd.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,f),C=>a.handleFailedRequest(Rd.TypeDefinitionRequest.type,f,C,null)),u=a.middleware;return u.provideTypeDefinition?u.provideTypeDefinition(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return HP.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Rc.TypeDefinitionFeature=nw});var sw=L(ys=>{"use strict";Object.defineProperty(ys,"__esModule",{value:!0});ys.WorkspaceFoldersFeature=ys.arrayDiff=void 0;var UP=it(),kc=require("vscode"),Vo=ue();function kd(n,e){if(n!=null)return n[e]}function Pd(n,e){return n.filter(t=>e.indexOf(t)<0)}ys.arrayDiff=Pd;var iw=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Vo.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=kc.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(Vo.WorkspaceFoldersRequest.type,s=>{let o=()=>{let c=kc.workspace.workspaceFolders;return c===void 0?null:c.map(l=>this.asProtocol(l))},a=t.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(s,o):o(s)});let r=kd(kd(kd(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof r=="string"?i=r:r===!0&&(i=UP.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let r=Pd(this._initialFolders,e),i=Pd(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${Vo.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(Vo.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=kc.workspace.onDidChangeWorkspaceFolders(s=>{let o=u=>this.doSendEvent(u.added,u.removed),a=r.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(s,o):o(s)).catch(u=>{this._client.error(`Sending notification ${Vo.DidChangeWorkspaceFoldersNotification.type.method} failed`,u)})});this._listeners.set(t,i),this.sendInitialEvent(kc.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};ys.WorkspaceFoldersFeature=iw});var aw=L(Pc=>{"use strict";Object.defineProperty(Pc,"__esModule",{value:!0});Pc.FoldingRangeFeature=void 0;var KP=require("vscode"),ws=ue(),_d=Pe(),ow=class extends _d.TextDocumentLanguageFeature{constructor(e){super(e,ws.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,_d.ensure)((0,_d.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[ws.FoldingRangeKind.Comment,ws.FoldingRangeKind.Imports,ws.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1}}initialize(e,t){let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideFoldingRanges:(i,s,o)=>{let a=this._client,c=(l,h,f)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l)};return a.sendRequest(ws.FoldingRangeRequest.type,C,f).then(b=>f.isCancellationRequested?null:a.protocol2CodeConverter.asFoldingRanges(b,f),b=>a.handleFailedRequest(ws.FoldingRangeRequest.type,f,b,null))},u=a.middleware;return u.provideFoldingRanges?u.provideFoldingRanges(i,s,o,c):c(i,s,o)}};return[KP.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Pc.FoldingRangeFeature=ow});var uw=L(_c=>{"use strict";Object.defineProperty(_c,"__esModule",{value:!0});_c.DeclarationFeature=void 0;var VP=require("vscode"),Ed=ue(),xd=Pe(),cw=class extends xd.TextDocumentLanguageFeature{constructor(e){super(e,Ed.DeclarationRequest.type)}fillClientCapabilities(e){let t=(0,xd.ensure)((0,xd.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDeclaration:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(Ed.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(C,f),C=>a.handleFailedRequest(Ed.DeclarationRequest.type,f,C,null)),u=a.middleware;return u.provideDeclaration?u.provideDeclaration(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return VP.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};_c.DeclarationFeature=cw});var dw=L(Ec=>{"use strict";Object.defineProperty(Ec,"__esModule",{value:!0});Ec.SelectionRangeFeature=void 0;var XP=require("vscode"),Fd=ue(),Id=Pe(),lw=class extends Id.TextDocumentLanguageFeature{constructor(e){super(e,Fd.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=(0,Id.ensure)((0,Id.ensure)(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSelectionRanges:(i,s,o)=>{let a=this._client,c=async(l,h,f)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l),positions:await a.code2ProtocolConverter.asPositions(h,f)};return a.sendRequest(Fd.SelectionRangeRequest.type,C,f).then(b=>f.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(b,f),b=>a.handleFailedRequest(Fd.SelectionRangeRequest.type,f,b,null))},u=a.middleware;return u.provideSelectionRanges?u.provideSelectionRanges(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return XP.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Ec.SelectionRangeFeature=lw});var pw=L(xc=>{"use strict";Object.defineProperty(xc,"__esModule",{value:!0});xc.ProgressFeature=void 0;var fw=ue(),zP=Vl();function BP(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var hw=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:fw.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){BP(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new zP.ProgressPart(this._client,i.token,t))};e.onRequest(fw.WorkDoneProgressCreateRequest.type,r)}dispose(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};xc.ProgressFeature=hw});var vw=L(Fc=>{"use strict";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.CallHierarchyFeature=void 0;var GP=require("vscode"),_i=ue(),Od=Pe(),gw=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,r){let i=this.client,s=this.middleware,o=(a,c,u)=>{let l=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(_i.CallHierarchyPrepareRequest.type,l,u).then(h=>u.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(h,u),h=>i.handleFailedRequest(_i.CallHierarchyPrepareRequest.type,u,h,null))};return s.prepareCallHierarchy?s.prepareCallHierarchy(e,t,r,o):o(e,t,r)}provideCallHierarchyIncomingCalls(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(o)};return r.sendRequest(_i.CallHierarchyIncomingCallsRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(u,a),u=>r.handleFailedRequest(_i.CallHierarchyIncomingCallsRequest.type,a,u,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,s):s(e,t)}provideCallHierarchyOutgoingCalls(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(o)};return r.sendRequest(_i.CallHierarchyOutgoingCallsRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(u,a),u=>r.handleFailedRequest(_i.CallHierarchyOutgoingCallsRequest.type,a,u,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,s):s(e,t)}},mw=class extends Od.TextDocumentLanguageFeature{constructor(e){super(e,_i.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=e,r=(0,Od.ensure)((0,Od.ensure)(t,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new gw(t);return[GP.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};Fc.CallHierarchyFeature=mw});var ww=L(Oc=>{"use strict";Object.defineProperty(Oc,"__esModule",{value:!0});Oc.SemanticTokensFeature=void 0;var Ic=require("vscode"),de=ue(),Xo=Pe(),QP=Rn(),yw=class extends Xo.TextDocumentLanguageFeature{constructor(e){super(e,de.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=(0,Xo.ensure)((0,Xo.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[de.SemanticTokenTypes.namespace,de.SemanticTokenTypes.type,de.SemanticTokenTypes.class,de.SemanticTokenTypes.enum,de.SemanticTokenTypes.interface,de.SemanticTokenTypes.struct,de.SemanticTokenTypes.typeParameter,de.SemanticTokenTypes.parameter,de.SemanticTokenTypes.variable,de.SemanticTokenTypes.property,de.SemanticTokenTypes.enumMember,de.SemanticTokenTypes.event,de.SemanticTokenTypes.function,de.SemanticTokenTypes.method,de.SemanticTokenTypes.macro,de.SemanticTokenTypes.keyword,de.SemanticTokenTypes.modifier,de.SemanticTokenTypes.comment,de.SemanticTokenTypes.string,de.SemanticTokenTypes.number,de.SemanticTokenTypes.regexp,de.SemanticTokenTypes.operator,de.SemanticTokenTypes.decorator],t.tokenModifiers=[de.SemanticTokenModifiers.declaration,de.SemanticTokenModifiers.definition,de.SemanticTokenModifiers.readonly,de.SemanticTokenModifiers.static,de.SemanticTokenModifiers.deprecated,de.SemanticTokenModifiers.abstract,de.SemanticTokenModifiers.async,de.SemanticTokenModifiers.modification,de.SemanticTokenModifiers.documentation,de.SemanticTokenModifiers.defaultLibrary],t.formats=[de.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,Xo.ensure)((0,Xo.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(de.SemanticTokensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeSemanticTokensEmitter.fire()});let[i,s]=this.getRegistration(t,e.semanticTokensProvider);!i||!s||this.register({id:i,registerOptions:s})}registerLanguageProvider(e){let t=e.documentSelector,r=QP.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,s=new Ic.EventEmitter,o=r?{onDidChangeSemanticTokens:s.event,provideDocumentSemanticTokens:(C,b)=>{let y=this._client,S=y.middleware,R=(v,D)=>{let k={textDocument:y.code2ProtocolConverter.asTextDocumentIdentifier(v)};return y.sendRequest(de.SemanticTokensRequest.type,k,D).then(x=>D.isCancellationRequested?null:y.protocol2CodeConverter.asSemanticTokens(x,D),x=>y.handleFailedRequest(de.SemanticTokensRequest.type,D,x,null))};return S.provideDocumentSemanticTokens?S.provideDocumentSemanticTokens(C,b,R):R(C,b)},provideDocumentSemanticTokensEdits:i?(C,b,y)=>{let S=this._client,R=S.middleware,v=(D,k,x)=>{let F={textDocument:S.code2ProtocolConverter.asTextDocumentIdentifier(D),previousResultId:k};return S.sendRequest(de.SemanticTokensDeltaRequest.type,F,x).then(async N=>x.isCancellationRequested?null:de.SemanticTokens.is(N)?await S.protocol2CodeConverter.asSemanticTokens(N,x):await S.protocol2CodeConverter.asSemanticTokensEdits(N,x),N=>S.handleFailedRequest(de.SemanticTokensDeltaRequest.type,x,N,null))};return R.provideDocumentSemanticTokensEdits?R.provideDocumentSemanticTokensEdits(C,b,y,v):v(C,b,y)}:void 0}:void 0,c=e.range===!0?{provideDocumentRangeSemanticTokens:(C,b,y)=>{let S=this._client,R=S.middleware,v=(D,k,x)=>{let F={textDocument:S.code2ProtocolConverter.asTextDocumentIdentifier(D),range:S.code2ProtocolConverter.asRange(k)};return S.sendRequest(de.SemanticTokensRangeRequest.type,F,x).then(N=>x.isCancellationRequested?null:S.protocol2CodeConverter.asSemanticTokens(N,x),N=>S.handleFailedRequest(de.SemanticTokensRangeRequest.type,x,N,null))};return R.provideDocumentRangeSemanticTokens?R.provideDocumentRangeSemanticTokens(C,b,y,v):v(C,b,y)}}:void 0,u=[],l=this._client,h=l.protocol2CodeConverter.asSemanticTokensLegend(e.legend),f=l.protocol2CodeConverter.asDocumentSelector(t);return o!==void 0&&u.push(Ic.languages.registerDocumentSemanticTokensProvider(f,o,h)),c!==void 0&&u.push(Ic.languages.registerDocumentRangeSemanticTokensProvider(f,c,h)),[new Ic.Disposable(()=>u.forEach(C=>C.dispose())),{range:c,full:o,onDidChangeSemanticTokensEmitter:s}]}};Oc.SemanticTokensFeature=yw});var _w=L(un=>{"use strict";Object.defineProperty(un,"__esModule",{value:!0});un.WillDeleteFilesFeature=un.WillRenameFilesFeature=un.WillCreateFilesFeature=un.DidDeleteFilesFeature=un.DidRenameFilesFeature=un.DidCreateFilesFeature=void 0;var En=require("vscode"),YP=rc(),xr=ue(),JP=it();function bw(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function ZP(n,e){return n[e]}function Cw(n,e,t){n[e]=t}var ri=class{constructor(e,t,r,i,s){this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=s,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=bw(bw(e,"workspace"),"fileOperations");Cw(t,"dynamicRegistration",!0),Cw(t,this._clientCapability,!0)}initialize(e){var i;let t=(i=e.workspace)==null?void 0:i.fileOperations,r=t!==void 0?ZP(t,this._serverCapability):void 0;if((r==null?void 0:r.filters)!==void 0)try{this.register({id:JP.generateUuid(),registerOptions:{filters:r.filters}})}catch(s){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${s}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(r=>{let i=new YP.Minimatch(r.pattern.glob,ri.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return ri.getFileType(e)}async filter(e,t){let r=await Promise.all(e.files.map(async s=>{let o=t(s),a=o.fsPath.replace(/\\/g,"/");for(let c of this._filters.values())for(let u of c)if(!(u.scheme!==void 0&&u.scheme!==o.scheme)){if(u.matcher.match(a)){if(u.kind===void 0)return!0;let l=await this.getFileType(o);if(l===void 0)return this._client.error(`Failed to determine file type for ${o.toString()}.`),!0;if(l===En.FileType.File&&u.kind===xr.FileOperationPatternKind.file||l===En.FileType.Directory&&u.kind===xr.FileOperationPatternKind.folder)return!0}else if(u.kind===xr.FileOperationPatternKind.folder&&await ri.getFileType(o)===En.FileType.Directory&&u.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((s,o)=>r[o]);return Mi(le({},e),{files:i})}static async getFileType(e){try{return(await En.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){if(e!==void 0&&e.ignoreCase===!0)return{nocase:!0}}},Nd=class extends ri{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s);this._notificationType=r,this._accessUri=o,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}},qd=class extends Nd{constructor(){super(...arguments);this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let r=await ri.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}dispose(){super.dispose(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},Dw=class extends Nd{constructor(e){super(e,En.workspace.onDidCreateFiles,xr.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return(r==null?void 0:r.didCreateFiles)?r.didCreateFiles(e,t):t(e)}};un.DidCreateFilesFeature=Dw;var Tw=class extends qd{constructor(e){super(e,En.workspace.onDidRenameFiles,xr.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=En.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return(r==null?void 0:r.didRenameFiles)?r.didRenameFiles(e,t):t(e)}};un.DidRenameFilesFeature=Tw;var Sw=class extends qd{constructor(e){super(e,En.workspace.onDidDeleteFiles,xr.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=En.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){this.clearFileTypeCache();let r=this._client.middleware.workspace;return(r==null?void 0:r.didDeleteFiles)?r.didDeleteFiles(e,t):t(e)}};un.DidDeleteFilesFeature=Sw;var Nc=class extends ri{constructor(e,t,r,i,s,o,a){super(e,t,r,i,s);this._requestType=r,this._accessUri=o,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}},Rw=class extends Nc{constructor(e){super(e,En.workspace.onWillCreateFiles,xr.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return(r==null?void 0:r.willCreateFiles)?r.willCreateFiles(e,t):t(e)}};un.WillCreateFilesFeature=Rw;var kw=class extends Nc{constructor(e){super(e,En.workspace.onWillRenameFiles,xr.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return(r==null?void 0:r.willRenameFiles)?r.willRenameFiles(e,t):t(e)}};un.WillRenameFilesFeature=kw;var Pw=class extends Nc{constructor(e){super(e,En.workspace.onWillDeleteFiles,xr.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){let r=this._client.middleware.workspace;return(r==null?void 0:r.willDeleteFiles)?r.willDeleteFiles(e,t):t(e)}};un.WillDeleteFilesFeature=Pw});var xw=L(qc=>{"use strict";Object.defineProperty(qc,"__esModule",{value:!0});qc.LinkedEditingFeature=void 0;var e_=require("vscode"),Ld=ue(),Md=Pe(),Ew=class extends Md.TextDocumentLanguageFeature{constructor(e){super(e,Ld.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=(0,Md.ensure)((0,Md.ensure)(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideLinkedEditingRanges:(i,s,o)=>{let a=this._client,c=(l,h,f)=>a.sendRequest(Ld.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,h),f).then(C=>f.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(C,f),C=>a.handleFailedRequest(Ld.LinkedEditingRangeRequest.type,f,C,null)),u=a.middleware;return u.provideLinkedEditingRange?u.provideLinkedEditingRange(i,s,o,c):c(i,s,o)}};return[this.registerProvider(t,r),r]}registerProvider(e,t){return e_.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};qc.LinkedEditingFeature=Ew});var Ow=L(Lc=>{"use strict";Object.defineProperty(Lc,"__esModule",{value:!0});Lc.TypeHierarchyFeature=void 0;var t_=require("vscode"),Ei=ue(),Ad=Pe(),Fw=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,r){let i=this.client,s=this.middleware,o=(a,c,u)=>{let l=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(Ei.TypeHierarchyPrepareRequest.type,l,u).then(h=>u.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(h,u),h=>i.handleFailedRequest(Ei.TypeHierarchyPrepareRequest.type,u,h,null))};return s.prepareTypeHierarchy?s.prepareTypeHierarchy(e,t,r,o):o(e,t,r)}provideTypeHierarchySupertypes(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(o)};return r.sendRequest(Ei.TypeHierarchySupertypesRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(u,a),u=>r.handleFailedRequest(Ei.TypeHierarchySupertypesRequest.type,a,u,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,s):s(e,t)}provideTypeHierarchySubtypes(e,t){let r=this.client,i=this.middleware,s=(o,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(o)};return r.sendRequest(Ei.TypeHierarchySubtypesRequest.type,c,a).then(u=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(u,a),u=>r.handleFailedRequest(Ei.TypeHierarchySubtypesRequest.type,a,u,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,s):s(e,t)}},Iw=class extends Ad.TextDocumentLanguageFeature{constructor(e){super(e,Ei.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=(0,Ad.ensure)((0,Ad.ensure)(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new Fw(t);return[t_.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};Lc.TypeHierarchyFeature=Iw});var Lw=L(Ac=>{"use strict";Object.defineProperty(Ac,"__esModule",{value:!0});Ac.InlineValueFeature=void 0;var Nw=require("vscode"),Mc=ue(),zo=Pe(),qw=class extends zo.TextDocumentLanguageFeature{constructor(e){super(e,Mc.InlineValueRequest.type)}fillClientCapabilities(e){(0,zo.ensure)((0,zo.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,zo.ensure)((0,zo.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(Mc.InlineValueRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlineValues.fire()});let[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new Nw.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(s,o,a,c)=>{let u=this._client,l=(f,C,b,y)=>{let S={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(f),range:u.code2ProtocolConverter.asRange(C),context:u.code2ProtocolConverter.asInlineValueContext(b)};return u.sendRequest(Mc.InlineValueRequest.type,S,y).then(R=>y.isCancellationRequested?null:u.protocol2CodeConverter.asInlineValues(R,y),R=>u.handleFailedRequest(Mc.InlineValueRequest.type,y,R,null))},h=u.middleware;return h.provideInlineValues?h.provideInlineValues(s,o,a,c,l):l(s,o,a,c)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:r}]}registerProvider(e,t){return Nw.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Ac.InlineValueFeature=qw});var $w=L($c=>{"use strict";Object.defineProperty($c,"__esModule",{value:!0});$c.InlayHintsFeature=void 0;var Mw=require("vscode"),bs=ue(),Bo=Pe(),Aw=class extends Bo.TextDocumentLanguageFeature{constructor(e){super(e,bs.InlayHintRequest.type)}fillClientCapabilities(e){let t=(0,Bo.ensure)((0,Bo.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,Bo.ensure)((0,Bo.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(bs.InlayHintRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlayHints.fire()});let[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new Mw.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(s,o,a)=>{let c=this._client,u=async(h,f,C)=>{let b={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(h),range:c.code2ProtocolConverter.asRange(f)};try{let y=await c.sendRequest(bs.InlayHintRequest.type,b,C);return C.isCancellationRequested?null:c.protocol2CodeConverter.asInlayHints(y,C)}catch(y){return c.handleFailedRequest(bs.InlayHintRequest.type,C,y,null)}},l=c.middleware;return l.provideInlayHints?l.provideInlayHints(s,o,a,u):u(s,o,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(s,o)=>{let a=this._client,c=async(l,h)=>{try{let f=await a.sendRequest(bs.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(l),h);if(h.isCancellationRequested)return null;let C=a.protocol2CodeConverter.asInlayHint(f,h);return h.isCancellationRequested?null:C}catch(f){return a.handleFailedRequest(bs.InlayHintResolveRequest.type,h,f,null)}},u=a.middleware;return u.resolveInlayHint?u.resolveInlayHint(s,o,c):c(s,o)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:r}]}registerProvider(e,t){return Mw.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};$c.InlayHintsFeature=Aw});var jd=L(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});ze.ProposedFeatures=ze.BaseLanguageClient=ze.MessageTransports=ze.SuspendMode=ze.State=ze.CloseAction=ze.ErrorAction=ze.RevealOutputChannelOn=void 0;var Me=require("vscode"),K=ue(),n_=mv(),r_=wv(),ar=Rn(),jc=Ba(),jw=it(),i_=Vl(),zn=Pe(),s_=nd(),Ww=iy(),Hw=cy(),Cs=gy(),o_=vy(),a_=wy(),c_=Cy(),u_=Sy(),l_=ky(),d_=hd(),f_=xy(),h_=Iy(),p_=Ny(),g_=My(),$d=Wy(),m_=Ky(),v_=Xy(),y_=Gy(),w_=Yy(),b_=Zy(),C_=tw(),D_=rw(),T_=sw(),S_=aw(),R_=uw(),k_=dw(),P_=pw(),__=vw(),E_=ww(),Ds=_w(),x_=xw(),F_=Ow(),I_=Lw(),O_=$w(),Go;(function(n){n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(Go=ze.RevealOutputChannelOn||(ze.RevealOutputChannelOn={}));var Wc;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(Wc=ze.ErrorAction||(ze.ErrorAction={}));var xi;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(xi=ze.CloseAction||(ze.CloseAction={}));var Hc;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})(Hc=ze.State||(ze.State={}));var N_;(function(n){n.off="off",n.on="on"})(N_=ze.SuspendMode||(ze.SuspendMode={}));var Uw=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:Wc.Continue}:{action:Wc.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:xi.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:xi.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:xi.Restart})}},we;(function(n){n.Initial="initial",n.Starting="starting",n.StartFailed="startFailed",n.Running="running",n.Stopping="stopping",n.Stopped="stopped"})(we||(we={}));var q_;(function(n){function e(t){return t&&K.MessageReader.is(t.reader)&&K.MessageWriter.is(t.writer)}n.is=e})(q_=ze.MessageTransports||(ze.MessageTransports={}));var ii=class{constructor(e,t,r){var s;this._traceFormat=K.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new jc.Semaphore(1),this._id=e,this._name=t,r=r||{};let i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=r.markdown.isTrusted===!0,i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??Go.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler((s=r.connectionOptions)==null?void 0:s.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=we.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new jc.Semaphore(1),this._pendingChangeDelayer=new jc.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new jc.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new K.Emitter,this._stateChangeEmitter=new K.Emitter,this._trace=K.Trace.Off,this._tracer={log:(o,a)=>{ar.string(o)?this.logTrace(o,a):this.logObjectTrace(o)}},this._c2p=n_.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=r_.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=Me.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){switch(this.$state){case we.Starting:return Hc.Starting;case we.Running:return Hc.Running;default:return Hc.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===we.StartFailed||this.$state===we.Stopping||this.$state===we.Stopped)return Promise.reject(new K.ResponseError(K.ErrorCodes.ConnectionInactive,"Client is not running"));let r=await this.$start();return this._didChangeTextDocumentFeature.syncKind===K.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(r),r.sendRequest(e,...t)}onRequest(e,t){let r=typeof e=="string"?e:e.method;this._requestHandlers.set(r,t);let i=this.activeConnection(),s;return i!==void 0?(this._requestDisposables.set(r,i.onRequest(e,t)),s={dispose:()=>{let o=this._requestDisposables.get(r);o!==void 0&&(o.dispose(),this._requestDisposables.delete(r))}}):(this._pendingRequestHandlers.set(r,t),s={dispose:()=>{this._pendingRequestHandlers.delete(r);let o=this._requestDisposables.get(r);o!==void 0&&(o.dispose(),this._requestDisposables.delete(r))}}),{dispose:()=>{this._requestHandlers.delete(r),s.dispose()}}}async sendNotification(e,t){if(this.$state===we.StartFailed||this.$state===we.Stopping||this.$state===we.Stopped)return Promise.reject(new K.ResponseError(K.ErrorCodes.ConnectionInactive,"Client is not running"));let r=this._didChangeTextDocumentFeature.syncKind===K.TextDocumentSyncKind.Full,i;r&&typeof e!="string"&&e.method===K.DidOpenTextDocumentNotification.method&&(i=t==null?void 0:t.textDocument.uri,this._pendingOpenNotifications.add(i));let s=await this.$start();return r&&await this.sendPendingFullTextDocumentChanges(s),i!==void 0&&this._pendingOpenNotifications.delete(i),s.sendNotification(e,t)}onNotification(e,t){let r=typeof e=="string"?e:e.method;this._notificationHandlers.set(r,t);let i=this.activeConnection(),s;return i!==void 0?(this._notificationDisposables.set(r,i.onNotification(e,t)),s={dispose:()=>{let o=this._notificationDisposables.get(r);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(r))}}):(this._pendingNotificationHandlers.set(r,t),s={dispose:()=>{this._pendingNotificationHandlers.delete(r);let o=this._notificationDisposables.get(r);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(r))}}),{dispose:()=>{this._notificationHandlers.delete(r),s.dispose()}}}async sendProgress(e,t,r){if(this.$state===we.StartFailed||this.$state===we.Stopping||this.$state===we.Stopped)return Promise.reject(new K.ResponseError(K.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,r)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}onProgress(e,t,r){var c;this._progressHandlers.set(t,{type:e,handler:r});let i=this.activeConnection(),s,o=(c=this._clientOptions.middleware)==null?void 0:c.handleWorkDoneProgress,a=K.WorkDoneProgress.is(e)&&o!==void 0?u=>{o(t,u,()=>r(u))}:r;return i!==void 0?(this._progressDisposables.set(t,i.onProgress(e,t,a)),s={dispose:()=>{let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:r}),s={dispose:()=>{this._pendingProgressHandlers.delete(t);let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),s.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new Uw(this,e??4)}async setTrace(e){this._trace=e;let t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof K.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?ar.string(e.stack)?e.stack:e.message:ar.string(e)?e:e.toString()}info(e,t,r=!0){this.outputChannel.appendLine(`[Info  - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),r&&this._clientOptions.revealOutputChannelOn<=Go.Info&&this.showNotificationMessage(K.MessageType.Info,e)}warn(e,t,r=!0){this.outputChannel.appendLine(`[Warn  - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),r&&this._clientOptions.revealOutputChannelOn<=Go.Warn&&this.showNotificationMessage(K.MessageType.Warning,e)}error(e,t,r=!0){this.outputChannel.appendLine(`[Error - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),(r==="force"||r&&this._clientOptions.revealOutputChannelOn<=Go.Error)&&this.showNotificationMessage(K.MessageType.Error,e)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===K.MessageType.Error?Me.window.showErrorMessage:e===K.MessageType.Warning?Me.window.showWarningMessage:Me.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===we.Initial||this.$state===we.Stopping||this.$state===we.Stopped}needsStop(){return this.$state===we.Starting||this.$state===we.Running}activeConnection(){return this.$state===we.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===we.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===we.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;let[e,t,r]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?Me.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):Me.languages.createDiagnosticCollection());for(let[i,s]of this._notificationHandlers)this._pendingNotificationHandlers.has(i)||this._pendingNotificationHandlers.set(i,s);for(let[i,s]of this._requestHandlers)this._pendingRequestHandlers.has(i)||this._pendingRequestHandlers.set(i,s);for(let[i,s]of this._progressHandlers)this._pendingProgressHandlers.has(i)||this._pendingProgressHandlers.set(i,s);this.$state=we.Starting;try{let i=await this.createConnection();i.onNotification(K.LogMessageNotification.type,s=>{switch(s.type){case K.MessageType.Error:this.error(s.message,void 0,!1);break;case K.MessageType.Warning:this.warn(s.message,void 0,!1);break;case K.MessageType.Info:this.info(s.message,void 0,!1);break;default:this.outputChannel.appendLine(s.message)}}),i.onNotification(K.ShowMessageNotification.type,s=>{switch(s.type){case K.MessageType.Error:Me.window.showErrorMessage(s.message);break;case K.MessageType.Warning:Me.window.showWarningMessage(s.message);break;case K.MessageType.Info:Me.window.showInformationMessage(s.message);break;default:Me.window.showInformationMessage(s.message)}}),i.onRequest(K.ShowMessageRequest.type,s=>{let o;switch(s.type){case K.MessageType.Error:o=Me.window.showErrorMessage;break;case K.MessageType.Warning:o=Me.window.showWarningMessage;break;case K.MessageType.Info:o=Me.window.showInformationMessage;break;default:o=Me.window.showInformationMessage}let a=s.actions||[];return o(s.message,...a)}),i.onNotification(K.TelemetryEventNotification.type,s=>{this._telemetryEmitter.fire(s)}),i.onRequest(K.ShowDocumentRequest.type,async s=>{var c;let o=async u=>{let l=this.protocol2CodeConverter.asUri(u.uri);try{if(u.external===!0)return{success:await Me.env.openExternal(l)};{let h={};return u.selection!==void 0&&(h.selection=this.protocol2CodeConverter.asRange(u.selection)),u.takeFocus===void 0||u.takeFocus===!1?h.preserveFocus=!0:u.takeFocus===!0&&(h.preserveFocus=!1),await Me.window.showTextDocument(l,h),{success:!0}}}catch{return{success:!1}}},a=(c=this._clientOptions.middleware.window)==null?void 0:c.showDocument;return a!==void 0?a(s,o):o(s)}),i.listen(),await this.initialize(i),t()}catch(i){this.$state=we.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,i,"force"),r(i)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise((i,s)=>{e=i,t=s}),e,t]}async initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],s={processId:null,clientInfo:{name:Me.env.appName,version:Me.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(Me.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:ar.func(t)?t():t,trace:K.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(s),this._clientOptions.progressOnInitialization){let o=jw.generateUuid(),a=new i_.ProgressPart(e,o);s.workDoneToken=o;try{let c=await this.doInitialize(e,s);return a.done(),c}catch(c){throw a.cancel(),c}}else return this.doInitialize(e,s)}async doInitialize(e,t){try{let r=await e.initialize(t);if(r.capabilities.positionEncoding!==void 0&&r.capabilities.positionEncoding!==K.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${r.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=r,this.$state=we.Running;let i;ar.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===K.TextDocumentSyncKind.None?i={openClose:!1,change:K.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onNotification(K.PublishDiagnosticsNotification.type,s=>this.handleDiagnostics(s)),e.onRequest(K.RegistrationRequest.type,s=>this.handleRegistrationRequest(s)),e.onRequest("client/registerFeature",s=>this.handleRegistrationRequest(s)),e.onRequest(K.UnregistrationRequest.type,s=>this.handleUnregistrationRequest(s)),e.onRequest("client/unregisterFeature",s=>this.handleUnregistrationRequest(s)),e.onRequest(K.ApplyWorkspaceEditRequest.type,s=>this.handleApplyWorkspaceEdit(s));for(let[s,o]of this._pendingNotificationHandlers)this._notificationDisposables.set(s,e.onNotification(s,o));this._pendingNotificationHandlers.clear();for(let[s,o]of this._pendingRequestHandlers)this._requestDisposables.set(s,e.onRequest(s,o));this._pendingRequestHandlers.clear();for(let[s,o]of this._pendingProgressHandlers)this._progressDisposables.set(s,e.onProgress(o.type,s,o.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(K.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),r}catch(r){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):this.stop():r instanceof K.ResponseError&&r.data&&r.data.retry?Me.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):this.stop()}):(r&&r.message&&Me.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop()),r}}_clientGetRootPath(){let e=Me.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===we.Stopped||this.$state===we.Initial)return;if(this.$state===we.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}let r=this.activeConnection();if(r===void 0||this.$state!==we.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=we.Stopping,this.cleanUp(e);let i=new Promise(o=>{(0,K.RAL)().timer.setTimeout(o,t)}),s=(async o=>(await o.shutdown(),await o.exit(),o))(r);return this._onStop=Promise.race([i,s]).then(o=>{if(o!==void 0)o.end(),o.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},o=>{throw this.error("Stopping server failed",o,!1),o}).finally(()=>{this.$state=we.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();let t=this._listeners.splice(0,this._listeners.length);for(let r of t)r.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(let r of Array.from(this._features.entries()).map(i=>i[1]).reverse())r.dispose();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){var s;let t=this;async function r(o){return t._fileEvents.push(o),t._fileEventDelayer.trigger(async()=>{await t.sendNotification(K.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]})}let i=(s=this.clientOptions.middleware)==null?void 0:s.workspace;((i==null?void 0:i.didChangeWatchedFile)?i.didChangeWatchedFile(e,r):r(e)).catch(o=>{t.error("Notify file events failed.",o)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{let t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(t.length===0)return;for(let r of t){let i=this.code2ProtocolConverter.asChangeTextDocumentParams(r);await e.sendNotification(K.DidChangeTextDocumentNotification.type,i),this._didChangeTextDocumentFeature.notificationSent(r,K.DidChangeTextDocumentNotification.type,i)}}catch(t){throw this.error("Sending pending changes failed",t,!1),t}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{let e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,K.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,r]=e.value;this._diagnosticQueue.delete(t);let i=new Me.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(s=>{if(!i.token.isCancellationRequested){let o=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(o,s,(c,u)=>this.setDiagnostics(c,u)):this.setDiagnostics(o,s)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){!this._diagnostics||this._diagnostics.set(e,t)}getLocale(){return Me.env.language}async $start(){if(this.$state===we.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();let e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(i,s,o)=>{this.handleConnectionError(i,s,o).catch(a=>this.error("Handling connection error failed",a))},t=()=>{this.handleConnectionClosed().catch(i=>this.error("Handling connection close failed",i))},r=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=L_(r.reader,r.writer,e,t,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===we.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:xi.DoNotRestart};if(this.$state!==we.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===xi.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===we.Starting?this.$state=we.StartFailed:this.$state=we.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===xi.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=we.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(t=>this.error("Restarting server failed",t,"force")))}async handleConnectionError(e,t,r){let i=await this._clientOptions.errorHandler.error(e,t,r);i.action===Wc.Shutdown&&(this.error(i.message??`Client ${this._name}: connection to server is erroring. Shutting down server.`,void 0,i.handled===!0?!1:"force"),this.stop().catch(s=>{this.error("Stopping server failed",s,!1)}))}hookConfigurationChanged(e){this._listeners.push(Me.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,t=!1){let r=Me.workspace.getConfiguration(this._id),i=K.Trace.Off,s=K.TraceFormat.Text;if(r){let o=r.get("trace.server","off");typeof o=="string"?i=K.Trace.fromString(o):(i=K.Trace.fromString(r.get("trace.server.verbosity","off")),s=K.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=s,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(o=>{this.error("Updating trace failed with error",o,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;ar.array(t)?r=t:r=[t],!!r&&this._dynamicFeatures.get(K.DidChangeWatchedFilesNotification.type.method).registerRaw(jw.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),zn.DynamicFeature.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){let t=this.getFeature(K.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof Ww.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){let e=new Map;this.registerFeature(new Hw.ConfigurationFeature(this)),this.registerFeature(new Cs.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new Cs.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new Cs.WillSaveFeature(this)),this.registerFeature(new Cs.WillSaveWaitUntilFeature(this)),this.registerFeature(new Cs.DidSaveTextDocumentFeature(this)),this.registerFeature(new Cs.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new w_.FileSystemWatcherFeature(this,t=>this.notifyFileEvent(t))),this.registerFeature(new o_.CompletionItemFeature(this)),this.registerFeature(new a_.HoverFeature(this)),this.registerFeature(new u_.SignatureHelpFeature(this)),this.registerFeature(new c_.DefinitionFeature(this)),this.registerFeature(new h_.ReferencesFeature(this)),this.registerFeature(new l_.DocumentHighlightFeature(this)),this.registerFeature(new d_.DocumentSymbolFeature(this)),this.registerFeature(new f_.WorkspaceSymbolFeature(this)),this.registerFeature(new p_.CodeActionFeature(this)),this.registerFeature(new g_.CodeLensFeature(this)),this.registerFeature(new $d.DocumentFormattingFeature(this)),this.registerFeature(new $d.DocumentRangeFormattingFeature(this)),this.registerFeature(new $d.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new m_.RenameFeature(this)),this.registerFeature(new v_.DocumentLinkFeature(this)),this.registerFeature(new y_.ExecuteCommandFeature(this)),this.registerFeature(new Hw.SyncConfigurationFeature(this)),this.registerFeature(new D_.TypeDefinitionFeature(this)),this.registerFeature(new C_.ImplementationFeature(this)),this.registerFeature(new b_.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new T_.WorkspaceFoldersFeature(this)),this.registerFeature(new S_.FoldingRangeFeature(this)),this.registerFeature(new R_.DeclarationFeature(this)),this.registerFeature(new k_.SelectionRangeFeature(this)),this.registerFeature(new P_.ProgressFeature(this)),this.registerFeature(new __.CallHierarchyFeature(this)),this.registerFeature(new E_.SemanticTokensFeature(this)),this.registerFeature(new x_.LinkedEditingFeature(this)),this.registerFeature(new Ds.DidCreateFilesFeature(this)),this.registerFeature(new Ds.DidRenameFilesFeature(this)),this.registerFeature(new Ds.DidDeleteFilesFeature(this)),this.registerFeature(new Ds.WillCreateFilesFeature(this)),this.registerFeature(new Ds.WillRenameFilesFeature(this)),this.registerFeature(new Ds.WillDeleteFilesFeature(this)),this.registerFeature(new F_.TypeHierarchyFeature(this)),this.registerFeature(new I_.InlineValueFeature(this)),this.registerFeature(new O_.InlayHintsFeature(this)),this.registerFeature(new s_.DiagnosticFeature(this)),this.registerFeature(new Ww.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(Vw.createAll(this))}fillInitializeParams(e){for(let t of this._features)ar.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};(0,zn.ensure)(e,"workspace").applyEdit=!0;let t=(0,zn.ensure)((0,zn.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[K.ResourceOperationKind.Create,K.ResourceOperationKind.Rename,K.ResourceOperationKind.Delete],t.failureHandling=K.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let r=(0,zn.ensure)((0,zn.ensure)(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[K.DiagnosticTag.Unnecessary,K.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;let i=(0,zn.ensure)(e,"window"),s=(0,zn.ensure)(i,"showMessage");s.messageActionItem={additionalPropertiesSupport:!0};let o=(0,zn.ensure)(i,"showDocument");o.support=!0;let a=(0,zn.ensure)(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(ii.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},a.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let c of this._features)c.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let r of this._features)ar.func(r.preInitialize)&&r.preInitialize(this._capabilities,t);for(let r of this._features)r.initialize(this._capabilities,t)}async handleRegistrationRequest(e){if(!this.isRunning()){for(let t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(let t of e.registrations){let r=this._dynamicFeatures.get(t.method);if(r===void 0)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));let i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;let s={id:t.id,registerOptions:i};try{r.register(s)}catch(o){return Promise.reject(o)}}}async handleUnregistrationRequest(e){for(let t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;let r=this._dynamicFeatures.get(t.method);if(!r)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));r.unregister(t.id)}}async handleApplyWorkspaceEdit(e){let t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;Me.workspace.textDocuments.forEach(o=>i.set(o.uri.toString(),o));let s=!1;if(t.documentChanges){for(let o of t.documentChanges)if(K.TextDocumentEdit.is(o)&&o.textDocument.version&&o.textDocument.version>=0){let a=this._p2c.asUri(o.textDocument.uri).toString(),c=i.get(a);if(c&&c.version!==o.textDocument.version){s=!0;break}}}return s?Promise.resolve({applied:!1}):ar.asPromise(Me.workspace.applyEdit(r).then(o=>({applied:o})))}handleFailedRequest(e,t,r,i,s=!0){if(r instanceof K.ResponseError){if(r.code===K.ErrorCodes.PendingResponseRejected||r.code===K.ErrorCodes.ConnectionInactive)return i;if(r.code===K.LSPErrorCodes.RequestCancelled||r.code===K.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new zn.LSPCancellationError(r.data):new Me.CancellationError}else if(r.code===K.LSPErrorCodes.ContentModified){if(ii.RequestsToCancelOnContentModified.has(e.method)||ii.CancellableResolveCalls.has(e.method))throw new Me.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,s),r}};ze.BaseLanguageClient=ii;ii.RequestsToCancelOnContentModified=new Set([K.SemanticTokensRequest.method,K.SemanticTokensRangeRequest.method,K.SemanticTokensDeltaRequest.method]);ii.CancellableResolveCalls=new Set([K.CompletionResolveRequest.method,K.CodeLensResolveRequest.method,K.CodeActionResolveRequest.method,K.InlayHintResolveRequest.method,K.DocumentLinkResolveRequest.method,K.WorkspaceSymbolResolveRequest.method]);var Kw=class{error(e){(0,K.RAL)().console.error(e)}warn(e){(0,K.RAL)().console.warn(e)}info(e){(0,K.RAL)().console.info(e)}log(e){(0,K.RAL)().console.log(e)}};function L_(n,e,t,r,i){let s=new Kw,o=(0,K.createProtocolConnection)(n,e,s,i);return o.onError(c=>{t(c[0],c[1],c[2])}),o.onClose(r),{listen:()=>o.listen(),sendRequest:o.sendRequest,onRequest:o.onRequest,hasPendingResponse:o.hasPendingResponse,sendNotification:o.sendNotification,onNotification:o.onNotification,onProgress:o.onProgress,sendProgress:o.sendProgress,trace:(c,u,l)=>{let h={sendNotification:!1,traceFormat:K.TraceFormat.Text};return l===void 0?o.trace(c,u,h):(ar.boolean(l),o.trace(c,u,l))},initialize:c=>o.sendRequest(K.InitializeRequest.type,c),shutdown:()=>o.sendRequest(K.ShutdownRequest.type,void 0),exit:()=>o.sendNotification(K.ExitNotification.type),end:()=>o.end(),dispose:()=>o.dispose()}}var Vw;(function(n){function e(t){return[]}n.createAll=e})(Vw=ze.ProposedFeatures||(ze.ProposedFeatures={}))});var zw=L(Uc=>{"use strict";Object.defineProperty(Uc,"__esModule",{value:!0});Uc.terminate=void 0;var Xw=require("child_process"),M_=require("path"),A_=process.platform==="win32",$_=process.platform==="darwin",j_=process.platform==="linux";function W_(n,e){if(A_)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),Xw.execFileSync("taskkill",["/T","/F","/PID",n.pid.toString()],i),!0}catch{return!1}else if(j_||$_)try{var t=(0,M_.join)(__dirname,"terminateProcess.sh"),r=Xw.spawnSync(t,[n.pid.toString()]);return!r.error}catch{return!1}else return n.kill("SIGKILL"),!0}Uc.terminate=W_});var Wd=L((yO,Bw)=>{"use strict";Bw.exports=ue()});var Qo=L((wO,Gw)=>{var H_=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};Gw.exports=H_});var Kc=L((bO,Yw)=>{var U_="2.0.0",Qw=256,K_=Number.MAX_SAFE_INTEGER||9007199254740991,V_=16,X_=Qw-6,z_=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Yw.exports={MAX_LENGTH:Qw,MAX_SAFE_COMPONENT_LENGTH:V_,MAX_SAFE_BUILD_LENGTH:X_,MAX_SAFE_INTEGER:K_,RELEASE_TYPES:z_,SEMVER_SPEC_VERSION:U_,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Xc=L((Fr,Jw)=>{var{MAX_SAFE_COMPONENT_LENGTH:Vc,MAX_SAFE_BUILD_LENGTH:B_}=Kc(),G_=Qo();Fr=Jw.exports={};var Q_=Fr.re=[],Y_=Fr.safeRe=[],Z=Fr.src=[],ee=Fr.t={},J_=0,Hd="[a-zA-Z0-9-]",Z_=[["\\s",1],["\\d",Vc],[Hd,B_]],eE=n=>{for(let[e,t]of Z_)n=n.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return n},ge=(n,e,t)=>{let r=eE(e),i=J_++;G_(n,i,e),ee[n]=i,Z[i]=e,Q_[i]=new RegExp(e,t?"g":void 0),Y_[i]=new RegExp(r,t?"g":void 0)};ge("NUMERICIDENTIFIER","0|[1-9]\\d*");ge("NUMERICIDENTIFIERLOOSE","\\d+");ge("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${Hd}*`);ge("MAINVERSION",`(${Z[ee.NUMERICIDENTIFIER]})\\.(${Z[ee.NUMERICIDENTIFIER]})\\.(${Z[ee.NUMERICIDENTIFIER]})`);ge("MAINVERSIONLOOSE",`(${Z[ee.NUMERICIDENTIFIERLOOSE]})\\.(${Z[ee.NUMERICIDENTIFIERLOOSE]})\\.(${Z[ee.NUMERICIDENTIFIERLOOSE]})`);ge("PRERELEASEIDENTIFIER",`(?:${Z[ee.NUMERICIDENTIFIER]}|${Z[ee.NONNUMERICIDENTIFIER]})`);ge("PRERELEASEIDENTIFIERLOOSE",`(?:${Z[ee.NUMERICIDENTIFIERLOOSE]}|${Z[ee.NONNUMERICIDENTIFIER]})`);ge("PRERELEASE",`(?:-(${Z[ee.PRERELEASEIDENTIFIER]}(?:\\.${Z[ee.PRERELEASEIDENTIFIER]})*))`);ge("PRERELEASELOOSE",`(?:-?(${Z[ee.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${Z[ee.PRERELEASEIDENTIFIERLOOSE]})*))`);ge("BUILDIDENTIFIER",`${Hd}+`);ge("BUILD",`(?:\\+(${Z[ee.BUILDIDENTIFIER]}(?:\\.${Z[ee.BUILDIDENTIFIER]})*))`);ge("FULLPLAIN",`v?${Z[ee.MAINVERSION]}${Z[ee.PRERELEASE]}?${Z[ee.BUILD]}?`);ge("FULL",`^${Z[ee.FULLPLAIN]}$`);ge("LOOSEPLAIN",`[v=\\s]*${Z[ee.MAINVERSIONLOOSE]}${Z[ee.PRERELEASELOOSE]}?${Z[ee.BUILD]}?`);ge("LOOSE",`^${Z[ee.LOOSEPLAIN]}$`);ge("GTLT","((?:<|>)?=?)");ge("XRANGEIDENTIFIERLOOSE",`${Z[ee.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);ge("XRANGEIDENTIFIER",`${Z[ee.NUMERICIDENTIFIER]}|x|X|\\*`);ge("XRANGEPLAIN",`[v=\\s]*(${Z[ee.XRANGEIDENTIFIER]})(?:\\.(${Z[ee.XRANGEIDENTIFIER]})(?:\\.(${Z[ee.XRANGEIDENTIFIER]})(?:${Z[ee.PRERELEASE]})?${Z[ee.BUILD]}?)?)?`);ge("XRANGEPLAINLOOSE",`[v=\\s]*(${Z[ee.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Z[ee.XRANGEIDENTIFIERLOOSE]})(?:\\.(${Z[ee.XRANGEIDENTIFIERLOOSE]})(?:${Z[ee.PRERELEASELOOSE]})?${Z[ee.BUILD]}?)?)?`);ge("XRANGE",`^${Z[ee.GTLT]}\\s*${Z[ee.XRANGEPLAIN]}$`);ge("XRANGELOOSE",`^${Z[ee.GTLT]}\\s*${Z[ee.XRANGEPLAINLOOSE]}$`);ge("COERCE",`(^|[^\\d])(\\d{1,${Vc}})(?:\\.(\\d{1,${Vc}}))?(?:\\.(\\d{1,${Vc}}))?(?:$|[^\\d])`);ge("COERCERTL",Z[ee.COERCE],!0);ge("LONETILDE","(?:~>?)");ge("TILDETRIM",`(\\s*)${Z[ee.LONETILDE]}\\s+`,!0);Fr.tildeTrimReplace="$1~";ge("TILDE",`^${Z[ee.LONETILDE]}${Z[ee.XRANGEPLAIN]}$`);ge("TILDELOOSE",`^${Z[ee.LONETILDE]}${Z[ee.XRANGEPLAINLOOSE]}$`);ge("LONECARET","(?:\\^)");ge("CARETTRIM",`(\\s*)${Z[ee.LONECARET]}\\s+`,!0);Fr.caretTrimReplace="$1^";ge("CARET",`^${Z[ee.LONECARET]}${Z[ee.XRANGEPLAIN]}$`);ge("CARETLOOSE",`^${Z[ee.LONECARET]}${Z[ee.XRANGEPLAINLOOSE]}$`);ge("COMPARATORLOOSE",`^${Z[ee.GTLT]}\\s*(${Z[ee.LOOSEPLAIN]})$|^$`);ge("COMPARATOR",`^${Z[ee.GTLT]}\\s*(${Z[ee.FULLPLAIN]})$|^$`);ge("COMPARATORTRIM",`(\\s*)${Z[ee.GTLT]}\\s*(${Z[ee.LOOSEPLAIN]}|${Z[ee.XRANGEPLAIN]})`,!0);Fr.comparatorTrimReplace="$1$2$3";ge("HYPHENRANGE",`^\\s*(${Z[ee.XRANGEPLAIN]})\\s+-\\s+(${Z[ee.XRANGEPLAIN]})\\s*$`);ge("HYPHENRANGELOOSE",`^\\s*(${Z[ee.XRANGEPLAINLOOSE]})\\s+-\\s+(${Z[ee.XRANGEPLAINLOOSE]})\\s*$`);ge("STAR","(<|>)?=?\\s*\\*");ge("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");ge("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var zc=L((CO,Zw)=>{var tE=Object.freeze({loose:!0}),nE=Object.freeze({}),rE=n=>n?typeof n!="object"?tE:n:nE;Zw.exports=rE});var rb=L((DO,nb)=>{var eb=/^[0-9]+$/,tb=(n,e)=>{let t=eb.test(n),r=eb.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1},iE=(n,e)=>tb(e,n);nb.exports={compareIdentifiers:tb,rcompareIdentifiers:iE}});var Yo=L((TO,ab)=>{var Bc=Qo(),{MAX_LENGTH:ib,MAX_SAFE_INTEGER:Gc}=Kc(),{safeRe:sb,t:ob}=Xc(),sE=zc(),{compareIdentifiers:Ts}=rb(),xn=class{constructor(e,t){if(t=sE(t),e instanceof xn){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>ib)throw new TypeError(`version is longer than ${ib} characters`);Bc("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?sb[ob.LOOSE]:sb[ob.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>Gc||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Gc||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Gc||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let s=+i;if(s>=0&&s<Gc)return s}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(Bc("SemVer.compare",this.version,this.options,e),!(e instanceof xn)){if(typeof e=="string"&&e===this.version)return 0;e=new xn(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof xn||(e=new xn(e,this.options)),Ts(this.major,e.major)||Ts(this.minor,e.minor)||Ts(this.patch,e.patch)}comparePre(e){if(e instanceof xn||(e=new xn(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],i=e.prerelease[t];if(Bc("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Ts(r,i)}while(++t)}compareBuild(e){e instanceof xn||(e=new xn(e,this.options));let t=0;do{let r=this.build[t],i=e.build[t];if(Bc("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return Ts(r,i)}while(++t)}inc(e,t,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(r)?1:0;if(!t&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let s=[t,i];r===!1&&(s=[t]),Ts(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};ab.exports=xn});var lb=L((SO,ub)=>{var cb=Yo(),oE=(n,e,t=!1)=>{if(n instanceof cb)return n;try{return new cb(n,e)}catch(r){if(!t)return null;throw r}};ub.exports=oE});var fb=L((RO,db)=>{"use strict";db.exports=function(n){n.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}});var pb=L((kO,hb)=>{"use strict";hb.exports=Ie;Ie.Node=Fi;Ie.create=Ie;function Ie(n){var e=this;if(e instanceof Ie||(e=new Ie),e.tail=null,e.head=null,e.length=0,n&&typeof n.forEach=="function")n.forEach(function(i){e.push(i)});else if(arguments.length>0)for(var t=0,r=arguments.length;t<r;t++)e.push(arguments[t]);return e}Ie.prototype.removeNode=function(n){if(n.list!==this)throw new Error("removing node which does not belong to this list");var e=n.next,t=n.prev;return e&&(e.prev=t),t&&(t.next=e),n===this.head&&(this.head=e),n===this.tail&&(this.tail=t),n.list.length--,n.next=null,n.prev=null,n.list=null,e};Ie.prototype.unshiftNode=function(n){if(n!==this.head){n.list&&n.list.removeNode(n);var e=this.head;n.list=this,n.next=e,e&&(e.prev=n),this.head=n,this.tail||(this.tail=n),this.length++}};Ie.prototype.pushNode=function(n){if(n!==this.tail){n.list&&n.list.removeNode(n);var e=this.tail;n.list=this,n.prev=e,e&&(e.next=n),this.tail=n,this.head||(this.head=n),this.length++}};Ie.prototype.push=function(){for(var n=0,e=arguments.length;n<e;n++)cE(this,arguments[n]);return this.length};Ie.prototype.unshift=function(){for(var n=0,e=arguments.length;n<e;n++)uE(this,arguments[n]);return this.length};Ie.prototype.pop=function(){if(!!this.tail){var n=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,n}};Ie.prototype.shift=function(){if(!!this.head){var n=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,n}};Ie.prototype.forEach=function(n,e){e=e||this;for(var t=this.head,r=0;t!==null;r++)n.call(e,t.value,r,this),t=t.next};Ie.prototype.forEachReverse=function(n,e){e=e||this;for(var t=this.tail,r=this.length-1;t!==null;r--)n.call(e,t.value,r,this),t=t.prev};Ie.prototype.get=function(n){for(var e=0,t=this.head;t!==null&&e<n;e++)t=t.next;if(e===n&&t!==null)return t.value};Ie.prototype.getReverse=function(n){for(var e=0,t=this.tail;t!==null&&e<n;e++)t=t.prev;if(e===n&&t!==null)return t.value};Ie.prototype.map=function(n,e){e=e||this;for(var t=new Ie,r=this.head;r!==null;)t.push(n.call(e,r.value,this)),r=r.next;return t};Ie.prototype.mapReverse=function(n,e){e=e||this;for(var t=new Ie,r=this.tail;r!==null;)t.push(n.call(e,r.value,this)),r=r.prev;return t};Ie.prototype.reduce=function(n,e){var t,r=this.head;if(arguments.length>1)t=e;else if(this.head)r=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)t=n(t,r.value,i),r=r.next;return t};Ie.prototype.reduceReverse=function(n,e){var t,r=this.tail;if(arguments.length>1)t=e;else if(this.tail)r=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)t=n(t,r.value,i),r=r.prev;return t};Ie.prototype.toArray=function(){for(var n=new Array(this.length),e=0,t=this.head;t!==null;e++)n[e]=t.value,t=t.next;return n};Ie.prototype.toArrayReverse=function(){for(var n=new Array(this.length),e=0,t=this.tail;t!==null;e++)n[e]=t.value,t=t.prev;return n};Ie.prototype.slice=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new Ie;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(;i!==null&&r<e;r++,i=i.next)t.push(i.value);return t};Ie.prototype.sliceReverse=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new Ie;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=this.length,i=this.tail;i!==null&&r>e;r--)i=i.prev;for(;i!==null&&r>n;r--,i=i.prev)t.push(i.value);return t};Ie.prototype.splice=function(n,e,...t){n>this.length&&(n=this.length-1),n<0&&(n=this.length+n);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(var s=[],r=0;i&&r<e;r++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<t.length;r++)i=aE(this,i,t[r]);return s};Ie.prototype.reverse=function(){for(var n=this.head,e=this.tail,t=n;t!==null;t=t.prev){var r=t.prev;t.prev=t.next,t.next=r}return this.head=e,this.tail=n,this};function aE(n,e,t){var r=e===n.head?new Fi(t,null,e,n):new Fi(t,e,e.next,n);return r.next===null&&(n.tail=r),r.prev===null&&(n.head=r),n.length++,r}function cE(n,e){n.tail=new Fi(e,n.tail,null,n),n.head||(n.head=n.tail),n.length++}function uE(n,e){n.head=new Fi(e,null,n.head,n),n.tail||(n.tail=n.head),n.length++}function Fi(n,e,t,r){if(!(this instanceof Fi))return new Fi(n,e,t,r);this.list=r,this.value=n,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{fb()(Ie)}catch{}});var Cb=L((PO,bb)=>{"use strict";var lE=pb(),Ii=Symbol("max"),Ir=Symbol("length"),Ss=Symbol("lengthCalculator"),Jo=Symbol("allowStale"),Oi=Symbol("maxAge"),Or=Symbol("dispose"),gb=Symbol("noDisposeOnSet"),kt=Symbol("lruList"),Bn=Symbol("cache"),mb=Symbol("updateAgeOnGet"),Ud=()=>1,vb=class{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");let t=this[Ii]=e.max||1/0,r=e.length||Ud;if(this[Ss]=typeof r!="function"?Ud:r,this[Jo]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[Oi]=e.maxAge||0,this[Or]=e.dispose,this[gb]=e.noDisposeOnSet||!1,this[mb]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[Ii]=e||1/0,Zo(this)}get max(){return this[Ii]}set allowStale(e){this[Jo]=!!e}get allowStale(){return this[Jo]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[Oi]=e,Zo(this)}get maxAge(){return this[Oi]}set lengthCalculator(e){typeof e!="function"&&(e=Ud),e!==this[Ss]&&(this[Ss]=e,this[Ir]=0,this[kt].forEach(t=>{t.length=this[Ss](t.value,t.key),this[Ir]+=t.length})),Zo(this)}get lengthCalculator(){return this[Ss]}get length(){return this[Ir]}get itemCount(){return this[kt].length}rforEach(e,t){t=t||this;for(let r=this[kt].tail;r!==null;){let i=r.prev;wb(this,e,r,t),r=i}}forEach(e,t){t=t||this;for(let r=this[kt].head;r!==null;){let i=r.next;wb(this,e,r,t),r=i}}keys(){return this[kt].toArray().map(e=>e.key)}values(){return this[kt].toArray().map(e=>e.value)}reset(){this[Or]&&this[kt]&&this[kt].length&&this[kt].forEach(e=>this[Or](e.key,e.value)),this[Bn]=new Map,this[kt]=new lE,this[Ir]=0}dump(){return this[kt].map(e=>Qc(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[kt]}set(e,t,r){if(r=r||this[Oi],r&&typeof r!="number")throw new TypeError("maxAge must be a number");let i=r?Date.now():0,s=this[Ss](t,e);if(this[Bn].has(e)){if(s>this[Ii])return Rs(this,this[Bn].get(e)),!1;let c=this[Bn].get(e).value;return this[Or]&&(this[gb]||this[Or](e,c.value)),c.now=i,c.maxAge=r,c.value=t,this[Ir]+=s-c.length,c.length=s,this.get(e),Zo(this),!0}let o=new yb(e,t,s,i,r);return o.length>this[Ii]?(this[Or]&&this[Or](e,t),!1):(this[Ir]+=o.length,this[kt].unshift(o),this[Bn].set(e,this[kt].head),Zo(this),!0)}has(e){if(!this[Bn].has(e))return!1;let t=this[Bn].get(e).value;return!Qc(this,t)}get(e){return Kd(this,e,!0)}peek(e){return Kd(this,e,!1)}pop(){let e=this[kt].tail;return e?(Rs(this,e),e.value):null}del(e){Rs(this,this[Bn].get(e))}load(e){this.reset();let t=Date.now();for(let r=e.length-1;r>=0;r--){let i=e[r],s=i.e||0;if(s===0)this.set(i.k,i.v);else{let o=s-t;o>0&&this.set(i.k,i.v,o)}}}prune(){this[Bn].forEach((e,t)=>Kd(this,t,!1))}},Kd=(n,e,t)=>{let r=n[Bn].get(e);if(r){let i=r.value;if(Qc(n,i)){if(Rs(n,r),!n[Jo])return}else t&&(n[mb]&&(r.value.now=Date.now()),n[kt].unshiftNode(r));return i.value}},Qc=(n,e)=>{if(!e||!e.maxAge&&!n[Oi])return!1;let t=Date.now()-e.now;return e.maxAge?t>e.maxAge:n[Oi]&&t>n[Oi]},Zo=n=>{if(n[Ir]>n[Ii])for(let e=n[kt].tail;n[Ir]>n[Ii]&&e!==null;){let t=e.prev;Rs(n,e),e=t}},Rs=(n,e)=>{if(e){let t=e.value;n[Or]&&n[Or](t.key,t.value),n[Ir]-=t.length,n[Bn].delete(t.key),n[kt].removeNode(e)}},yb=class{constructor(e,t,r,i,s){this.key=e,this.value=t,this.length=r,this.now=i,this.maxAge=s||0}},wb=(n,e,t,r)=>{let i=t.value;Qc(n,i)&&(Rs(n,t),n[Jo]||(i=void 0)),i&&e.call(r,i.value,i.key,n)};bb.exports=vb});var Ni=L((_O,Tb)=>{var Db=Yo(),dE=(n,e,t)=>new Db(n,t).compare(new Db(e,t));Tb.exports=dE});var Rb=L((EO,Sb)=>{var fE=Ni(),hE=(n,e,t)=>fE(n,e,t)===0;Sb.exports=hE});var Pb=L((xO,kb)=>{var pE=Ni(),gE=(n,e,t)=>pE(n,e,t)!==0;kb.exports=gE});var Eb=L((FO,_b)=>{var mE=Ni(),vE=(n,e,t)=>mE(n,e,t)>0;_b.exports=vE});var Fb=L((IO,xb)=>{var yE=Ni(),wE=(n,e,t)=>yE(n,e,t)>=0;xb.exports=wE});var Ob=L((OO,Ib)=>{var bE=Ni(),CE=(n,e,t)=>bE(n,e,t)<0;Ib.exports=CE});var qb=L((NO,Nb)=>{var DE=Ni(),TE=(n,e,t)=>DE(n,e,t)<=0;Nb.exports=TE});var Mb=L((qO,Lb)=>{var SE=Rb(),RE=Pb(),kE=Eb(),PE=Fb(),_E=Ob(),EE=qb(),xE=(n,e,t,r)=>{switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return SE(n,t,r);case"!=":return RE(n,t,r);case">":return kE(n,t,r);case">=":return PE(n,t,r);case"<":return _E(n,t,r);case"<=":return EE(n,t,r);default:throw new TypeError(`Invalid operator: ${e}`)}};Lb.exports=xE});var Kb=L((LO,Ub)=>{var ea=Symbol("SemVer ANY"),ta=class{static get ANY(){return ea}constructor(e,t){if(t=Ab(t),e instanceof ta){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),Xd("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===ea?this.value="":this.value=this.operator+this.semver.version,Xd("comp",this)}parse(e){let t=this.options.loose?$b[jb.COMPARATORLOOSE]:$b[jb.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new Wb(r[2],this.options.loose):this.semver=ea}toString(){return this.value}test(e){if(Xd("Comparator.test",e,this.options.loose),this.semver===ea||e===ea)return!0;if(typeof e=="string")try{e=new Wb(e,this.options)}catch{return!1}return Vd(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof ta))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Hb(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new Hb(this.value,t).test(e.semver):(t=Ab(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||Vd(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||Vd(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};Ub.exports=ta;var Ab=zc(),{safeRe:$b,t:jb}=Xc(),Vd=Mb(),Xd=Qo(),Wb=Yo(),Hb=zd()});var zd=L((MO,Bb)=>{var ks=class{constructor(e,t){if(t=IE(t),e instanceof ks)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new ks(e.raw,t);if(e instanceof Bd)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(r=>this.parseRange(r)).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(i=>!Xb(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&$E(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let r=((this.options.includePrerelease&&ME)|(this.options.loose&&AE))+":"+e,i=Vb.get(r);if(i)return i;let s=this.options.loose,o=s?ln[Bt.HYPHENRANGELOOSE]:ln[Bt.HYPHENRANGE];e=e.replace(o,GE(this.options.includePrerelease)),Be("hyphen replace",e),e=e.replace(ln[Bt.COMPARATORTRIM],NE),Be("comparator trim",e),e=e.replace(ln[Bt.TILDETRIM],qE),Be("tilde trim",e),e=e.replace(ln[Bt.CARETTRIM],LE),Be("caret trim",e);let a=e.split(" ").map(h=>jE(h,this.options)).join(" ").split(/\s+/).map(h=>BE(h,this.options));s&&(a=a.filter(h=>(Be("loose invalid filter",h,this.options),!!h.match(ln[Bt.COMPARATORLOOSE])))),Be("range list",a);let c=new Map,u=a.map(h=>new Bd(h,this.options));for(let h of u){if(Xb(h))return[h];c.set(h.value,h)}c.size>1&&c.has("")&&c.delete("");let l=[...c.values()];return Vb.set(r,l),l}intersects(e,t){if(!(e instanceof ks))throw new TypeError("a Range is required");return this.set.some(r=>zb(r,t)&&e.set.some(i=>zb(i,t)&&r.every(s=>i.every(o=>s.intersects(o,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new OE(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(QE(this.set[t],e,this.options))return!0;return!1}};Bb.exports=ks;var FE=Cb(),Vb=new FE({max:1e3}),IE=zc(),Bd=Kb(),Be=Qo(),OE=Yo(),{safeRe:ln,t:Bt,comparatorTrimReplace:NE,tildeTrimReplace:qE,caretTrimReplace:LE}=Xc(),{FLAG_INCLUDE_PRERELEASE:ME,FLAG_LOOSE:AE}=Kc(),Xb=n=>n.value==="<0.0.0-0",$E=n=>n.value==="",zb=(n,e)=>{let t=!0,r=n.slice(),i=r.pop();for(;t&&r.length;)t=r.every(s=>i.intersects(s,e)),i=r.pop();return t},jE=(n,e)=>(Be("comp",n,e),n=UE(n,e),Be("caret",n),n=WE(n,e),Be("tildes",n),n=VE(n,e),Be("xrange",n),n=zE(n,e),Be("stars",n),n),Gt=n=>!n||n.toLowerCase()==="x"||n==="*",WE=(n,e)=>n.trim().split(/\s+/).map(t=>HE(t,e)).join(" "),HE=(n,e)=>{let t=e.loose?ln[Bt.TILDELOOSE]:ln[Bt.TILDE];return n.replace(t,(r,i,s,o,a)=>{Be("tilde",n,r,i,s,o,a);let c;return Gt(i)?c="":Gt(s)?c=`>=${i}.0.0 <${+i+1}.0.0-0`:Gt(o)?c=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:a?(Be("replaceTilde pr",a),c=`>=${i}.${s}.${o}-${a} <${i}.${+s+1}.0-0`):c=`>=${i}.${s}.${o} <${i}.${+s+1}.0-0`,Be("tilde return",c),c})},UE=(n,e)=>n.trim().split(/\s+/).map(t=>KE(t,e)).join(" "),KE=(n,e)=>{Be("caret",n,e);let t=e.loose?ln[Bt.CARETLOOSE]:ln[Bt.CARET],r=e.includePrerelease?"-0":"";return n.replace(t,(i,s,o,a,c)=>{Be("caret",n,i,s,o,a,c);let u;return Gt(s)?u="":Gt(o)?u=`>=${s}.0.0${r} <${+s+1}.0.0-0`:Gt(a)?s==="0"?u=`>=${s}.${o}.0${r} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.0${r} <${+s+1}.0.0-0`:c?(Be("replaceCaret pr",c),s==="0"?o==="0"?u=`>=${s}.${o}.${a}-${c} <${s}.${o}.${+a+1}-0`:u=`>=${s}.${o}.${a}-${c} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.${a}-${c} <${+s+1}.0.0-0`):(Be("no pr"),s==="0"?o==="0"?u=`>=${s}.${o}.${a}${r} <${s}.${o}.${+a+1}-0`:u=`>=${s}.${o}.${a}${r} <${s}.${+o+1}.0-0`:u=`>=${s}.${o}.${a} <${+s+1}.0.0-0`),Be("caret return",u),u})},VE=(n,e)=>(Be("replaceXRanges",n,e),n.split(/\s+/).map(t=>XE(t,e)).join(" ")),XE=(n,e)=>{n=n.trim();let t=e.loose?ln[Bt.XRANGELOOSE]:ln[Bt.XRANGE];return n.replace(t,(r,i,s,o,a,c)=>{Be("xRange",n,r,i,s,o,a,c);let u=Gt(s),l=u||Gt(o),h=l||Gt(a),f=h;return i==="="&&f&&(i=""),c=e.includePrerelease?"-0":"",u?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&f?(l&&(o=0),a=0,i===">"?(i=">=",l?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):i==="<="&&(i="<",l?s=+s+1:o=+o+1),i==="<"&&(c="-0"),r=`${i+s}.${o}.${a}${c}`):l?r=`>=${s}.0.0${c} <${+s+1}.0.0-0`:h&&(r=`>=${s}.${o}.0${c} <${s}.${+o+1}.0-0`),Be("xRange return",r),r})},zE=(n,e)=>(Be("replaceStars",n,e),n.trim().replace(ln[Bt.STAR],"")),BE=(n,e)=>(Be("replaceGTE0",n,e),n.trim().replace(ln[e.includePrerelease?Bt.GTE0PRE:Bt.GTE0],"")),GE=n=>(e,t,r,i,s,o,a,c,u,l,h,f,C)=>(Gt(r)?t="":Gt(i)?t=`>=${r}.0.0${n?"-0":""}`:Gt(s)?t=`>=${r}.${i}.0${n?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${n?"-0":""}`,Gt(u)?c="":Gt(l)?c=`<${+u+1}.0.0-0`:Gt(h)?c=`<${u}.${+l+1}.0-0`:f?c=`<=${u}.${l}.${h}-${f}`:n?c=`<${u}.${l}.${+h+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),QE=(n,e,t)=>{for(let r=0;r<n.length;r++)if(!n[r].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let r=0;r<n.length;r++)if(Be(n[r].semver),n[r].semver!==Bd.ANY&&n[r].semver.prerelease.length>0){let i=n[r].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var Qb=L((AO,Gb)=>{var YE=zd(),JE=(n,e,t)=>{try{e=new YE(e,t)}catch{return!1}return e.test(n)};Gb.exports=JE});var Jb=L(wn=>{"use strict";var ZE=wn&&wn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Gd=wn&&wn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ZE(e,n,t)};Object.defineProperty(wn,"__esModule",{value:!0});wn.DiagnosticPullMode=wn.vsdiag=void 0;Gd(ue(),wn);Gd(Pe(),wn);var Yb=nd();Object.defineProperty(wn,"vsdiag",{enumerable:!0,get:function(){return Yb.vsdiag}});Object.defineProperty(wn,"DiagnosticPullMode",{enumerable:!0,get:function(){return Yb.DiagnosticPullMode}});Gd(jd(),wn)});var nf=L(Qt=>{"use strict";var ex=Qt&&Qt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Zb=Qt&&Qt.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ex(e,n,t)};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.SettingMonitor=Qt.LanguageClient=Qt.TransportKind=void 0;var Nr=require("child_process"),Qd=require("fs"),Yd=require("path"),si=require("vscode"),Je=Rn(),eC=jd(),tx=zw(),ot=Wd(),nx=lb(),rx=Qb();Zb(Wd(),Qt);Zb(Jb(),Qt);var tC="^1.67.0",lt;(function(n){n[n.stdio=0]="stdio",n[n.ipc=1]="ipc",n[n.pipe=2]="pipe",n[n.socket=3]="socket"})(lt=Qt.TransportKind||(Qt.TransportKind={}));var oi;(function(n){function e(t){let r=t;return r&&r.kind===lt.socket&&Je.number(r.port)}n.isSocket=e})(oi||(oi={}));var Jd;(function(n){function e(t){return Je.string(t.command)}n.is=e})(Jd||(Jd={}));var Zd;(function(n){function e(t){return Je.string(t.module)}n.is=e})(Zd||(Zd={}));var ef;(function(n){function e(t){let r=t;return r&&r.writer!==void 0&&r.reader!==void 0}n.is=e})(ef||(ef={}));var tf;(function(n){function e(t){let r=t;return r&&r.process!==void 0&&typeof r.detached=="boolean"}n.is=e})(tf||(tf={}));var nC=class extends eC.BaseLanguageClient{constructor(e,t,r,i,s){let o,a,c,u,l;Je.string(t)?(o=e,a=t,c=r,u=i,l=!!s):(o=e.toLowerCase(),a=e,c=t,u=r,l=i),l===void 0&&(l=!1);super(o,a,u);this._serverOptions=c,this._forceDebug=l,this._isInDebugMode=l;try{this.checkVersion()}catch(h){throw Je.string(h.message)&&this.outputChannel.appendLine(h.message),h}}checkVersion(){let e=nx(si.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${si.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!rx(e,tC))throw new Error(`The language client requires VS Code version ${tC} but received version ${si.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(e=>setTimeout(e,1e3)),await this.start()):await this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let t=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(t),this._isDetached=void 0}})}checkProcessDied(e){!e||e.pid===void 0||setTimeout(()=>{try{e.pid!==void 0&&(process.kill(e.pid,0),(0,tx.terminate)(e))}catch{}},2e3)}handleConnectionClosed(){return this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(l,h){if(!l&&!h)return;let f=Object.create(null);return Object.keys(process.env).forEach(C=>f[C]=process.env[C]),h&&(f.ELECTRON_RUN_AS_NODE="1",f.ELECTRON_NO_ASAR="1"),l&&Object.keys(l).forEach(C=>f[C]=l[C]),f}let r=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],i=["--debug","--debug-brk","--inspect","--inspect-brk"];function s(){let l=process.execArgv;return l?l.some(h=>r.some(f=>h.startsWith(f))||i.some(f=>h===f)):!1}function o(l){if(l.stdin===null||l.stdout===null||l.stderr===null)throw new Error("Process created without stdio streams")}let a=this._serverOptions;if(Je.func(a))return a().then(l=>{if(eC.MessageTransports.is(l))return this._isDetached=!!l.detached,l;if(ef.is(l))return this._isDetached=!!l.detached,{reader:new ot.StreamMessageReader(l.reader),writer:new ot.StreamMessageWriter(l.writer)};{let h;return tf.is(l)?(h=l.process,this._isDetached=l.detached):(h=l,this._isDetached=!1),h.stderr.on("data",f=>this.outputChannel.append(Je.string(f)?f:f.toString(e))),{reader:new ot.StreamMessageReader(h.stdout),writer:new ot.StreamMessageWriter(h.stdin)}}});let c,u=a;return u.run||u.debug?this._forceDebug||s()?(c=u.debug,this._isInDebugMode=!0):(c=u.run,this._isInDebugMode=!1):c=a,this._getServerWorkingDir(c.options).then(l=>{if(Zd.is(c)&&c.module){let h=c,f=h.transport||lt.stdio;if(h.runtime){let C=[],b=h.options??Object.create(null);b.execArgv&&b.execArgv.forEach(v=>C.push(v)),C.push(h.module),h.args&&h.args.forEach(v=>C.push(v));let y=Object.create(null);y.cwd=l,y.env=t(b.env,!1);let S=this._getRuntimePath(h.runtime,l),R;if(f===lt.ipc?(y.stdio=[null,null,null,"ipc"],C.push("--node-ipc")):f===lt.stdio?C.push("--stdio"):f===lt.pipe?(R=(0,ot.generateRandomPipeName)(),C.push(`--pipe=${R}`)):oi.isSocket(f)&&C.push(`--socket=${f.port}`),C.push(`--clientProcessId=${process.pid.toString()}`),f===lt.ipc||f===lt.stdio){let v=Nr.spawn(S,C,y);return!v||!v.pid?Ps(v,`Launching server using runtime ${S} failed.`):(this._serverProcess=v,v.stderr.on("data",D=>this.outputChannel.append(Je.string(D)?D:D.toString(e))),f===lt.ipc?(v.stdout.on("data",D=>this.outputChannel.append(Je.string(D)?D:D.toString(e))),Promise.resolve({reader:new ot.IPCMessageReader(v),writer:new ot.IPCMessageWriter(v)})):Promise.resolve({reader:new ot.StreamMessageReader(v.stdout),writer:new ot.StreamMessageWriter(v.stdin)}))}else{if(f===lt.pipe)return(0,ot.createClientPipeTransport)(R).then(v=>{let D=Nr.spawn(S,C,y);return!D||!D.pid?Ps(D,`Launching server using runtime ${S} failed.`):(this._serverProcess=D,D.stderr.on("data",k=>this.outputChannel.append(Je.string(k)?k:k.toString(e))),D.stdout.on("data",k=>this.outputChannel.append(Je.string(k)?k:k.toString(e))),v.onConnected().then(k=>({reader:k[0],writer:k[1]})))});if(oi.isSocket(f))return(0,ot.createClientSocketTransport)(f.port).then(v=>{let D=Nr.spawn(S,C,y);return!D||!D.pid?Ps(D,`Launching server using runtime ${S} failed.`):(this._serverProcess=D,D.stderr.on("data",k=>this.outputChannel.append(Je.string(k)?k:k.toString(e))),D.stdout.on("data",k=>this.outputChannel.append(Je.string(k)?k:k.toString(e))),v.onConnected().then(k=>({reader:k[0],writer:k[1]})))})}}else{let C;return new Promise((b,y)=>{let S=(h.args&&h.args.slice())??[];f===lt.ipc?S.push("--node-ipc"):f===lt.stdio?S.push("--stdio"):f===lt.pipe?(C=(0,ot.generateRandomPipeName)(),S.push(`--pipe=${C}`)):oi.isSocket(f)&&S.push(`--socket=${f.port}`),S.push(`--clientProcessId=${process.pid.toString()}`);let R=h.options??Object.create(null);if(R.env=t(R.env,!0),R.execArgv=R.execArgv||[],R.cwd=l,R.silent=!0,f===lt.ipc||f===lt.stdio){let v=Nr.fork(h.module,S||[],R);o(v),this._serverProcess=v,v.stderr.on("data",D=>this.outputChannel.append(Je.string(D)?D:D.toString(e))),f===lt.ipc?(v.stdout.on("data",D=>this.outputChannel.append(Je.string(D)?D:D.toString(e))),b({reader:new ot.IPCMessageReader(this._serverProcess),writer:new ot.IPCMessageWriter(this._serverProcess)})):b({reader:new ot.StreamMessageReader(v.stdout),writer:new ot.StreamMessageWriter(v.stdin)})}else f===lt.pipe?(0,ot.createClientPipeTransport)(C).then(v=>{let D=Nr.fork(h.module,S||[],R);o(D),this._serverProcess=D,D.stderr.on("data",k=>this.outputChannel.append(Je.string(k)?k:k.toString(e))),D.stdout.on("data",k=>this.outputChannel.append(Je.string(k)?k:k.toString(e))),v.onConnected().then(k=>{b({reader:k[0],writer:k[1]})},y)},y):oi.isSocket(f)&&(0,ot.createClientSocketTransport)(f.port).then(v=>{let D=Nr.fork(h.module,S||[],R);o(D),this._serverProcess=D,D.stderr.on("data",k=>this.outputChannel.append(Je.string(k)?k:k.toString(e))),D.stdout.on("data",k=>this.outputChannel.append(Je.string(k)?k:k.toString(e))),v.onConnected().then(k=>{b({reader:k[0],writer:k[1]})},y)},y)})}}else if(Jd.is(c)&&c.command){let h=c,f=c.args!==void 0?c.args.slice(0):[],C,b=c.transport;if(b===lt.stdio)f.push("--stdio");else if(b===lt.pipe)C=(0,ot.generateRandomPipeName)(),f.push(`--pipe=${C}`);else if(oi.isSocket(b))f.push(`--socket=${b.port}`);else if(b===lt.ipc)throw new Error("Transport kind ipc is not support for command executable");let y=Object.assign({},h.options);if(y.cwd=y.cwd||l,b===void 0||b===lt.stdio){let S=Nr.spawn(h.command,f,y);return!S||!S.pid?Ps(S,`Launching server using command ${h.command} failed.`):(S.stderr.on("data",R=>this.outputChannel.append(Je.string(R)?R:R.toString(e))),this._serverProcess=S,this._isDetached=!!y.detached,Promise.resolve({reader:new ot.StreamMessageReader(S.stdout),writer:new ot.StreamMessageWriter(S.stdin)}))}else{if(b===lt.pipe)return(0,ot.createClientPipeTransport)(C).then(S=>{let R=Nr.spawn(h.command,f,y);return!R||!R.pid?Ps(R,`Launching server using command ${h.command} failed.`):(this._serverProcess=R,this._isDetached=!!y.detached,R.stderr.on("data",v=>this.outputChannel.append(Je.string(v)?v:v.toString(e))),R.stdout.on("data",v=>this.outputChannel.append(Je.string(v)?v:v.toString(e))),S.onConnected().then(v=>({reader:v[0],writer:v[1]})))});if(oi.isSocket(b))return(0,ot.createClientSocketTransport)(b.port).then(S=>{let R=Nr.spawn(h.command,f,y);return!R||!R.pid?Ps(R,`Launching server using command ${h.command} failed.`):(this._serverProcess=R,this._isDetached=!!y.detached,R.stderr.on("data",v=>this.outputChannel.append(Je.string(v)?v:v.toString(e))),R.stdout.on("data",v=>this.outputChannel.append(Je.string(v)?v:v.toString(e))),S.onConnected().then(v=>({reader:v[0],writer:v[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(a,null,4)))})}_getRuntimePath(e,t){if(Yd.isAbsolute(e))return e;let r=this._mainGetRootPath();if(r!==void 0){let i=Yd.join(r,e);if(Qd.existsSync(i))return i}if(t!==void 0){let i=Yd.join(t,e);if(Qd.existsSync(i))return i}return e}_mainGetRootPath(){let e=si.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(r=>{Qd.lstat(t,(i,s)=>{r(!i&&s.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}};Qt.LanguageClient=nC;var rC=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return si.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new si.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,r=e>=0?this._setting.substr(e+1):void 0,i=r?si.workspace.getConfiguration(t).get(r,!1):si.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start().catch(s=>this._client.error("Start failed after configuration change",s,"force")):!i&&this._client.needsStop()&&this._client.stop().catch(s=>this._client.error("Stop failed after configuration change",s,"force"))}};Qt.SettingMonitor=rC;function Ps(n,e){return n===null?Promise.reject(e):new Promise((t,r)=>{n.on("error",i=>{r(`${e} ${i}`)}),setImmediate(()=>r(e))})}});var rf=L((WO,iC)=>{"use strict";iC.exports=nf()});var Fx={};jC(Fx,{activate:()=>Ex,deactivate:()=>xx});var ai=G(require("vscode"));var Q=G(require("vscode")),Es=G(require("fs/promises")),CC=G(require("path"));var Le=G(require("vscode")),HC={get lsp(){return{get serverPath(){return Le.workspace.getConfiguration("swift.sourcekit-lsp").get("serverPath","")},get serverArguments(){return Le.workspace.getConfiguration("swift.sourcekit-lsp").get("serverArguments",[])},get inlayHintsEnabled(){return Le.workspace.getConfiguration("sourcekit-lsp").get("inlayHints.enabled",!0)},get supportCFamily(){return Le.workspace.getConfiguration("sourcekit-lsp").get("support-c-cpp","cpptools-inactive")},get supportedLanguages(){return Le.workspace.getConfiguration("swift.sourcekit-lsp").get("supported-languages",["swift","c","cpp","objective-c","objective-cpp"])},get disable(){return Le.workspace.getConfiguration("swift.sourcekit-lsp").get("disable",!1)}}},folder(n){return{get testEnvironmentVariables(){return Le.workspace.getConfiguration("swift",n).get("testEnvironmentVariables",{})},get autoGenerateLaunchConfigurations(){return Le.workspace.getConfiguration("swift",n).get("autoGenerateLaunchConfigurations",!0)},get disableAutoResolve(){return Le.workspace.getConfiguration("swift",n).get("disableAutoResolve",!1)},get searchSubfoldersForPackages(){return Le.workspace.getConfiguration("swift",n).get("searchSubfoldersForPackages",!1)}}},get excludePathsFromPackageDependencies(){return Le.workspace.getConfiguration("swift").get("excludePathsFromPackageDependencies",[])},get path(){return Le.workspace.getConfiguration("swift").get("path","")},get runtimePath(){return Le.workspace.getConfiguration("swift").get("runtimePath","")},get sdk(){return Le.workspace.getConfiguration("swift").get("SDK","")},set sdk(n){Le.workspace.getConfiguration("swift").update("SDK",n)},get buildArguments(){return Le.workspace.getConfiguration("swift").get("buildArguments",[])},get sanitizer(){return Le.workspace.getConfiguration("swift").get("sanitizer","off")},get buildPath(){return Le.workspace.getConfiguration("swift").get("buildPath","")},get swiftEnvironmentVariables(){return Le.workspace.getConfiguration("swift").get("swiftEnvironmentVariables",{})},set swiftEnvironmentVariables(n){Le.workspace.getConfiguration("swift").update("swiftEnvironmentVariables",n)},get problemMatchCompileErrors(){return Le.workspace.getConfiguration("swift").get("problemMatchCompileErrors",!0)},get backgroundCompilation(){return Le.workspace.getConfiguration("swift").get("backgroundCompilation",!1)},get diagnostics(){return Le.workspace.getConfiguration("swift").get("diagnostics",!1)},get displayCoverageReportAfterRun(){return Le.workspace.getConfiguration("swift").get("coverage.displayReportAfterRun",!0)},get alwaysShowCoverageStatusItem(){return Le.workspace.getConfiguration("swift").get("coverage.alwaysShowStatusItem",!0)},get coverageHitColorLightMode(){return Le.workspace.getConfiguration("swift").get("coverage.colors.lightMode.hit","#c0ffc0")},get coverageMissColorLightMode(){return Le.workspace.getConfiguration("swift").get("coverage.colors.lightMode.miss","#ffc0c0")},get coverageHitColorDarkMode(){return Le.workspace.getConfiguration("swift").get("coverage.colors.darkMode.hit","#003000")},get coverageMissColorDarkMode(){return Le.workspace.getConfiguration("swift").get("coverage.colors.darkMode.miss","#400000")}},W=HC;var be=G(require("vscode")),hf=G(require("path"));var Np=G(require("vscode")),Ji=G(require("path"));var ca=G(require("vscode"));var iu=G(require("child_process")),kf=G(require("fs/promises")),Os=G(require("path"));function Ut(n=process.env){if(W.runtimePath==="")return;let e=W.runtimePath,t=Ns(),r=process.platform==="win32"?";":":";switch(n){case!1:return{[t]:e};case!0:return{[t]:`${e}${r}\${env:${t}}`};default:return n[t]?{[t]:`${e}${r}${n[t]}`}:{[t]:e}}}function Ns(){switch(process.platform){case"win32":return"Path";case"darwin":return"DYLD_LIBRARY_PATH";default:return"LD_LIBRARY_PATH"}}async function pn(n,e,t={},r,i=!0){if(r==null||r.workspaceContext.outputChannel.logDiagnostic(`Exec: ${n} ${e.join(" ")}`,r.name),i){let s=Ut(t.env);s&&Object.keys(s).length>0&&(t.env=le(le({},t.env??process.env),s))}return new Promise((s,o)=>iu.execFile(n,e,t,(a,c,u)=>{a&&o({error:a,stdout:c,stderr:u}),s({stdout:c,stderr:u})}))}async function qs(n,e,t,r,i,s={},o,a=!0,c="SIGTERM"){if(o==null||o.workspaceContext.outputChannel.logDiagnostic(`Exec: ${n} ${e.join(" ")}`,o.name),a){let u=Ut(s.env);u&&Object.keys(u).length>0&&(s.env=le(le({},s.env??process.env),u))}return new Promise((u,l)=>{var C,b;let h,f=iu.execFile(n,e,s,y=>{y?l({error:y}):u(),h&&h.dispose()});t&&((C=f.stdout)==null||C.pipe(t)),r&&((b=f.stderr)==null||b.pipe(r)),i&&(h=i.onCancellationRequested(()=>{f.kill(c)}))})}async function er(n,e,t={},r){let i;return e==="default"?i=KC():i=e.getToolchainExecutable("swift"),e!=="default"&&(n=e.buildFlags.withSwiftSDKFlags(n)),Object.keys(W.swiftEnvironmentVariables).length>0&&(t.env=le(le({},t.env??process.env),W.swiftEnvironmentVariables)),await pn(i,n,t,r)}async function Pf(n,e){for(;!n();)await UC(e)}function UC(n){return new Promise(e=>setTimeout(e,n))}function KC(n="swift"){let e=process.platform==="win32"?".exe":"";return Os.join(W.path,`${n}${e}`)}async function Kr(...n){try{return await kf.access(Os.join(...n)),!0}catch{return!1}}function Dn(n,e){let t=Os.relative(e,n);return t[0]!=="."||t[1]!=="."}function su(n=8){return Math.random().toString(16).substring(2,n)}function Nn(n){return n.stderr?n.stderr:n.error?JSON.stringify(n.error):n instanceof Error?n.message:JSON.stringify(n)}function _f(n){return n.length===1?n[0]:[n.slice(0,-1).join(", "),n[n.length-1]].join(" and ")}function Ef(n,e=0){let t=3735928559^e,r=1103547991^e;for(let i=0,s;i<n.length;i++)s=n.charCodeAt(i),t=Math.imul(t^s,2654435761),r=Math.imul(r^s,1597334677);return t=Math.imul(t^t>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507)^Math.imul(t^t>>>13,3266489909),4294967296*(2097151&r)+(t>>>0)}var Ls=class{constructor(e,t){this.exists=t;this.fileWatcher=ca.workspace.createFileSystemWatcher(new ca.RelativePattern(e,"Tests/LinuxMain.swift"),!1,!0),this.fileWatcher.onDidCreate(()=>this.exists=!0),this.fileWatcher.onDidDelete(()=>this.exists=!1)}static async create(e){let t=await Kr(e.fsPath,"Tests","LinuxMain.swift");return new Ls(e,t)}dispose(){var e;(e=this.fileWatcher)==null||e.dispose()}};var Ai=G(require("vscode"));var ou=class{constructor(e,t){this.folderContext=e;this.workspaceContext=t}install(){this.packageFileWatcher=this.createPackageFileWatcher(),this.resolvedFileWatcher=this.createResolvedFileWatcher()}dispose(){var e,t;(e=this.packageFileWatcher)==null||e.dispose(),(t=this.resolvedFileWatcher)==null||t.dispose()}createPackageFileWatcher(){let e=Ai.workspace.createFileSystemWatcher(new Ai.RelativePattern(this.folderContext.folder,"Package.swift"));return e.onDidCreate(async()=>await this.handlePackageSwiftChange()),e.onDidChange(async()=>await this.handlePackageSwiftChange()),e.onDidDelete(async()=>await this.handlePackageSwiftChange()),e}createResolvedFileWatcher(){let e=Ai.workspace.createFileSystemWatcher(new Ai.RelativePattern(this.folderContext.folder,"Package.resolved"));return e.onDidCreate(async()=>await this.handlePackageResolvedChange()),e.onDidChange(async()=>await this.handlePackageResolvedChange()),e.onDidDelete(async()=>await this.handlePackageResolvedChange()),e}async handlePackageSwiftChange(){await this.folderContext.reload(),this.workspaceContext.fireEvent(this.folderContext,ye.packageUpdated)}async handlePackageResolvedChange(){var t,r;let e=(t=this.folderContext.swiftPackage.resolved)==null?void 0:t.fileHash;await this.folderContext.reloadPackageResolved(),((r=this.folderContext.swiftPackage.resolved)==null?void 0:r.fileHash)!==e&&this.workspaceContext.fireEvent(this.folderContext,ye.resolvedUpdated)}};var ba=G(require("vscode")),_u=G(require("fs/promises")),Ca=G(require("path"));var wa=G(require("path"));var ya=G(require("fs/promises")),Qe=G(require("path")),yp=G(mp()),Pu=G(require("vscode"));var He=class{constructor(e,t,r){this.major=e;this.minor=t;this.patch=r}static fromString(e){let t=e.match(/(\d+).(\d+)(?:.(\d+))?/);if(t){let r=parseInt(t[1]),i=parseInt(t[2]);if(t[3]===void 0)return new He(r,i,0);{let s=parseInt(t[3]);return new He(r,i,s)}}}toString(){return`${this.major}.${this.minor}.${this.patch}`}isLessThan(e){return this.major<e.major?!0:this.major>e.major?!1:this.minor<e.minor?!0:this.minor>e.minor?!1:this.patch<e.patch}isGreaterThan(e){return this.major>e.major?!0:this.major<e.major?!1:this.minor>e.minor?!0:this.minor<e.minor?!1:this.patch>e.patch}isLessThanOrEqual(e){return!this.isGreaterThan(e)}isGreaterThanOrEqual(e){return!this.isLessThan(e)}};var vp=G(require("path")),oo=class{constructor(e,t){this.type=e;this.toolchain=t}static create(e,t){if(e==="thread"||e==="address")return new oo(e,t)}get runtimeEnvironment(){if(!this.toolchain.toolchainPath)return;let e=`/usr/lib/swift/clang/lib/darwin/libclang_rt.${this.clangName}_osx_dynamic.dylib`;return{DYLD_INSERT_LIBRARIES:vp.join(this.toolchain.toolchainPath,e)}}get buildFlags(){return[`--sanitize=${this.type}`]}get clangName(){switch(this.type){case"address":return"asan";case"thread":return"tsan"}}};var wr=(r=>(r.iOS="iOS",r.tvOS="tvOS",r.watchOS="watchOS",r))(wr||{});function SD(n){switch(n){case"iOS":return"iphoneos";case"tvOS":return"appletvos";case"watchOS":return"watchos"}}function wp(n){switch(n){case"iOS":return"arm64-apple-ios";case"tvOS":return"arm64-apple-tvos";case"watchOS":return"arm64-apple-watchos"}}var br=class{constructor(e,t,r,i,s,o,a,c,u){this.swiftFolderPath=e;this.toolchainPath=t;this.swiftVersionString=r;this.swiftVersion=i;this.runtimePath=s;this.defaultTarget=o;this.defaultSDK=a;this.customSDK=c;this.xcTestPath=u}static async create(){var u;let e=await this.getSwiftFolderPath(),t=await this.getToolchainPath(e),r=await this.getSwiftTargetInfo(),i=await this.getSwiftVersion(r),s=await this.getRuntimePath(r),o=await this.getDefaultSDK(),a=this.getCustomSDK(),c=await this.getXCTestPath(r,i,s,a??o);return new br(e,t,r.compilerVersion,i,s,(u=r.target)==null?void 0:u.triple,o,a,c)}get buildFlags(){return new Rt(this)}sanitizer(e){return oo.create(e,this)}static async getXcodeDeveloperDir(e){let{stdout:t}=await pn("xcode-select",["-p"],{env:e});return t.trimEnd()}static async getSDKForTarget(e){return await this.getSDKPath(SD(e))}static async getSDKPath(e){let{stdout:t}=await pn("xcrun",["--sdk",e,"--show-sdk-path"],{env:le(le({},process.env),W.swiftEnvironmentVariables)});return Qe.join(t.trimEnd())}static async getXcodeInstalls(){let{stdout:e}=await pn("mdfind",["kMDItemCFBundleIdentifier == 'com.apple.dt.Xcode'"]);return e.trimEnd().split(`
`)}getToolchainExecutable(e){let t=process.platform==="win32"?".exe":"";return`${this.toolchainPath}/usr/bin/${e}${t}`}logDiagnostics(e){e.logDiagnostic(`Swift Path: ${this.swiftFolderPath}`),e.logDiagnostic(`Toolchain Path: ${this.toolchainPath}`),this.runtimePath&&e.logDiagnostic(`Runtime Library Path: ${this.runtimePath}`),this.defaultTarget&&e.logDiagnostic(`Default Target: ${this.defaultTarget}`),this.defaultSDK&&e.logDiagnostic(`Default SDK: ${this.defaultSDK}`),this.customSDK&&e.logDiagnostic(`Custom SDK: ${this.customSDK}`),this.xcTestPath&&e.logDiagnostic(`XCTest Path: ${this.xcTestPath}`)}static async getSwiftFolderPath(){try{let e;if(W.path!==""){let i=process.platform==="win32"?".exe":"";e=Qe.join(W.path,`swift${i}`)}else switch(process.platform){case"darwin":{let{stdout:i}=await pn("which",["swift"]);e=i.trimEnd();break}case"win32":{let{stdout:i}=await pn("where",["swift"]);e=i.trimEnd();break}default:{let{stdout:i}=await pn("/bin/sh",["-c","LCMESSAGES=C type swift"]),s=/^swift is (.*)$/.exec(i.trimEnd());if(s)e=s[1];else throw Error("Failed to find swift executable");break}}let t=await ya.realpath(e),r=Qe.dirname(t);return await this.getSwiftEnvPath(r)}catch{throw Error("Failed to find swift executable")}}static async getSwiftEnvPath(e){if(process.platform==="linux"&&e.endsWith(".swiftenv/shims"))try{let t=Qe.dirname(e),r=Qe.join(t,"libexec","swiftenv"),{stdout:i}=await pn(r,["which","swift"]),s=i.trimEnd();return Qe.dirname(s)}catch{return e}else return e}static async getToolchainPath(e){try{switch(process.platform){case"darwin":{if(W.path!=="")return Qe.dirname(Qe.dirname(W.path));let{stdout:t}=await pn("xcrun",["--find","swift"],{env:W.swiftEnvironmentVariables}),r=t.trimEnd();return Qe.dirname(Qe.dirname(Qe.dirname(r)))}default:return Qe.dirname(Qe.dirname(e))}}catch{throw Error("Failed to find swift toolchain")}}static async getRuntimePath(e){if(W.runtimePath!=="")return W.runtimePath;if(process.platform==="win32"){let{stdout:t}=await pn("where",["swiftCore.dll"]),r=t.trimEnd();return r.length>0?Qe.dirname(r):void 0}else return e.paths.runtimeLibraryPaths.length>0?e.paths.runtimeLibraryPaths.join(":"):void 0}static async getDefaultSDK(){switch(process.platform){case"darwin":return process.env.SDKROOT?process.env.SDKROOT:this.getSDKPath("macosx");case"win32":return process.env.SDKROOT}}static getCustomSDK(){return W.sdk!==""?W.sdk:void 0}static async getXCTestPath(e,t,r,i){var s;switch(process.platform){case"darwin":{let o=await this.getXcodeDeveloperDir(W.swiftEnvironmentVariables);return Qe.join(o,"usr","bin")}case"win32":{let o=r!==void 0&&await Kr(Qe.join(r,"XCTest.dll"))?r:void 0;if(!i)return o;let a=Qe.dirname(Qe.dirname(Qe.dirname(i))),c=Qe.join(a,"Info.plist");if(await Kr(c)!==!0){if(o)return o;Pu.window.showWarningMessage("XCTest not found due to non-standardized library layout. Tests explorer won't work as expected.");return}let u=await ya.readFile(c,"utf8"),l;try{l=yp.parse(u)}catch(f){Pu.window.showWarningMessage(`Unable to parse ${c}: ${f}`);return}let h=l.DefaultProperties.XCTEST_VERSION;if(!h)throw Error("Info.plist is missing the XCTEST_VERSION key.");if(t>=new He(5,7,0)){let f,C=(s=e.target)==null?void 0:s.triple.split("-",1)[0];switch(C){case"x86_64":f="bin64";break;case"i686":f="bin32";break;case"aarch64":f="bin64a";break;default:throw Error(`unsupported architecture ${C}`)}return Qe.join(a,"Developer","Library",`XCTest-${h}`,"usr",f)}else return Qe.join(a,"Developer","Library",`XCTest-${h}`,"usr","bin")}}}static async getSwiftTargetInfo(){try{try{let{stdout:t}=await er(["-print-target-info"],"default"),r=JSON.parse(t.trimEnd());if(r.compilerVersion)return r}catch{}let{stdout:e}=await er(["--version"],"default");return{compilerVersion:e.split(`
`,1)[0],paths:{runtimeLibraryPaths:[""]}}}catch{throw Error("Failed to get swift version from either '-print-target-info' or '--version'.")}}static getSwiftVersion(e){let t=e.compilerVersion.match(/Swift version ([\S]+)/),r;return t&&(r=He.fromString(t[1])),r??new He(0,0,0)}};var Rt=class{constructor(e){this.toolchain=e}withSwiftSDKFlags(e){switch(e[0]){case"package":{let t=e.splice(0,2).concat(this.buildPathFlags());switch(t[1]){case"dump-symbol-graph":case"diagnose-api-breaking-changes":case"resolve":return[...t,...this.swiftpmSDKFlags(),...e];default:return t.concat(e)}}case"build":case"run":case"test":return[...e.splice(0,1).concat(this.buildPathFlags()),...this.swiftpmSDKFlags(),...e];default:return e}}swiftpmSDKFlags(){return W.sdk!==""?["--sdk",W.sdk,...this.swiftDriverTargetFlags(!0)]:[]}buildPathFlags(){return W.buildPath&&W.buildPath.length>0?this.toolchain.swiftVersion<new He(5,8,0)?["--build-path",W.buildPath]:["--scratch-path",W.buildPath]:[]}static buildDirectoryFromWorkspacePath(e,t=!1){let r=W.buildPath.length>0?W.buildPath:".build";return!wa.isAbsolute(r)&&t?wa.join(e,r):r}swiftDriverSDKFlags(e=!1){if(W.sdk==="")return[];let t=["-sdk",W.sdk];return e?t.flatMap(r=>["-Xswiftc",r]):t}getDarwinTarget(){let e=[{name:"iPhoneOS",target:wr.iOS},{name:"AppleTVOS",target:wr.tvOS},{name:"WatchOS",target:wr.watchOS}];if(W.sdk===""||process.platform!=="darwin")return;let t=W.sdk.split("/"),r=t[t.length-1];for(let i of e)if(r.includes(i.name)){let s=r.substring(i.name.length,r.length-4);return Mi(le({},i),{version:s})}}swiftDriverTargetFlags(e=!1){let t=this.getDarwinTarget();if(!t)return[];let r=["-target",`${wp(t.target)}${t.version}`];return e?r.flatMap(i=>["-Xswiftc",i]):r}static filterArguments(e,t){let r=[],i=0;for(let s of e){if(i>0){r.push(s),i-=1;continue}let o=t.find(c=>c.argument===s);if(o){r.push(s),i=o.include;continue}t.find(c=>c.include===1&&s.startsWith(c.argument+"="))&&r.push(s)}return r}};var bp=class{constructor(e){let t=JSON.parse(e),r=t;if(this.version=r.version,this.fileHash=Ef(e),this.version===1){let i=t;this.pins=i.object.pins.map(s=>new Eu(this.identity(s.repositoryURL),s.repositoryURL,s.state))}else if(this.version===2){let i=t;this.pins=i.pins.map(s=>new Eu(s.identity,s.location,s.state))}else throw Error("Unsupported Package.resolved version")}identity(e){return Ca.basename(e,".git").toLowerCase()}},Eu=class{constructor(e,t,r){this.identity=e;this.location=t;this.state=r}};function RD(n){return n.products!==void 0}function kD(n){return n instanceof Error}var Sn=class{constructor(e,t,r){this.folder=e;this.contents=t;this.resolved=r;this.plugins=[]}static async create(e,t){let r=await Sn.loadPackage(e,t),i=await Sn.loadPackageResolved(e);return new Sn(e,r,i)}static async loadPackage(e,t){try{let{stdout:r}=await er(["package","describe","--type","json"],t,{cwd:e.fsPath});for(;!r.startsWith("{");){let i=r.indexOf(`
`);r=r.slice(i+1)}return JSON.parse(r)}catch(r){let i=r;return i.stderr!==void 0&&(i.stderr.startsWith("error: root manifest")||i.stderr.startsWith("error: Could not find Package.swift"))?void 0:Error(Nn(r))}}static async loadPackageResolved(e){try{let t=ba.Uri.joinPath(e,"Package.resolved"),r=await _u.readFile(t.fsPath,"utf8");return new bp(r)}catch{return}}static async loadPlugins(e,t){try{let{stdout:r}=await er(["package","plugin","--list"],t,{cwd:e.fsPath}),i=[],s=r.split(`
`).map(o=>o.trim());for(let o of s){let a=/^‘(.*)’ \(plugin ‘(.*)’ in package ‘(.*)’\)/.exec(o);a&&i.push({command:a[1],name:a[2],package:a[3]})}return i}catch{return[]}}async loadWorkspaceState(){try{let e=ba.Uri.joinPath(ba.Uri.file(Rt.buildDirectoryFromWorkspacePath(this.folder.fsPath,!0)),"workspace-state.json"),t=await _u.readFile(e.fsPath,"utf8");return JSON.parse(t)}catch{return}}async reload(e){this.contents=await Sn.loadPackage(this.folder,e)}async reloadPackageResolved(){this.resolved=await Sn.loadPackageResolved(this.folder)}get isValid(){return RD(this.contents)}get error(){if(kD(this.contents))return this.contents}get foundPackage(){return this.contents!==void 0}get name(){var e;return((e=this.contents)==null?void 0:e.name)??""}get products(){var e;return((e=this.contents)==null?void 0:e.products)??[]}get dependencies(){var e;return((e=this.contents)==null?void 0:e.dependencies)??[]}get targets(){var e;return((e=this.contents)==null?void 0:e.targets)??[]}get executableProducts(){return this.products.filter(e=>e.type.executable!==void 0)}get libraryProducts(){return this.products.filter(e=>e.type.library!==void 0)}getTargets(e){return this.targets.filter(t=>t.type===e)}getTarget(e){let t=Ca.relative(this.folder.fsPath,e);return this.targets.find(r=>Dn(t,r.path))}};var _a=G(require("vscode"));var at=G(require("vscode")),ka=G(require("path")),Ou=G(require("stream"));var Cp=G(require("os")),Ln=G(require("vscode"));async function Gi(n,e=!1){if(!W.folder(n.workspaceFolder).autoGenerateLaunchConfigurations)return;let t=Ln.workspace.getConfiguration("launch",n.folder),r=t.get("configurations")||[],i=["program","cwd","preLaunchTask",`env.${Ns()}`],s=[],o=PD(n),a=!1;for(let c of o){let u=r.findIndex(l=>l.name===c.name);if(u!==-1){let l=JSON.parse(JSON.stringify(r[u]));_D(l,c,i),JSON.stringify(r[u])!==JSON.stringify(l)&&s.push({index:u,config:l})}else r.push(c),a=!0}if(s.length>0){if(!e){let c=_f(s.map(l=>l.config.name));await Ln.window.showWarningMessage(`${n.name}: The Swift extension would like to update launch configurations '${c}'. Do you want to update?`,"Update","Cancel")==="Update"&&(e=!0)}e&&(s.forEach(c=>r[c.index]=c.config),a=!0)}a&&await t.update("configurations",r,Ln.ConfigurationTarget.WorkspaceFolder)}function Dp(n,e){let r=Ln.workspace.getConfiguration("launch",e.folder).get("configurations")||[],{folder:i}=ao(e),s=Rt.buildDirectoryFromWorkspacePath(i,!0);return r.find(o=>o.program===`${s}/debug/`+n)}function PD(n){let e=n.swiftPackage.executableProducts,{folder:t,nameSuffix:r}=ao(n),i=Rt.buildDirectoryFromWorkspacePath(t,!0);return e.flatMap(s=>[{type:"lldb",request:"launch",sourceLanguages:["swift"],name:`Debug ${s.name}${r}`,program:`${i}/debug/`+s.name,args:[],cwd:t,preLaunchTask:`swift: Build Debug ${s.name}${r}`,env:Ut(!0)},{type:"lldb",request:"launch",sourceLanguages:["swift"],name:`Release ${s.name}${r}`,program:`${i}/release/`+s.name,args:[],cwd:t,preLaunchTask:`swift: Build Release ${s.name}${r}`,env:Ut(!0)}])}function Tp(n,e){let{folder:t}=ao(e),r=Rt.buildDirectoryFromWorkspacePath(t,!0);return{type:"lldb",request:"launch",sourceLanguages:["swift"],name:`Run ${n}`,program:`${r}/debug/${n}`,args:[],cwd:t,env:Ut(!0)}}function xu(n,e=!1){var o;if(n.swiftPackage.getTargets("test").length===0)return null;let t=le(le({},Ut()),W.folder(n.workspaceFolder).testEnvironmentVariables),{folder:r,nameSuffix:i}=ao(n,e),s=Rt.buildDirectoryFromWorkspacePath(r,!0);if(process.platform==="darwin"){let a=n.workspaceContext.toolchain.xcTestPath;if(a===void 0)return null;let c=n.workspaceContext.toolchain.sanitizer(W.sanitizer),u=le(le({},t),c==null?void 0:c.runtimeEnvironment);return{type:"lldb",request:"launch",sourceLanguages:["swift"],name:`Test ${n.swiftPackage.name}`,program:`${a}/xctest`,args:[`${s}/debug/${n.swiftPackage.name}PackageTests.xctest`],cwd:r,env:u,preLaunchTask:`swift: Build All${i}`}}else if(process.platform==="win32"){let a=n.workspaceContext.toolchain.runtimePath,c=n.workspaceContext.toolchain.xcTestPath;if(c===void 0)return null;c!==a&&(t.Path=`${c};${t.Path??process.env.Path}`);let u=W.sdk===""?process.env.SDKROOT:W.sdk;if(u===void 0)return null;let l;return((o=Ln.workspace.getConfiguration("lldb"))==null?void 0:o.get("library"))&&(l=[`settings set target.sdk-path ${u}`]),{type:"lldb",request:"launch",sourceLanguages:["swift"],name:`Test ${n.swiftPackage.name}`,program:`${s}/debug/${n.swiftPackage.name}PackageTests.xctest`,cwd:r,env:t,preRunCommands:l,preLaunchTask:`swift: Build All${i}`}}else return{type:"lldb",request:"launch",sourceLanguages:["swift"],name:`Test ${n.swiftPackage.name}`,program:`${s}/debug/${n.swiftPackage.name}PackageTests.xctest`,cwd:r,env:t,preLaunchTask:`swift: Build All${i}`}}function Sp(n,e){if(n.swiftPackage.getTargets("test").length===0||process.platform!=="darwin")return null;let{folder:t,nameSuffix:r}=ao(n,!0),i=Rt.buildDirectoryFromWorkspacePath(t,!0),s=n.workspaceContext.toolchain.xcTestPath;if(s===void 0)return null;let o;switch(Cp.arch()){case"x64":o="x86_64";break;case"arm64":o="arm64e";break;default:return null}let a=n.workspaceContext.toolchain.sanitizer(W.sanitizer),c=Object.entries(le(le(le({},Ut()),W.folder(n.workspaceFolder).testEnvironmentVariables),a==null?void 0:a.runtimeEnvironment)).map(([u,l])=>`settings set target.env-vars ${u}="${l}"`);return{type:"lldb",request:"custom",sourceLanguages:["swift"],name:`Test ${n.swiftPackage.name}`,targetCreateCommands:[`file -a ${o} ${s}/xctest`],processCreateCommands:[...c,`process launch -w ${t} -- ${e} ${i}/debug/${n.swiftPackage.name}PackageTests.xctest`],preLaunchTask:`swift: Build All${r}`}}async function Da(n,e,t={}){return new Promise((r,i)=>{Ln.debug.startDebugging(n,e,t).then(s=>{if(s){let o=Ln.debug.onDidTerminateDebugSession(async()=>{o.dispose(),r()})}},s=>{i(s)})})}function _D(n,e,t){t.forEach(r=>{if(r.includes(".")){let[i,s]=r.split(".",2);if(n[i]===void 0)n[i]=e[i];else if(e[i]===void 0){let o=Object.keys(n[i]);o.length===1&&o[0]===s?n[i]=void 0:n[i][s]=void 0}else n[i][s]=e[i][s]}else n[r]=e[r]})}function ao(n,e=!1){let t=e?n.workspaceFolder.uri.fsPath:`\${workspaceFolder:${n.workspaceFolder.name}}`,r,i;return n.relativePath.length===0?(r=t,i=""):(r=`${t}/${n.relativePath}`,i=` (${n.relativePath})`),{folder:r,nameSuffix:i}}var Ue=G(require("vscode")),Ta=G(require("path"));function xD(n){if(n.workspaceContext.swiftVersion.isLessThan(new He(5,1,0)))return[];if(process.platform!=="darwin"){let e=n.linuxMain.exists,t=n.workspaceContext.swiftVersion.isGreaterThanOrEqual(new He(5,4,0));if(e||!t)return["--enable-test-discovery"]}return[]}function FD(n){return process.platform==="win32"?n.swiftVersion.isGreaterThanOrEqual(new He(5,9,0))?["-Xlinker","-debug:dwarf"]:["-Xswiftc","-g","-Xswiftc","-use-ld=lld","-Xlinker","-debug:dwarf"]:[]}function Sa(n,e=!0){let t=[];e&&t.push(...FD(n));let r=n.sanitizer(W.sanitizer);return r&&t.push(...r.buildFlags),t.push(...W.buildArguments),t}function ID(n){let e=Sa(n.workspaceContext.toolchain);n.swiftPackage.getTargets("test").length>0&&e.push(...xD(n));let t=an.buildAllName;return n.relativePath.length>0&&(t+=` (${n.relativePath})`),n.workspaceContext.toolchain.buildFlags.getDarwinTarget()===void 0&&(e=["--build-tests",...e]),on(["build",...e],t,{group:Ue.TaskGroup.Build,cwd:n.folder,scope:n.workspaceFolder,presentationOptions:{reveal:Ue.TaskRevealKind.Silent},problemMatcher:W.problemMatchCompileErrors?"$swiftc":void 0,disableTaskQueue:!0},n.workspaceContext.toolchain)}async function Qi(n){let e=an.buildAllName;n.relativePath.length>0&&(e+=` (${n.relativePath})`);let t=n.workspaceFolder.uri.fsPath,r=(await Ue.tasks.fetchTasks()).filter(o=>{if(o.source!=="Workspace"||o.scope!==n.workspaceFolder)return!1;let a=o.execution.options,c=o.execution.options,u=(a==null?void 0:a.cwd)??(c==null?void 0:c.cwd);return(u==="${workspaceFolder}"||u===void 0)&&(u=t),u===n.folder.fsPath}),i=r.find(o=>{var a,c;return((a=o.group)==null?void 0:a.id)===Ue.TaskGroup.Build.id&&((c=o.group)==null?void 0:c.isDefault)===!0});if(i||(i=r.find(o=>o.name===`swift: ${e}`),i))return i;if(i=(await Ue.tasks.fetchTasks({type:"swift"})).find(o=>{var a;return o.name===e&&((a=o.execution.options)==null?void 0:a.cwd)===n.folder.fsPath&&o.source==="swift"}),!i)throw Error("Build All Task does not exist");return i}function OD(n,e){let t=e.workspaceContext.toolchain,r="";return e.relativePath.length>0&&(r=` (${e.relativePath})`),[on(["build","--product",n.name,...Sa(t)],`Build Debug ${n.name}${r}`,{group:Ue.TaskGroup.Build,cwd:e.folder,scope:e.workspaceFolder,presentationOptions:{reveal:Ue.TaskRevealKind.Silent},problemMatcher:W.problemMatchCompileErrors?"$swiftc":void 0,disableTaskQueue:!0},e.workspaceContext.toolchain),on(["build","-c","release","--product",n.name,...W.buildArguments],`Build Release ${n.name}${r}`,{group:Ue.TaskGroup.Build,cwd:e.folder,scope:e.workspaceFolder,presentationOptions:{reveal:Ue.TaskRevealKind.Silent},problemMatcher:W.problemMatchCompileErrors?"$swiftc":void 0,disableTaskQueue:!0},e.workspaceContext.toolchain)]}function on(n,e,t,r){let i=r.getToolchainExecutable("swift");n=r.buildFlags.withSwiftSDKFlags(n);let s=t.cwd.fsPath,o=t.cwd.fsPath,a=new Ue.Task({type:"swift",args:n,cwd:s,disableTaskQueue:t.disableTaskQueue},(t==null?void 0:t.scope)??Ue.TaskScope.Workspace,e,"swift",new Ue.ProcessExecution(i,n,{cwd:o,env:le(le({},W.swiftEnvironmentVariables),Ut())}),t==null?void 0:t.problemMatcher),c;return(t==null?void 0:t.prefix)?c=`(${t.prefix}) `:c="",a.detail=`${c}swift ${n.join(" ")}`,a.group=t==null?void 0:t.group,a.presentationOptions=(t==null?void 0:t.presentationOptions)??{},a}var an=class{constructor(e){this.workspaceContext=e}async provideTasks(e){if(this.workspaceContext.folders.length===0)return[];let t=[];for(let r of this.workspaceContext.folders){if(!r.swiftPackage.foundPackage)continue;let i=r.taskQueue.activeOperation;if(i&&i.task.group!==Ue.TaskGroup.Build){let o=new Ue.Task({type:"swift",args:[]},r.workspaceFolder,"Build tasks disabled","swift",new Ue.CustomExecution(()=>{throw Error("Task disabled.")}));o.group=Ue.TaskGroup.Build,o.detail=`While ${i.task.name} is running.`,o.presentationOptions={reveal:Ue.TaskRevealKind.Never,echo:!1},t.push(o);continue}t.push(ID(r));let s=r.swiftPackage.executableProducts;for(let o of s)t.push(...OD(o,r))}return t}resolveTask(e,t){let r=this.workspaceContext.toolchain.getToolchainExecutable("swift"),i=e.scope,s=e.definition.cwd;!Ta.isAbsolute(s)&&i.uri.fsPath&&(s=Ta.join(i.uri.fsPath,s));let o=new Ue.Task(e.definition,e.scope??Ue.TaskScope.Workspace,e.name??"Swift Custom Task","swift",new Ue.ProcessExecution(r,e.definition.args,{cwd:s,env:le(le({},W.swiftEnvironmentVariables),Ut())}),e.problemMatchers);return o.detail=e.detail??`swift ${e.definition.args.join(" ")}`,o.group=e.group,o.presentationOptions=e.presentationOptions,o}};an.buildAllName="Build All",an.cleanBuildName="Clean Build",an.resolvePackageName="Resolve Package Dependencies",an.updatePackageName="Update Package Dependencies";var Fu=class{parseResultDarwin(e,t){let r=e.split(`
`);t.excess&&(r[0]=t.excess+r[0]),e[e.length-1]!==`
`?t.excess=r.pop():t.excess=void 0;for(let i of r){let s=/^Test Case '-\[(\S+)\s(.*)\]' started./.exec(i);if(s){let C=`${s[1]}/${s[2]}`;this.startTest(t.getTestItemIndexDarwin(C),t);continue}let o=/^Test Case '-\[(\S+)\s(.*)\]' passed \((\d.*) seconds\)/.exec(i);if(o){let C=`${o[1]}/${o[2]}`,b=+o[3];this.passTest(t.getTestItemIndexDarwin(C),b,t);continue}let a=/^Test Case '-\[(\S+)\s(.*)\]' failed \((\d.*) seconds\)/.exec(i);if(a){let C=`${a[1]}/${a[2]}`,b=+a[3];this.failTest(t.getTestItemIndexDarwin(C),b,t);continue}let c=/^(.+):(\d+):\serror:\s-\[(\S+)\s(.*)\] : (.*)$/.exec(i);if(c){let C=`${c[3]}/${c[4]}`;this.startErrorMessage(t.getTestItemIndexDarwin(C),c[5],c[1],c[2],t);continue}let u=/^(.+):(\d+):\s-\[(\S+)\s(.*)\] : Test skipped/.exec(i);if(u){let C=`${u[3]}/${u[4]}`;this.skipTest(t.getTestItemIndexDarwin(C),t);continue}let l=/^Test Suite '(.*)' started/.exec(i);if(l){this.startTestSuite(l[1],t);continue}let h=/^Test Suite '(.*)' passed/.exec(i);if(h){this.passTestSuite(h[1],t);continue}let f=/^Test Suite '(.*)' failed/.exec(i);if(f){this.failTestSuite(f[1],t);continue}this.continueErrorMessage(i,t)}}parseResultNonDarwin(e,t){let r=e.split(`
`);t.excess&&(r[0]=t.excess+r[0]),e[e.length-1]!==`
`?t.excess=r.pop():t.excess=void 0;for(let i of r){let s=/^Test Case '(.*)\.(.*)' started/.exec(i);if(s){let f=`${s[1]}/${s[2]}`,C=t.getTestItemIndexNonDarwin(f,void 0);this.startTest(C,t);continue}let o=/^Test Case '(.*)\.(.*)' failed \((\d.*) seconds\)/.exec(i);if(o){let f=`${o[1]}/${o[2]}`,C=t.getTestItemIndexNonDarwin(f,void 0);this.failTest(C,+o[3],t);continue}let a=/^(.+):(\d+):\serror:\s*(.*)\.(.*) : (.*)/.exec(i);if(a){let f=`${a[3]}/${a[4]}`,C=t.getTestItemIndexNonDarwin(f,a[1]);this.startErrorMessage(C,a[5],a[1],a[2],t);continue}let c=/^(.+):(\d+):\s*(.*)\.(.*) : Test skipped/.exec(i);if(c){let f=`${c[3]}/${c[4]}`,C=t.getTestItemIndexNonDarwin(f,c[1]);this.skipTest(C,t);continue}let u=/^Test Suite '(.*)' started/.exec(i);if(u){this.startTestSuite(u[1],t);continue}let l=/^Test Suite '(.*)' passed/.exec(i);if(l){this.passTestSuite(l[1],t);continue}let h=/^Test Suite '(.*)' failed/.exec(i);if(h){this.failTestSuite(h[1],t);continue}this.continueErrorMessage(i,t)}for(let i of r){let s=/^Test Case '(.*)\.(.*)' passed \((\d.*) seconds\)/.exec(i);if(s){let o=`${s[1]}/${s[2]}`,a=+s[3],c=t.getTestItemIndexNonDarwin(o,void 0);this.passTest(c,a,t);continue}}}startTestSuite(e,t){t.startedSuite(e)}passTestSuite(e,t){t.passedSuite(e)}failTestSuite(e,t){t.failedSuite(e)}startTest(e,t){e!==-1&&(t.started(e),t.failedTest=void 0)}passTest(e,t,r){e!==-1&&r.passed(e,t),r.failedTest=void 0}startErrorMessage(e,t,r,i,s){if(s.failedTest){s.failedTest.complete=!0;return}s.failedTest={testIndex:e,message:t,file:r,lineNumber:parseInt(i),complete:!1}}continueErrorMessage(e,t){t.failedTest&&t.failedTest.complete!==!0&&(t.failedTest.message+=`
${e}`)}failTest(e,t,r){e!==-1&&(r.failedTest?r.failed(e,r.failedTest.message,{file:r.failedTest.file,line:r.failedTest.lineNumber}):r.failed(e,"Failed")),r.failedTest=void 0}skipTest(e,t){e!==-1&&t.skipped(e),t.failedTest=void 0}};var Iu=class{createDebugAdapterTracker(e){return new co(e.id)}},Ra=class{constructor(e){this.id=e;Ra.debugSessionIdMap[e]=this}static setDebugSessionCallback(e,t){let r=this.debugSessionIdMap[e.id];r&&(r.cb=t)}onDidSendMessage(e){let t=e;this.cb&&t&&t.type==="event"&&t.event==="output"&&t.body.category!=="console"&&this.cb(t.body.output)}onWillStopSession(){delete Ra.debugSessionIdMap[this.id]}},co=Ra;co.debugSessionIdMap={};var gi=class{constructor(e,t,r){this.request=e;this.folderContext=t;this.controller=r;this.testRun=this.controller.createTestRun(this.request);let i=this.createTestLists();this.testItems=i.testItems,this.testArgs=i.testArgs,this.testOutputParser=new Fu}get workspaceContext(){return this.folderContext.workspaceContext}static setupProfiles(e,t){e.createRunProfile("Run Tests",at.TestRunProfileKind.Run,async(r,i)=>{await new gi(r,t,e).runHandler(!1,!1,i)},!0),e.createRunProfile("Test Coverage",at.TestRunProfileKind.Run,async(r,i)=>{await new gi(r,t,e).runHandler(!1,!0,i)}),e.createRunProfile("Debug Tests",at.TestRunProfileKind.Debug,async(r,i)=>{await new gi(r,t,e).runHandler(!0,!1,i)})}createTestLists(){var s,o,a,c;let e=[];this.request.include&&this.request.include.length>0?this.request.include.forEach(u=>e.push(u)):this.controller.items.forEach(u=>e.push(u));let t=[],r=[];for(;e.length>0;){let u=e.pop();if(!((s=this.request.exclude)==null?void 0:s.includes(u))){if(u.parent&&!((o=u.parent)==null?void 0:o.parent)&&!((a=this.request.exclude)==null?void 0:a.find(l=>l.id.startsWith(u.id)))){t.push(u),u.children.size>0&&u.children.forEach(l=>r.push(l));continue}if(u.children.size>0){u.children.forEach(l=>e.push(l));continue}t.push(u)}}let i=[];for((this.request.include&&this.request.include.length>0||this.request.exclude&&this.request.exclude.length>0)&&(i=t.map(u=>u.id));r.length>0;){let u=r.pop();((c=this.request.exclude)==null?void 0:c.includes(u))||t.push(u)}return{testItems:t,testArgs:i}}async runHandler(e,t,r){let i=new Rp(this.testItems,this.testRun,this.folderContext);try{if(!t){let s=await Qi(this.folderContext),o=await this.folderContext.taskQueue.queueOperation({task:s},r);if(o===void 0||o!==0){this.testRun.end();return}}this.setTestsEnqueued(),e?await this.debugSession(r,i):await this.runSession(r,t,i)}catch(s){let o=s;if(o&&o.error&&o.error.message.startsWith("Command failed")){this.testRun.end();return}this.testRun.appendOutput(`\r
Error: ${Nn(s)}`)}this.testRun.end()}createLaunchConfigurationForTesting(e){let t=this.testArgs.join(",");if(process.platform==="darwin"){let r=this.workspaceContext.toolchain.swiftVersion;if(e&&r.isLessThan(new He(5,7,0))&&r.isGreaterThanOrEqual(new He(5,6,0))){let i;t.length>0?i=`-XCTest ${t}`:i="";let s=Sp(this.folderContext,i);return s===null?null:s}else{let i=xu(this.folderContext,!0);return i===null?null:(t.length>0&&(i.args=["-XCTest",t,...i.args]),i.terminal="console",i)}}else{let r=xu(this.folderContext,!0);return r===null?null:(t.length>0&&(r.args=[t]),r.terminal="console",r)}}async runSession(e,t,r){let i=this.createLaunchConfigurationForTesting(!1);if(i===null)return;let s=new Ou.Writable({write:(u,l,h)=>{let f=u.toString();this.testRun.appendOutput(f.replace(/\n/g,`\r
`)),process.platform==="darwin"?this.testOutputParser.parseResultDarwin(f,r):this.testOutputParser.parseResultNonDarwin(f,r),h()}}),o=new Ou.Writable({write:(u,l,h)=>{let f=u.toString();this.testRun.appendOutput(f.replace(/\n/g,`\r
`)),h()}}),a,c;if(process.platform==="darwin",a=s,c=o,e.isCancellationRequested){s.end(),o.end();return}this.testRun.appendOutput(`> Test run started at ${new Date().toLocaleString()} <\r
\r
`),at.commands.executeCommand("testing.showMostRecentOutput");try{if(t){let u=this.testArgs.flatMap(h=>["--filter",h]),l=["test","--enable-code-coverage"];await qs(this.workspaceContext.toolchain.getToolchainExecutable("swift"),[...l,...u],a,c,e,{cwd:i.cwd,env:le(le({},process.env),i.env),maxBuffer:16*1024*1024},this.folderContext,!1,"SIGINT")}else process.platform==="darwin"&&(a=o,c=s),await qs(i.program,i.args??[],a,c,e,{cwd:i.cwd,env:le(le({},process.env),i.env),maxBuffer:16*1024*1024},this.folderContext,!1,"SIGKILL")}catch(u){if(o.end(),s.end(),t&&(await this.folderContext.lcovResults.generate(),W.displayCoverageReportAfterRun&&this.workspaceContext.testCoverageDocumentProvider.show(this.folderContext)),r.currentTestItem){let l=new at.TestMessage(Nn(u));this.testRun.errored(r.currentTestItem,l)}throw u}o.end(),s.end(),t&&(await this.folderContext.lcovResults.generate(),W.displayCoverageReportAfterRun&&this.workspaceContext.testCoverageDocumentProvider.show(this.folderContext))}async debugSession(e,t){let r=this.createLaunchConfigurationForTesting(!0);if(r===null)return;if(r.preLaunchTask=void 0,W.diagnostics){let o=JSON.stringify(r);this.workspaceContext.outputChannel.logDiagnostic(`Debug Config: ${o}`,this.folderContext.name)}let i=[],s=at.debug.onDidStartDebugSession(o=>{this.workspaceContext.outputChannel.logDiagnostic("Start Test Debugging",this.folderContext.name),co.setDebugSessionCallback(o,c=>{this.testRun.appendOutput(c),process.platform==="darwin"?this.testOutputParser.parseResultDarwin(c,t):this.testOutputParser.parseResultNonDarwin(c,t)});let a=e.onCancellationRequested(()=>{this.workspaceContext.outputChannel.logDiagnostic("Test Debugging Cancelled",this.folderContext.name),at.debug.stopDebugging(o)});i.push(a)});return i.push(s),new Promise((o,a)=>{at.debug.startDebugging(this.folderContext.workspaceFolder,r).then(c=>{if(c){this.testRun.appendOutput(`> Test run started at ${new Date().toLocaleString()} <\r
\r
`),at.commands.executeCommand("testing.showMostRecentOutput");let u=at.debug.onDidTerminateDebugSession(async()=>{this.workspaceContext.outputChannel.logDiagnostic("Stop Test Debugging",this.folderContext.name),i.forEach(l=>l.dispose()),o()});i.push(u)}else i.forEach(u=>u.dispose()),a()},c=>{i.forEach(u=>u.dispose()),a(c)})})}setTestsEnqueued(){for(let e of this.testItems)this.testRun.enqueued(e)}},Rp=class{constructor(e,t,r){this.testItems=e;this.testRun=t;this.folderContext=r}getTestItemIndexDarwin(e){return this.testItems.findIndex(t=>t.id===e)}getTestItemIndexNonDarwin(e,t){let r=-1;return t&&(r=this.testItems.findIndex(i=>this.isTestWithFilenameInTarget(e,t,i))),r===-1&&(r=this.testItems.findIndex(i=>i.id.endsWith(e))),r}started(e){this.testRun.started(this.testItems[e]),this.currentTestItem=this.testItems[e]}passed(e,t){this.testRun.passed(this.testItems[e],t*1e3),this.testItems.splice(e,1),this.lastTestItem=this.currentTestItem,this.currentTestItem=void 0}failed(e,t,r){if(r){let i=new at.TestMessage(t);i.location=new at.Location(at.Uri.file(r.file),new at.Position(r.line-1,0)),this.testRun.failed(this.testItems[e],i)}else this.testRun.failed(this.testItems[e],new at.TestMessage(t));this.testItems.splice(e,1),this.lastTestItem=this.currentTestItem,this.currentTestItem=void 0}skipped(e){this.testRun.skipped(this.testItems[e]),this.testItems.splice(e,1),this.lastTestItem=this.currentTestItem,this.currentTestItem=void 0}startedSuite(){}passedSuite(e){var r;let t=(r=this.lastTestItem)==null?void 0:r.parent;t&&t.id.endsWith(`.${e}`)&&this.testRun.passed(t)}failedSuite(e){var r;let t=(r=this.lastTestItem)==null?void 0:r.parent;t&&t.id.endsWith(`.${e}`)&&this.testRun.failed(t,[])}isTestWithFilenameInTarget(e,t,r){var o;if(!r.id.endsWith(e))return!1;let i=(o=r.parent)==null?void 0:o.parent;if(!i)return!1;let s=this.folderContext.swiftPackage.targets.find(a=>i.label===a.name);if(s){let a=t,c=ka.join(this.folderContext.folder.fsPath,s.path),u=ka.relative(c,a);return s.sources.find(l=>l===u)!==void 0}return!1}};var uo=G(require("vscode")),Pa=G(require("path"));var Nu=class{constructor(e,t,r){this.uri=e;this.folderContext=t;this.controller=r;var i;this.targetName=(i=this.getTarget(e))==null?void 0:i.name,this.classes=[],this.functions=[]}includesFunction(e,t,r){return e!==this.targetName?!1:this.functions.find(i=>i.className===t&&i.funcName===r)!==void 0}addTestItems(){if(!this.targetName)return;let e=this.controller.items.get(this.targetName);!e||this.addTestItemsToTarget(e)}updateTestItems(e){if(!this.targetName)return;let t=this.parseSymbolList(e),r=this.controller.items.get(this.targetName);if(!r){this.functions=t.functions,this.classes=t.classes;return}let i=t.functions,s=[];this.functions.forEach(o=>{i.find(a=>o.className===a.className&&o.funcName===a.funcName)||s.push(o)}),this.functions=i,this.classes=t.classes,this.addTestItemsToTarget(r);for(let o of s){let a=`${this.targetName}.${o.className}`,c=r.children.get(a);if(!c)continue;let u=`${this.targetName}.${o.className}/${o.funcName}`;c.children.delete(u)}r.children.forEach(o=>{o.children.size===0&&r.children.delete(o.id)})}addTestItemsToTarget(e){let t=e.id;for(let r of this.classes){let i=`${t}.${r.className}`,s=e.children.get(i);if(!!s)if(s.uri)s.range=r.range;else{let o=s.children;e.children.delete(i);let a=this.controller.createTestItem(i,r.className,this.uri);o.forEach(c=>a.children.add(c)),a.range=r.range,e.children.add(a)}}for(let r of this.functions){let i=`${t}.${r.className}`,s=e.children.get(i);if(!s)continue;let o=`${t}.${r.className}/${r.funcName}`,a=s.children.get(o);if(a)if(a.uri)a.range=r.range;else{s.children.delete(o);let c=this.controller.createTestItem(o,r.funcName,this.uri);c.range=r.range,s.children.add(c)}else{let c=this.controller.createTestItem(o,r.funcName,this.uri);c.range=r.range,s.children.add(c)}}}parseSymbolList(e){let t=[],r=[];return e.filter(s=>s.kind===uo.SymbolKind.Class||s.kind===uo.SymbolKind.Namespace).forEach(s=>{var a;s.kind===uo.SymbolKind.Class&&t.push({className:s.name,range:s.range});let o=(a=s.children)==null?void 0:a.filter(c=>c.kind===uo.SymbolKind.Method&&c.name.match(/^test.*\(\)/));o==null||o.forEach(c=>{r.push({className:s.name,funcName:c.name.slice(0,-2),range:c.range})})}),{classes:t,functions:r}}getTarget(e){return Dn(e.fsPath,this.folderContext.folder.fsPath)?this.folderContext.swiftPackage.getTargets("test").find(i=>{let s=Pa.relative(Pa.join(this.folderContext.folder.fsPath,i.path),e.fsPath);return i.sources.find(o=>o===s)!==void 0}):void 0}};var lo=class{constructor(e){this.folderContext=e;this.controller=_a.tests.createTestController(e.name,`${e.name} Tests`),this.controller.resolveHandler=async r=>{r||await this.discoverTestsInWorkspace()},gi.setupProfiles(this.controller,this.folderContext);let t=e.workspaceContext.tasks.onDidEndTaskProcess(r=>{var o;let i=r.execution.task,s=i.execution;i.scope===this.folderContext.workspaceFolder&&i.group===_a.TaskGroup.Build&&((o=s==null?void 0:s.options)==null?void 0:o.cwd)===this.folderContext.folder.fsPath&&r.exitCode===0&&i.definition.dontTriggerTestDiscovery!==!0&&this.discoverTestsInWorkspace()});this.subscriptions=[t,this.controller]}dispose(){this.subscriptions.forEach(e=>e.dispose())}static observeFolders(e){return e.observeFolders((t,r,i)=>{var s;switch(r){case ye.add:t==null||t.addTestExplorer(),(s=t==null?void 0:t.testExplorer)==null||s.discoverTestsInWorkspace();break;case ye.focus:t&&(i.languageClientManager.documentSymbolWatcher=(o,a)=>lo.onDocumentSymbols(t,o,a))}})}static onDocumentSymbols(e,t,r){var o;let i=t==null?void 0:t.uri,s=e==null?void 0:e.testExplorer;s&&r&&i&&i.scheme==="file"&&Dn(i.fsPath,e.folder.fsPath)&&(((o=s.lspFunctionParser)==null?void 0:o.uri)===i||(s.lspFunctionParser=new Nu(i,e,s.controller)),s.lspFunctionParser.updateTestItems(r))}async discoverTestsInWorkspace(){var e;try{let t=this.folderContext.workspaceContext.toolchain,r=Sa(t);if(process.platform==="darwin"&&W.sanitizer!=="off"){let a=await Qi(this.folderContext);a.definition.dontTriggerTestDiscovery=!0;let c=await this.folderContext.taskQueue.queueOperation({task:a});if(c===void 0||c!==0){this.setErrorTestItem("Build the project to enable test discovery.");return}}let i;t.swiftVersion.isGreaterThanOrEqual(new He(5,8,0))?i=["test","list","--skip-build"]:i=["test","--list-tests","--skip-build"],i=[...i,...r];let{stdout:s}=await er(i,t,{cwd:this.folderContext.folder.fsPath},this.folderContext);this.deleteErrorTestItem();let o=s.match(/^.*\.[a-zA-Z0-9_]*\/.*$/gm);if(!o)return;this.controller.items.forEach(a=>{a.children.forEach(c=>{c.children.forEach(u=>{var h;let l=`${a.label}.${c.label}/${u.label}`;!o.find(f=>f===l)&&!((h=this.lspFunctionParser)==null?void 0:h.includesFunction(a.label,c.label,u.label))&&c.children.delete(u.id)}),c.children.size===0&&a.children.delete(c.id)})});for(let a of o){let c=/^([\w\d_]*)\.([\w\d_]*)\/(.*)$/.exec(a);if(!c)continue;let u=this.controller.items.get(c[1]);u||(u=this.controller.createTestItem(c[1],c[1]),this.controller.items.add(u));let l=u.children.get(`${c[1]}.${c[2]}`);if(l||(l=this.controller.createTestItem(`${c[1]}.${c[2]}`,c[2]),u.children.add(l)),!l.children.get(a)){let h=this.controller.createTestItem(a,c[3]);l.children.add(h)}}(e=this.lspFunctionParser)==null||e.addTestItems()}catch(t){let r=Nn(t);process.platform==="darwin"&&r.match(/error: unableToLoadBundle/)||process.platform==="win32"&&r.match(/The file doesn’t exist./)||!["darwin","win32"].includes(process.platform)&&r.match(/No such file or directory/)?this.setErrorTestItem("Build the project to enable test discovery."):r.startsWith("error: no tests found")?this.setErrorTestItem("Add a test target to your Package.","No Tests Found."):this.setErrorTestItem(r),this.folderContext.workspaceContext.outputChannel.log(`Test Discovery Failed: ${r}`,this.folderContext.name)}}deleteErrorTestItem(){this.controller.items.delete(lo.errorTestItemId)}setErrorTestItem(e,t="Test Discovery Error"){if(this.controller.items.forEach(r=>{this.controller.items.delete(r.id)}),this.controller.items.size===0){let r=this.controller.createTestItem(lo.errorTestItemId,t);r.error=e,this.controller.items.add(r)}}},Yi=lo;Yi.errorTestItemId="#Error#";var kp=G(require("vscode")),Pp=G(require("path"));var fo=class{constructor(e){this.folderContext=e;this.waitingToRun=!1}static start(e){let t=kp.workspace.onDidSaveTextDocument(r=>{if(W.backgroundCompilation===!1)return;let i=["swift","c","cpp","objective-c","objective-cpp"],s=!1;if(i.forEach(a=>{r.languageId===a&&(s=!0)}),s===!1)return;let o=e.folders.find(a=>Dn(r.uri.fsPath,a.folder.fsPath));!o||Pp.join(o.folder.fsPath,"Package.swift")!==r.uri.fsPath&&o.backgroundCompilation.runTask()});return{dispose:()=>t.dispose()}}async runTask(){let e=await Qi(this.folderContext);!e||await this.folderContext.taskQueue.queueOperation({task:e})}};var _p=class{constructor(e,t,r){this.cb=t;this.token=r;this.promise=void 0;this.task=e.task,this.showStatusItem=e.showStatusItem,this.log=e.log}isEqual(e){let t=e.task.definition.args,r=this.task.definition.args;return t.length!==r.length?!1:t.every((i,s)=>i===r[s])&&e.task.scope===this.task.scope}},qu=class{constructor(e){this.folderContext=e;this.queue=[],this.workspaceContext=e.workspaceContext,this.activeOperation=void 0,this.disabled=!1}queueOperation(e,t){let r=this.findQueuedOperation(e);if(r&&r.promise!==void 0)return r.promise;if(e.checkAlreadyRunning===!0&&this.activeOperation&&this.activeOperation.promise&&this.activeOperation.isEqual(e))return this.activeOperation.promise;let i=new Promise(s=>{r=new _p(e,o=>{s(o)},t),this.queue.push(r),this.processQueue()});return this.queue.length>0&&!this.queue[this.queue.length-1].promise&&(this.queue[this.queue.length-1].promise=i),i}async processQueue(){if(!this.activeOperation){let e=this.queue.shift();if(e){let t=e.task;this.activeOperation=e,await this.waitWhileDisabled(),e.showStatusItem===!0&&this.workspaceContext.statusItem.start(t),e.log&&this.workspaceContext.outputChannel.logStart(`${e.log} ... `,this.folderContext.name),this.workspaceContext.tasks.executeTaskAndWait(t,e.token).then(r=>{if(e.log)switch(r){case 0:this.workspaceContext.outputChannel.logEnd("done.");break;case void 0:this.workspaceContext.outputChannel.logEnd("cancelled.");break;default:this.workspaceContext.outputChannel.logEnd("failed.");break}this.finishTask(e,r)}).catch(r=>{e.log&&this.workspaceContext.outputChannel.logEnd(`${r}`),this.finishTask(e,void 0)})}}}finishTask(e,t){e.cb(t),e.showStatusItem===!0&&this.workspaceContext.statusItem.end(e.task),this.activeOperation=void 0,this.processQueue()}findQueuedOperation(e){for(let t of this.queue)if(t.isEqual(e))return t}async waitWhileDisabled(){await Pf(()=>!this.disabled,1e3)}};var Fp=G(xp()),Ip=G(require("fs")),Op=G(require("fs/promises"));var Au=class{constructor(e){this.folderContext=e;this.load()}dispose(){this.observer=void 0}async generate(){let e=this.folderContext.workspaceContext.toolchain.getToolchainExecutable("llvm-cov"),t=this.folderContext.swiftPackage.name,r=Rt.buildDirectoryFromWorkspacePath(this.folderContext.folder.fsPath,!0),i=`${r}/debug/codecov/lcov.info`,s=Ip.createWriteStream(i);try{let o=`${r}/debug/${t}PackageTests.xctest`;process.platform==="darwin"&&(o+=`/Contents/MacOs/${t}PackageTests`),await qs(e,["export","-format","lcov",o,"-ignore-filename-regex=Tests|.build|Snippets|Plugins",`-instr-profile=${r}/debug/codecov/default.profdata`],s,s,null,{env:le(le({},process.env),W.swiftEnvironmentVariables)},this.folderContext),await this.lcovFileChanged()}catch(o){throw s.end(),o}}get exist(){return this.contents!==void 0}resultsForFile(e){var t;return(t=this.contents)==null?void 0:t.find(r=>r.file===e)}get totals(){if(!this.contents)return;let e=0,t=0;return this.contents.forEach(r=>{e+=r.lines.hit,t+=r.lines.found}),{hit:e,found:t}}async lcovFileChanged(){await this.load(),this.observer&&this.observer(this)}async load(){let e=this.lcovFilename();try{let t=await Op.readFile(e,"utf8");this.contents=await this.loadLcov(t)}catch{}}async loadLcov(e){return new Promise((t,r)=>{Fp.source(e,(i,s)=>{i?r(i):s&&t(s)})})}lcovFilename(){return`${Rt.buildDirectoryFromWorkspacePath(this.folderContext.folder.fsPath,!0)}/debug/codecov/lcov.info`}};var qt=class{constructor(e,t,r,i,s){this.folder=e;this.linuxMain=t;this.swiftPackage=r;this.workspaceFolder=i;this.workspaceContext=s;this.hasResolveErrors=!1;this.packageWatcher=new ou(this,s),this.packageWatcher.install(),this.backgroundCompilation=new fo(this),this.taskQueue=new qu(this),this.lcovResults=new Au(this)}dispose(){var e,t;(e=this.linuxMain)==null||e.dispose(),this.packageWatcher.dispose(),(t=this.testExplorer)==null||t.dispose(),this.lcovResults.dispose()}static async create(e,t,r){let i=`Loading Package (${qt.uriName(e)})`;r.statusItem.start(i);let{linuxMain:s,swiftPackage:o}=await r.statusItem.showStatusWhileRunning(i,async()=>{let u=await Ls.create(e),l=await Sn.create(e,r.toolchain);return{linuxMain:u,swiftPackage:l}});r.statusItem.end(i);let a=new qt(e,s,o,t,r),c=o.error;return c&&(Np.window.showErrorMessage(`Failed to load ${a.name}/Package.swift: ${c.message}`),r.outputChannel.log(`Failed to load Package.swift: ${c.message}`,a.name)),a}get name(){return this.relativePath.length===0?this.workspaceFolder.name:`${this.workspaceFolder.name}/${this.relativePath}`}get relativePath(){return Ji.relative(this.workspaceFolder.uri.fsPath,this.folder.fsPath)}get isRootFolder(){return this.workspaceFolder.uri===this.folder}async reload(){await this.swiftPackage.reload(this.workspaceContext.toolchain)}async reloadPackageResolved(){await this.swiftPackage.reloadPackageResolved()}async loadSwiftPlugins(){let e=await Sn.loadPlugins(this.workspaceFolder.uri,this.workspaceContext.toolchain);this.swiftPackage.plugins=e}async fireEvent(e){this.workspaceContext.fireEvent(this,e)}editedPackageFolder(e){return Ji.join(this.folder.fsPath,"Packages",e)}addTestExplorer(){this.testExplorer=new Yi(this)}static uriName(e){return Ji.basename(e.fsPath)}};var mi=G(require("vscode")),qp=G(require("path")),Lp=class{constructor(e){this.task=e}get name(){if(this.task instanceof mi.Task){let e=this.task.definition.cwd;return e?`${this.task.name} (${qp.basename(e)})`:this.task.name}else return this.task}},$u=class{constructor(){this.runningTasks=[];this.item=mi.window.createStatusBarItem(mi.StatusBarAlignment.Left)}async showStatusWhileRunning(e,t){this.start(e);try{let r=await t();return this.end(e),r}catch(r){throw this.end(e),r}}start(e){if(this.runningTasks.findIndex(r=>r.task===e)!==-1)return;let t=new Lp(e);this.runningTasks.push(t),this.showTask(t)}end(e){let t=this.runningTasks.findIndex(r=>r.task===e);if(t!==-1)if(this.runningTasks.splice(t,1),this.runningTasks.length===0)this.hide();else{let r=this.runningTasks[this.runningTasks.length-1];this.showTask(r)}}showTask(e){e.task instanceof mi.Task?this.show(`$(sync~spin) ${e.name}`,e.name,"workbench.action.tasks.showTasks"):this.show(`$(sync~spin) ${e.name}`,e.name)}show(e,t=void 0,r=void 0){this.item.text=e,this.item.accessibilityInformation={label:t??e},this.item.command=r,this.item.show()}hide(){this.item.hide()}dispose(){this.item.dispose()}};var Mp=G(require("vscode"));var ju=class{constructor(){this.channel=Mp.window.createOutputChannel("Swift")}dispose(){this.channel.dispose()}log(e,t){let r;t!==void 0?r=`${t}: ${e}`:r=e;let i=`${this.nowFormatted}: ${r}`;this.channel.appendLine(i),console.log(i)}logDiagnostic(e,t){if(!W.diagnostics)return;let r;t!==void 0?r=`${t}: ${e}`:r=e;let i=`${this.nowFormatted}: ${r}`;this.channel.appendLine(i),console.log(i)}logStart(e,t){let r;t!==void 0?r=`${t}: ${e}`:r=e;let i=`${this.nowFormatted}: ${r}`;this.channel.append(i),console.log(i)}logEnd(e){this.channel.appendLine(e),console.log(e)}get nowFormatted(){return new Date().toLocaleString("en-US",{hourCycle:"h23",hour:"2-digit",minute:"numeric",second:"numeric"})}};var Br=G(require("path")),Ea=G(require("fs/promises"));var zr=class{constructor(e,t){this.success=e;this.failure=t}static makeSuccess(e){return new zr(e)}static makeFailure(e){return new zr(void 0,e)}};async function Ap(n){let e=Br.join(n.swiftFolderPath,"lldb"),t=Br.dirname(n.swiftFolderPath);try{let s=["-b","-O","script print('<!' + lldb.SBHostOS.GetLLDBPath(lldb.ePathTypeLLDBShlibDir).fullpath + '!>')"],{stdout:o}=await pn(e,s),a=/^<!([^!]*)!>/m.exec(o);a&&(t=a[1])}catch{if(process.platform==="win32")return zr.makeFailure(void 0)}let r=await MD(t);return r?zr.makeSuccess(r):zr.makeFailure("LLDB failed to provide a library path")}async function MD(n){if((await Ea.stat(n)).isFile())return n;let t,r;if(process.platform==="linux")t=Br.join(n,"lib"),r=/liblldb.*\.so.*/;else if(process.platform==="darwin")t=Br.join(n,"lib"),r=/liblldb\..*dylib|LLDB/;else if(process.platform==="win32")t=Br.join(n,"bin"),r=/liblldb\.dll/;else return n;for(let i of[n,t]){let s=await AD(i,r);if(s)return Br.join(i,s)}}async function AD(n,e){try{let t=await Ea.readdir(n);for(let r of t)if(e.test(r))return r}catch{}return null}var Ct=G(require("vscode")),uC=G(require("path")),Dt=G(rf());var na=G(require("vscode"));var sC=G(rf()),oC=new sC.RequestType("sourcekit-lsp/inlayHints");var aC=class{constructor(e){this.client=e}provideInlayHints(e,t,r){if(!W.lsp.inlayHintsEnabled)return null;let i={textDocument:this.client.code2ProtocolConverter.asTextDocumentIdentifier(e),range:{start:t.start,end:t.end}};return this.client.sendRequest(oC,i,r).then(o=>o.map(a=>{let c=a.label,u;switch(a.category){case"type":u=na.InlayHintKind.Type,c=`: ${c}`;break;case"parameter":u=na.InlayHintKind.Parameter;break}return{label:c,position:a.position,kind:u,paddingLeft:!0}}),o=>o)}};function cC(n){return na.languages.registerInlayHintsProvider(Fn.documentSelector,new aC(n))}var cr=class{constructor(e){this.workspaceContext=e;if(this.singleServerSupport=e.swiftVersion>=new He(5,7,0),this.subscriptions=[],this.subFolderWorkspaces=[],this.singleServerSupport){let r=e.observeFolders(async(i,s)=>{if(!!i)switch(s){case ye.add:this.addFolder(i);break;case ye.remove:this.removeFolder(i);break}});this.subscriptions.push(r),this.setLanguageClientFolder(void 0)}else{let r=e.observeFolders(async(i,s)=>{switch(s){case ye.add:i&&i.folder&&this.isActiveFileInFolder(i.folder)&&await this.setLanguageClientFolder(i.folder);break;case ye.focus:await this.setLanguageClientFolder(i==null?void 0:i.folder);break}});this.subscriptions.push(r)}let t=Ct.workspace.onDidChangeConfiguration(r=>{r.affectsConfiguration("swift.sourcekit-lsp")&&Ct.window.showInformationMessage("Changing LSP settings requires the language server be restarted.","Ok").then(i=>{i==="Ok"&&this.restart()})});if(this.subscriptions.push(t),e.swiftVersion<new He(5,6,0)){e.outputChannel.logDiagnostic("LSP: Adding new/delete file handlers");let r=Ct.workspace.onDidCreateFiles(()=>{this.restart()}),i=Ct.workspace.onDidDeleteFiles(()=>{this.restart()});this.subscriptions.push(r,i)}this.waitingOnRestartCount=0,this.documentSymbolWatcher=void 0,this.cancellationToken=new Ct.CancellationTokenSource}static get documentSelector(){var t;let e;switch(W.lsp.supportCFamily){case"enable":e=[...cr.appleLangDocumentSelector,...cr.cFamilyDocumentSelector];break;case"disable":e=cr.appleLangDocumentSelector;break;case"cpptools-inactive":e=((t=Ct.extensions.getExtension("ms-vscode.cpptools"))==null?void 0:t.isActive)===!0?cr.appleLangDocumentSelector:[...cr.appleLangDocumentSelector,...cr.cFamilyDocumentSelector]}return e=e.filter(r=>W.lsp.supportedLanguages.includes(r.language)),e}dispose(){var e,t,r,i;(e=this.cancellationToken)==null||e.cancel(),(t=this.cancellationToken)==null||t.dispose(),(r=this.legacyInlayHints)==null||r.dispose(),this.subscriptions.forEach(s=>s.dispose()),(i=this.languageClient)==null||i.stop()}async useLanguageClient(e){if(!this.languageClient||!this.clientReadyPromise)throw sf.LanguageClientUnavailable;return this.clientReadyPromise.then(()=>{if(!this.languageClient||!this.cancellationToken)throw sf.LanguageClientUnavailable;return e(this.languageClient,this.cancellationToken.token)},t=>t)}async restart(){await this.setLanguageClientFolder(this.currentWorkspaceFolder,!0)}async addFolder(e){e.isRootFolder||this.useLanguageClient(async t=>{let r=e.folder;this.subFolderWorkspaces.push(e.folder);let i={uri:t.code2ProtocolConverter.asUri(r),name:qt.uriName(r)};t.sendNotification(Dt.DidChangeWorkspaceFoldersNotification.type,{event:{added:[i],removed:[]}})})}async removeFolder(e){e.isRootFolder||this.useLanguageClient(async t=>{let r=e.folder;this.subFolderWorkspaces=this.subFolderWorkspaces.filter(s=>s!==r);let i={uri:t.code2ProtocolConverter.asUri(r),name:qt.uriName(r)};t.sendNotification(Dt.DidChangeWorkspaceFoldersNotification.type,{event:{added:[],removed:[i]}})})}async addSubFolderWorkspaces(e){for(let t of this.subFolderWorkspaces){let r={uri:e.code2ProtocolConverter.asUri(t),name:qt.uriName(t)};e.sendNotification(Dt.DidChangeWorkspaceFoldersNotification.type,{event:{added:[r],removed:[]}})}}async setLanguageClientFolder(e,t=!1){if(this.languageClient===void 0){this.currentWorkspaceFolder=e,this.restartedPromise=this.setupLanguageClient(e);return}else{if(!this.singleServerSupport&&(e===void 0||this.currentWorkspaceFolder===e&&!t))return;let r;e&&(r={uri:e,name:qt.uriName(e),index:0}),this.restartLanguageClient(r)}}async restartLanguageClient(e){var r,i,s;if(this.waitingOnRestartCount+=1,this.restartedPromise)try{await this.restartedPromise}catch{}if(this.waitingOnRestartCount-=1,this.waitingOnRestartCount!==0)return;let t=this.languageClient;this.languageClient=null,this.currentWorkspaceFolder=e==null?void 0:e.uri,(r=this.legacyInlayHints)==null||r.dispose(),this.legacyInlayHints=void 0,t&&((i=this.cancellationToken)==null||i.cancel(),(s=this.cancellationToken)==null||s.dispose(),this.restartedPromise=t.stop().then(async()=>{await this.setupLanguageClient(e==null?void 0:e.uri)}).catch(async o=>{o.message==="Stopping the server timed out"&&await this.setupLanguageClient(e==null?void 0:e.uri),this.workspaceContext.outputChannel.log(`${o}`)}))}isActiveFileInFolder(e){if(Ct.window.activeTextEditor&&Ct.window.activeTextEditor.document){let t=Ct.window.activeTextEditor.document.uri.fsPath;if(Dn(t,e.fsPath))return!0}return!1}async setupLanguageClient(e){if(W.lsp.disable){this.languageClient=void 0;return}let t=this.createLSPClient(e);return this.startClient(t)}createLSPClient(e){var f;let t=this.workspaceContext.toolchain.getToolchainExecutable("sourcekit-lsp"),r=W.lsp,i=r.serverPath,s=i.length>0?i:t,o=this.workspaceContext.toolchain.buildFlags,a=[...o.swiftDriverSDKFlags(!0),...o.swiftDriverTargetFlags(!0),...Rt.filterArguments(W.buildArguments.concat(o.buildPathFlags()),cr.buildArgumentFilter)],c={command:s,args:r.serverArguments.concat(a),options:{env:le(le(le({},process.env),W.swiftEnvironmentVariables),Ut())}};i.length>0&&W.path.length>0&&i!==t&&W.path&&(c.options={env:Mi(le({},(f=c.options)==null?void 0:f.env),{SOURCEKIT_TOOLCHAIN_PATH:this.workspaceContext.toolchain.toolchainPath})});let u=c,l;e&&(l={uri:e,name:qt.uriName(e),index:0});let h={documentSelector:cr.documentSelector,revealOutputChannelOn:Dt.RevealOutputChannelOn.Never,workspaceFolder:l,middleware:{provideDocumentSymbols:async(C,b,y)=>{let S=await y(C,b),R=S;return this.documentSymbolWatcher&&R&&this.documentSymbolWatcher(C,R),S},provideDefinition:async(C,b,y,S)=>{let R=await S(C,b,y),v=R;if(v&&uC.extname(v[0].uri.path)===".swiftinterface"){let D=Ct.Uri.parse(`readonly://${v[0].uri.fsPath}`);return new Ct.Location(D,v[0].range)}return R},provideInlayHints:async(C,b,y,S)=>{let R=await S(C,b,y);return R==null||R.forEach(v=>v.textEdits=void 0),R}},errorHandler:new lC(5)};return new Dt.LanguageClient("swift.sourcekit-lsp","SourceKit Language Server",u,h)}async startClient(e){return e.onDidChangeState(t=>{t.oldState===Dt.State.Starting&&t.newState===Dt.State.Running&&this.addSubFolderWorkspaces(e)}),e.clientOptions.workspaceFolder?this.workspaceContext.outputChannel.log(`SourceKit-LSP setup for ${qt.uriName(e.clientOptions.workspaceFolder.uri)}`):this.workspaceContext.outputChannel.log("SourceKit-LSP setup"),this.clientReadyPromise=e.start().then(()=>{this.workspaceContext.swiftVersion.isLessThan(new He(5,7,0))&&(this.legacyInlayHints=cC(e))}).catch(t=>{var r;throw this.workspaceContext.outputChannel.log(`${t}`),(r=this.languageClient)==null||r.stop(),this.languageClient=void 0,t}),this.languageClient=e,this.cancellationToken=new Ct.CancellationTokenSource,this.clientReadyPromise}},Fn=cr;Fn.appleLangDocumentSelector=[{scheme:"file",language:"swift"},{scheme:"untitled",language:"swift"},{scheme:"file",language:"objective-c"},{scheme:"untitled",language:"objective-c"},{scheme:"file",language:"objective-cpp"},{scheme:"untitled",language:"objective-cpp"}],Fn.cFamilyDocumentSelector=[{scheme:"file",language:"c"},{scheme:"untitled",language:"c"},{scheme:"file",language:"cpp"},{scheme:"untitled",language:"cpp"}],Fn.buildArgumentFilter=[{argument:"--build-path",include:1},{argument:"--scratch-path",include:1},{argument:"-Xswiftc",include:1},{argument:"-Xcc",include:1},{argument:"-Xcxx",include:1},{argument:"-Xlinker",include:1},{argument:"-Xclangd",include:1},{argument:"-index-store-path",include:1}];var lC=class{constructor(e){this.maxRestartCount=e;this.restarts=[]}error(e,t,r){return r&&r<=3?{action:Dt.ErrorAction.Continue}:{action:Dt.ErrorAction.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:Dt.CloseAction.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?new Promise(t=>{Ct.window.showErrorMessage(`The SourceKit-LSP server crashed ${this.maxRestartCount+1} times in the last 3 minutes. See the output for more information. Do you want to restart it again.`,"Yes","No").then(r=>{r==="Yes"?(this.restarts=[],t({action:Dt.CloseAction.Restart})):t({action:Dt.CloseAction.DoNotRestart})})}):(this.restarts.shift(),{action:Dt.CloseAction.Restart})}},sf=(e=>(e[e.LanguageClientUnavailable=0]="LanguageClientUnavailable",e))(sf||{});var dC=G(require("os")),of=G(require("path")),fC=G(require("fs/promises"));var ra=class{constructor(e){this.path=e}filename(e,t){let r;return t?r=`${e}${su(16)}.${t}`:r=`${e}${su(16)}`,of.join(this.path,r)}static async create(){let e=of.join((0,dC.tmpdir)(),"vscode-swift");try{await fC.mkdir(e)}catch{}return new ra(e)}};var ia=G(require("vscode")),af=class{constructor(e){this.workspaceContext=e;this.taskEndObservers=new Set;this.taskId=0;this.onDidEndTaskProcessDisposible=ia.tasks.onDidEndTaskProcess(t=>{this.taskEndObservers.forEach(r=>r(t))}),this.onDidEndTaskDisposible=ia.tasks.onDidEndTask(t=>{this.taskEndObservers.forEach(r=>r({execution:t.execution,exitCode:void 0})),t.execution.task.definition.disableTaskQueue&&this.disableTaskQueue(t.execution.task,!1)}),this.onDidStartTaskDisposible=ia.tasks.onDidStartTask(t=>{this.taskStartObserver&&this.taskStartObserver(t),t.execution.task.definition.disableTaskQueue&&this.disableTaskQueue(t.execution.task,!0)})}onDidEndTaskProcess(e){return this.taskEndObservers.add(e),{dispose:()=>{this.removeObserver(e)}}}async executeTaskAndWait(e,t){return e.definition.id=this.taskId,this.taskId+=1,new Promise((r,i)=>{this.startingTaskPromise?this.startingTaskPromise.then(()=>{this.executeTaskAndResolve(e,r,i,t)}):this.executeTaskAndResolve(e,r,i,t)})}executeTaskAndResolve(e,t,r,i){let s=this.onDidEndTaskProcess(o=>{o.execution.task.definition.id===e.definition.id&&(s.dispose(),t(o.exitCode))});this.startingTaskPromise!==void 0&&console.warn("TaskManager: Starting promise should be undefined if we reach here."),this.startingTaskPromise=new Promise(o=>{this.taskStartObserver=()=>{this.taskStartObserver=void 0,this.startingTaskPromise=void 0,o()}}),ia.tasks.executeTask(e).then(o=>{i==null||i.onCancellationRequested(()=>{o.terminate(),s.dispose(),t(void 0)})},o=>{console.log(o),s.dispose(),this.startingTaskPromise=void 0,r(o)})}removeObserver(e){this.taskEndObservers.delete(e)}disableTaskQueue(e,t){let r=this.workspaceContext.folders.findIndex(i=>i.folder.fsPath===e.definition.cwd);r!==-1&&(this.workspaceContext.folders[r].taskQueue.disabled=t)}dispose(){this.onDidEndTaskDisposible.dispose(),this.onDidEndTaskProcessDisposible.dispose(),this.onDidStartTaskDisposible.dispose()}};var _s=G(require("vscode")),ix={set hasPackage(n){_s.commands.executeCommand("setContext","swift.hasPackage",n)},set packageHasDependencies(n){_s.commands.executeCommand("setContext","swift.packageHasDependencies",n)},set packageHasPlugins(n){_s.commands.executeCommand("setContext","swift.packageHasPlugins",n)},set currentTargetType(n){_s.commands.executeCommand("setContext","swift.currentTargetType",n??"none")},set fileIsSnippet(n){_s.commands.executeCommand("setContext","swift.fileIsSnippet",n)}},Yt=ix;var Yc=G(require("vscode")),Jc=G(require("path"));function hC(n){if(n.swiftVersion.isLessThan({major:5,minor:7,patch:0})||!n.currentFolder||!n.currentDocument){Yt.fileIsSnippet=!1;return}let e=n.currentDocument.fsPath,t=Jc.join(n.currentFolder.folder.fsPath,"Snippets");e.startsWith(t)?Yt.fileIsSnippet=!0:Yt.fileIsSnippet=!1}async function pC(n){await mC(n,{noDebug:!0})}async function gC(n){await mC(n,{})}async function mC(n,e){let t=n.currentFolder;if(!n.currentDocument||!t)return;let r=Jc.basename(n.currentDocument.fsPath,".swift"),i=on(["build","--target",r],`Build ${r}`,{group:Yc.TaskGroup.Build,cwd:t.folder,scope:t.workspaceFolder,presentationOptions:{reveal:Yc.TaskRevealKind.Always},problemMatcher:W.problemMatchCompileErrors?"$swiftc":void 0},n.toolchain);await t.taskQueue.queueOperation({task:i}).then(s=>{if(s===0){let o=Tp(r,t);return Da(t.workspaceFolder,o,e)}})}var qr=G(require("vscode")),cf=G(require("path")),uf=class{constructor(e){this.ctx=e;this.onDidChangeEmitter=new qr.EventEmitter,this.provider=qr.workspace.registerTextDocumentContentProvider("swiftTestCoverage",{provideTextDocumentContent:t=>{let r=cf.basename(t.path," coverage"),i=e.folders.find(o=>o.name===r);return i?this.generateMarkdownReport(i)??`Failed to generate test coverage report for ${r}`:`Test coverage report for ${r} is unavailable`},onDidChange:this.onDidChangeEmitter.event})}dispose(){this.provider.dispose(),this.onDidChangeEmitter.dispose()}show(e){let t=qr.Uri.parse(`swiftTestCoverage://report/${e.name} coverage`);this.onDidChangeEmitter.fire(t),qr.commands.executeCommand("markdown.showPreview",t).then(()=>{qr.commands.executeCommand("markdown.preview.refresh",t)})}generateMarkdownReport(e){let t=e.lcovResults;if(!t.contents)return;let r=`
## Test coverage report for ${e.name}

|File|Total lines| Hit|Missed|Coverage %|
|----|----------:|---:|-----:|---------:|
`,i=t.contents.map(h=>{let f=cf.basename(h.file),C=h.lines.found,b=h.lines.hit,y=C-b,S=(100*b/C).toFixed(2),R=encodeURI(`vscode://file${h.file}`);return`|[${f}](${R})|${C}|${b}|${y}|${S}|`}),s=t.totals,o=s.found,a=s.hit,c=o-a,u=(100*a/o).toFixed(2),l=`
| | | | |
|**Totals**|${o}|${a}|${c}|${u}|
`;return r+i.join(`
`)+l}};var bn=G(require("vscode"));var lf=class{constructor(e,t){this.document=e;this.position=t}match(e){let t=this.getLine();if(!t)return null;let r=e.exec(t.text);if(r){let i=r.index+r[0].length;this.position=this.position.translate(void 0,i+t.whitespace);let s=r.map(o=>o);return s.shift(),s}return null}skipUntil(e){let t='{([<"',r='})]>"',i="})]",s=[];for(let o=this.getLine();o;o=this.getLine()){let a=-1,c=0;for(;c<o.text.length;){let u=o.text[c];if(e.indexOf(u)!==-1){let l=s.pop();if(!l)return this.position=this.position.translate(void 0,c+o.whitespace+1),o.text[c];e=l}else if((a=t.indexOf(u))!==-1)s.push(e),e=r[a];else{if(i.indexOf(u)!==-1&&e!=='"')return;u==="\\"&&e==='"'&&(c+=1)}c+=1}this.position=this.position.translate(1,-this.position.character)}}getLine(){for(;this.position.line<this.document.lineCount;){let t=this.document.lineAt(this.position.line).text.substring(this.position.character),r=/^\s*/.exec(t),i=0;if(r&&(i=r[0].length),t.length>i)return{text:t.substring(i),whitespace:i};this.position=this.position.translate(1,-this.position.character)}return null}};var df=class extends bn.CompletionItem{constructor(e,t,r,i){super(t,bn.CompletionItemKind.Text);this.detail=r,this.insertText=e,this.sortText=i}},vC=class{async provideCompletionItems(e,t){return this.isLineComment(e,t.line-1)===!1?void 0:[new df("/// ","///","Documentation comment")]}isLineComment(e,t){return!!/^\s*\/\/\//.test(e.lineAt(t).text)}},yC=class{async provideCompletionItems(e,t){if(this.isLineComment(e,t.line)===!1)return;let i=new bn.Position(t.line+1,0),s=this.getFunctionDetails(e,i);if(s){if(s.parameters.length===0&&s.returns===!1)return;let o=this.constructSnippet(s,!1);return[new df(o,"/// - parameters:","Function documentation comment")]}}async insert(e,t){let r=new bn.Position(t,0),i=e.document,s=this.getFunctionDetails(i,r);if(s){let o=this.constructSnippet(s,!0),a=new bn.Position(t,s.indent);e.insertSnippet(o,a)}}isLineComment(e,t){return!!/^\s*\/\/\/\s*$/.test(e.lineAt(t).text)}getFunctionDetails(e,t){let r=new lf(e,t);if(!r.match(/^[^{]*\b(?:func|init)/))return null;let i=r.match(/^([^(<]*)\s*(\(|<)/);if(!i||i[1]==="<"&&(r.skipUntil(">"),!r.match(/^\(/)))return null;let s=[];if(!r.match(/^\)/))for(;;){let c=r.match(/(\S*)(?:\s*)?:/);if(!c)return null;s.push(...c);let u=r.skipUntil(",)");if(!u)return null;if(u===")")break}let o=!1;for(;;){let c=r.match(/^\s*([a-z]+)/);if(!c||c.length===0)break;c[0]==="throws"&&(o=!0)}let a=r.match(/^\s*->/)!==null;return{indent:e.lineAt(t.line).firstNonWhitespaceCharacterIndex,parameters:s,returns:a,throws:o}}constructSnippet(e,t){let r="";t&&(r+="/// "),r+=" $1";let i=2;if(e.parameters.length===1)r+=`
/// - Parameter ${e.parameters[0]}: $${i}`,i++;else if(e.parameters.length>0){r+=`
/// - Parameters:`;for(let s of e.parameters)r+=`
///   - ${s}: $${i}`,i++}return e.returns&&(r+=`
/// - Returns: $${i}`),t&&(r+=`
`),new bn.SnippetString(r)}},ff=class{constructor(){this.functionCommentCompletion=new yC,this.functionCommentCompletionProvider=bn.languages.registerCompletionItemProvider("swift",this.functionCommentCompletion,"/"),this.commentCompletionProvider=bn.languages.registerCompletionItemProvider("swift",new vC,`
`)}async insert(e,t){await this.functionCommentCompletion.insert(e,t)}dispose(){this.functionCommentCompletionProvider.dispose(),this.commentCompletionProvider.dispose()}};var Ze=G(require("vscode"));var Zc=class{constructor(e){this.workspaceContext=e;this.displayResults=!1,this.currentEditor=Ze.window.activeTextEditor;let{hit:t,miss:r}=this.getTestCoverageDecorationTypes();this.coverageHitDecorationType=Ze.window.createTextEditorDecorationType(t),this.coverageMissDecorationType=Ze.window.createTextEditorDecorationType(r),this.statusBarItem=this.createCoverageStatusItem(),e.folders.forEach(a=>{a.lcovResults.observer=c=>{this.resultsChanged(c)}});let i=e.observeFolders((a,c)=>{if(!!a)switch(c){case ye.add:a.lcovResults.observer=u=>{this.resultsChanged(u)}}}),s=Ze.window.onDidChangeActiveTextEditor(async a=>{this.currentEditor&&this.clear(this.currentEditor),a&&(this.render(a),this.currentEditor=a)}),o=Ze.workspace.onDidChangeConfiguration(a=>{a.affectsConfiguration("swift.coverage.colors")&&this.resetTestCoverageEditorColors(),a.affectsConfiguration("swift.coverage.alwaysShowStatusItem")&&this.updateCoverageStatusItem()});this.subscriptions=[i,s,o]}dispose(){this.subscriptions.forEach(e=>e.dispose()),this.coverageHitDecorationType.dispose(),this.coverageMissDecorationType.dispose()}createCoverageStatusItem(){let e=Ze.window.createStatusBarItem(Ze.StatusBarAlignment.Left);return W.alwaysShowCoverageStatusItem&&(e.text="Coverage: Off",e.accessibilityInformation={label:"Coverage: Off",role:"button"},e.command="swift.toggleTestCoverage",e.show()),e}updateCoverageStatusItem(){W.alwaysShowCoverageStatusItem?(this.updateCoverageStatusItemText(this.statusItemCoverageOffText()),this.statusBarItem.command="swift.toggleTestCoverage",this.statusBarItem.show()):(this.statusBarItem.command=void 0,this.statusBarItem.hide())}updateCoverageStatusItemText(e){this.statusBarItem.text=e,this.statusBarItem.accessibilityInformation={label:e,role:W.alwaysShowCoverageStatusItem?"button":void 0}}resetTestCoverageEditorColors(){this.currentEditor&&this.clear(this.currentEditor),this.coverageHitDecorationType.dispose(),this.coverageMissDecorationType.dispose();let{hit:e,miss:t}=this.getTestCoverageDecorationTypes();this.coverageHitDecorationType=Ze.window.createTextEditorDecorationType(e),this.coverageMissDecorationType=Ze.window.createTextEditorDecorationType(t)}getTestCoverageDecorationTypes(){let e={isWholeLine:!0,dark:{backgroundColor:W.coverageHitColorDarkMode,overviewRulerColor:W.coverageHitColorDarkMode},light:{backgroundColor:W.coverageHitColorLightMode,overviewRulerColor:W.coverageHitColorLightMode}},t={isWholeLine:!0,dark:{backgroundColor:W.coverageMissColorDarkMode,overviewRulerColor:W.coverageMissColorDarkMode},light:{backgroundColor:W.coverageMissColorLightMode,overviewRulerColor:W.coverageMissColorLightMode}};return{hit:e,miss:t}}toggleDisplayResults(){this.displayResults===!0?(this.displayResults=!1,this.currentEditor?this.clear(this.currentEditor):this.updateCoverageStatusItemText(this.statusItemCoverageOffText())):(this.displayResults=!0,this.currentEditor?this.render(this.currentEditor):this.updateCoverageStatusItemText(this.statusItemCoverageOffText()))}resultsChanged(e){e.folderContext===this.workspaceContext.currentFolder&&this.currentEditor&&this.render(this.currentEditor)}render(e){this.clear(e);let t=this.workspaceContext.currentFolder;if(!t||!this.displayResults)return;t.lcovResults.exist||(Ze.window.showInformationMessage("Test coverage results are unavailable."),this.displayResults=!1);let r=t.lcovResults.resultsForFile(e==null?void 0:e.document.fileName);if(!r)return;let i=r.lines.details.filter(a=>a.hit>0),s=r.lines.details.filter(a=>a.hit===0);if(i.length>0){let a=i.map(u=>new Ze.Range(new Ze.Position(u.line-1,0),new Ze.Position(u.line-1,0))),c=this.combineRanges(a);e.setDecorations(this.coverageHitDecorationType,c)}if(s.length>0){let a=s.map(u=>new Ze.Range(new Ze.Position(u.line-1,0),new Ze.Position(u.line-1,0))),c=this.combineRanges(a);e.setDecorations(this.coverageMissDecorationType,c)}let o=100*r.lines.hit/r.lines.found;this.updateCoverageStatusItemText(`Coverage: ${o.toFixed(1)}%`),this.statusBarItem.show()}combineRanges(e){let t=e[0],r=[];if(e.length<2)return e;for(let i=1;i<e.length;i++)e[i].start.line===t.end.line+1?t=new Ze.Range(new Ze.Position(t.start.line,0),new Ze.Position(e[i].end.line,0)):(r.push(t),t=e[i]);return r.push(t),r}clear(e){e.setDecorations(this.coverageHitDecorationType,[]),e.setDecorations(this.coverageMissDecorationType,[]),W.alwaysShowCoverageStatusItem?this.updateCoverageStatusItemText(this.statusItemCoverageOffText()):this.statusBarItem.hide()}statusItemCoverageOffText(){return this.displayResults?"Coverage: Unavailable":"Coverage: Off"}};var sa=class{constructor(e,t){this.tempFolder=e;this.toolchain=t;this.folders=[];this.initialisationFinished=!1;this.observers=new Set;var o;this.outputChannel=new ju,this.statusItem=new $u,this.languageClientManager=new Fn(this),this.outputChannel.log(this.toolchain.swiftVersionString),this.toolchain.logDiagnostics(this.outputChannel),this.tasks=new af(this),this.currentDocument=null,this.testCoverageDocumentProvider=new uf(this),this.commentCompletionProvider=new ff,this.testCoverageRenderer=new Zc(this);let r=be.workspace.onDidChangeConfiguration(a=>{if(a.affectsConfiguration("swift.path")&&be.window.showInformationMessage("Changing the Swift path requires the project be reloaded.","Ok").then(c=>{c==="Ok"&&be.commands.executeCommand("workbench.action.reloadWindow")}),a.affectsConfiguration("swift.SDK")&&be.window.showInformationMessage("Changing the Swift SDK path requires the project be reloaded.","Ok").then(c=>{c==="Ok"&&be.commands.executeCommand("workbench.action.reloadWindow")}),a.affectsConfiguration("swift.runtimePath")){if(!this.needToAutoGenerateLaunchConfig())return;be.window.showInformationMessage(`Launch configurations need to be updated after changing the Swift runtime path. Custom versions of environment variable '${Ns()}' may be overridden. Do you want to update?`,"Update","Cancel").then(async c=>{c==="Update"&&this.folders.forEach(async u=>await Gi(u,!0))})}if(a.affectsConfiguration("swift.buildPath")){if(!this.needToAutoGenerateLaunchConfig())return;be.window.showInformationMessage("Launch configurations need to be updated after changing the Swift build path. Do you want to update?","Update","Cancel").then(async c=>{c==="Update"&&this.folders.forEach(async u=>await Gi(u,!0))})}}),i=fo.start(this),s=this.observeFolders((a,c)=>{switch(c){case ye.remove:this.updatePluginContextKey();break;case ye.focus:this.updateContextKeys(a),this.updateContextKeysForFile();break;case ye.unfocus:this.updateContextKeys(a);break;case ye.resolvedUpdated:a===this.currentFolder&&this.updateContextKeys(a)}});this.subscriptions=[this.commentCompletionProvider,this.testCoverageDocumentProvider,this.testCoverageRenderer,i,s,r,this.tasks,this.languageClientManager,this.outputChannel,this.statusItem],this.lastFocusUri=(o=be.window.activeTextEditor)==null?void 0:o.document.uri}dispose(){this.folders.forEach(e=>e.dispose()),this.subscriptions.forEach(e=>e.dispose())}get swiftVersion(){return this.toolchain.swiftVersion}static async create(){let e=await ra.create(),t=await br.create();return new sa(e,t)}updateContextKeys(e){if(!e||!e.swiftPackage.foundPackage){Yt.hasPackage=!1,Yt.packageHasDependencies=!1;return}Yt.hasPackage=!0,Yt.packageHasDependencies=e.swiftPackage.dependencies.length>0}updateContextKeysForFile(){var e,t,r;this.currentDocument?Yt.currentTargetType=(r=(t=this.currentFolder)==null?void 0:t.swiftPackage.getTarget((e=this.currentDocument)==null?void 0:e.fsPath))==null?void 0:r.type:Yt.currentTargetType=void 0,hC(this)}updatePluginContextKey(){let e=!1;for(let t of this.folders)if(t.swiftPackage.plugins.length>0){e=!0;break}Yt.packageHasPlugins=e}setupEventListeners(){let e=be.workspace.onDidChangeWorkspaceFolders(r=>{if(this===void 0){console.log("Trying to run onDidChangeWorkspaceFolders on deleted context");return}this.onDidChangeWorkspaceFolders(r)}),t=be.window.onDidChangeActiveTextEditor(async r=>{if(this===void 0){console.log("Trying to run onDidChangeWorkspaceFolders on deleted context");return}await this.focusTextEditor(r)});this.subscriptions.push(e,t)}async addWorkspaceFolders(){if(be.workspace.workspaceFolders&&be.workspace.workspaceFolders.length>0)for(let e of be.workspace.workspaceFolders)await this.addWorkspaceFolder(e);this.currentFolder===void 0&&(this.folders.length===1?await this.focusFolder(this.folders[0]):await this.focusFolder(null)),this.initialisationComplete()}async fireEvent(e,t){for(let r of this.observers)await r(e,t,this)}async focusFolder(e){e!==this.currentFolder&&(this.currentFolder!==void 0&&await this.fireEvent(this.currentFolder,ye.unfocus),this.currentFolder=e,await this.fireEvent(e,ye.focus))}async onDidChangeWorkspaceFolders(e){for(let t of e.added)await this.addWorkspaceFolder(t);for(let t of e.removed)await this.removeWorkspaceFolder(t)}async addWorkspaceFolder(e){await this.searchForPackages(e.uri,e),this.getActiveWorkspaceFolder(be.window.activeTextEditor)===e&&await this.focusTextEditor(be.window.activeTextEditor)}async searchForPackages(e,t){if(await this.isValidWorkspaceFolder(e.fsPath)){await this.addPackageFolder(e,t);return}!W.folder(t).searchSubfoldersForPackages||await be.workspace.fs.readDirectory(e).then(async r=>{for(let i of r)i[1]===be.FileType.Directory&&i[0][0]!=="."&&i[0]!=="Packages"&&await this.searchForPackages(be.Uri.joinPath(e,i[0]),t)})}async addPackageFolder(e,t){let r=this.folders.findIndex(s=>s.folder.fsPath===e.fsPath);if(r!==-1)return console.error(`Adding package folder ${e} twice`),this.folders[r];let i=await qt.create(e,t,this);return this.folders.push(i),await this.fireEvent(i,ye.add),i}async removeWorkspaceFolder(e){this.folders.forEach(async t=>{if(t.workspaceFolder!==e)return;this.currentFolder===t&&this.focusFolder(null);let r=[...this.observers];r.reverse();for(let i of r)await i(t,ye.remove,this);t.dispose()}),this.folders=this.folders.filter(t=>t.workspaceFolder!==e)}observeFolders(e){return this.observers.add(e),{dispose:()=>this.observers.delete(e)}}async setLLDBVersion(){let e=await Ap(this.toolchain);if(!e.success){if(!e.failure)return;let o=`Error: ${Nn(e.failure)}`;be.window.showErrorMessage(`Failed to setup CodeLLDB for debugging of Swift code. Debugging may produce unexpected results. ${o}`),this.outputChannel.log(`Failed to setup CodeLLDB: ${o}`);return}let t=e.success,r=be.workspace.getConfiguration("lldb"),i=r.get("library"),s=r.get("launch.expressions");i===t&&s==="native"||be.window.showInformationMessage("The Swift extension needs to update some CodeLLDB settings to enable debugging features. Do you want to set this up in your global settings or the workspace settings?","Global","Workspace","Cancel").then(o=>{switch(o){case"Global":r.update("library",t,be.ConfigurationTarget.Global),r.update("launch.expressions","native",be.ConfigurationTarget.Global),r.update("library",void 0,be.ConfigurationTarget.Workspace),r.update("launch.expressions",void 0,be.ConfigurationTarget.Workspace);break;case"Workspace":r.update("library",t,be.ConfigurationTarget.Workspace),r.update("launch.expressions","native",be.ConfigurationTarget.Workspace);break}})}async focusTextEditor(e){await this.focusUri(e==null?void 0:e.document.uri)}async focusUri(e){var t;this.currentDocument=e??null,this.updateContextKeysForFile(),((t=this.currentDocument)==null?void 0:t.scheme)==="file"&&await this.focusPackageUri(this.currentDocument)}async focusPackageUri(e){let t=await this.getPackageFolder(e);if(t instanceof qt)await this.focusFolder(t),this.lastFocusUri=void 0;else if(t instanceof be.Uri)if(this.initialisationFinished===!1)this.lastFocusUri=e;else{let r=be.workspace.getWorkspaceFolder(t);if(!r)return;await this.unfocusCurrentFolder();let i=await this.addPackageFolder(t,r);await this.focusFolder(i)}else await this.focusFolder(null)}toggleTestCoverageDisplay(){this.testCoverageRenderer||(this.testCoverageRenderer=new Zc(this),this.subscriptions.push(this.testCoverageRenderer)),this.testCoverageRenderer.toggleDisplayResults()}initialisationComplete(){this.initialisationFinished=!0,this.lastFocusUri&&(this.focusUri(this.lastFocusUri),this.lastFocusUri=void 0)}getWorkspaceFolder(e){return be.workspace.getWorkspaceFolder(e)}getActiveWorkspaceFolder(e){if(!(!e||!e.document))return be.workspace.getWorkspaceFolder(e.document.uri)}async getPackageFolder(e){let t=this.folders.find(a=>Dn(e.fsPath,a.folder.fsPath));if(t)return t;let r=this.getWorkspaceFolder(e);if(!r)return;let i=r.uri.fsPath,s,o=hf.dirname(e.fsPath);for(await this.isValidWorkspaceFolder(o)&&(s=o);o!==i;)o=hf.dirname(o),await this.isValidWorkspaceFolder(o)&&(s=o);if(s)return be.Uri.file(s)}async isValidWorkspaceFolder(e){return await Kr(e,"Package.swift")||await Kr(e,"compile_commands.json")}async unfocusCurrentFolder(){this.currentFolder!==void 0&&await this.fireEvent(this.currentFolder,ye.unfocus),this.currentFolder=void 0}needToAutoGenerateLaunchConfig(){let e=!1;return this.folders.forEach(t=>{e=e||W.folder(t.workspaceFolder).autoGenerateLaunchConfigurations}),e}},ye=(o=>(o.add="add",o.remove="remove",o.focus="focus",o.unfocus="unfocus",o.packageUpdated="packageUpdated",o.resolvedUpdated="resolvedUpdated",o))(ye||{});var Jt=G(require("vscode")),eu=G(require("fs/promises")),tu=G(require("path"));var Gn=class{constructor(e,t,r,i,s){this.name=e;this.path=t;this.location=r;this.version=i;this.type=s}toTreeItem(){let e=new Jt.TreeItem(this.name,Jt.TreeItemCollapsibleState.Collapsed);return e.id=this.path,e.description=this.version,e.iconPath=this.type==="editing"?new Jt.ThemeIcon("edit"):new Jt.ThemeIcon("package"),e.contextValue=this.type,e.accessibilityInformation={label:`Package ${this.name}`},e}},wC=class{constructor(e,t,r){this.name=e;this.path=t;this.isDirectory=r}toTreeItem(){let e=new Jt.TreeItem(this.name,this.isDirectory?Jt.TreeItemCollapsibleState.Collapsed:Jt.TreeItemCollapsibleState.None);return e.id=this.path,e.resourceUri=Jt.Uri.file(this.path),this.isDirectory?e.accessibilityInformation={label:`Folder ${this.name}`}:(e.command={command:"vscode.open",arguments:[e.resourceUri],title:"Open File"},e.accessibilityInformation={label:`File ${this.name}`}),e}},pf=class{constructor(e){this.workspaceContext=e;this.didChangeTreeDataEmitter=new Jt.EventEmitter;this.onDidChangeTreeData=this.didChangeTreeDataEmitter.event;Yt.hasPackage=!1,Yt.packageHasDependencies=!1}dispose(){var e;(e=this.workspaceObserver)==null||e.dispose()}observeFolders(e){this.workspaceObserver=this.workspaceContext.observeFolders((t,r)=>{switch(r){case ye.focus:if(!t)return;e.title=`Package Dependencies (${t.name})`,this.didChangeTreeDataEmitter.fire();break;case ye.unfocus:e.title="Package Dependencies",this.didChangeTreeDataEmitter.fire();break;case ye.resolvedUpdated:if(!t)return;t===this.workspaceContext.currentFolder&&this.didChangeTreeDataEmitter.fire()}})}getTreeItem(e){return e.toTreeItem()}async getChildren(e){let t=this.workspaceContext.currentFolder;if(!t)return[];if(!e){let r=await t.swiftPackage.loadWorkspaceState();return await this.getDependencyGraph(r,t)}return this.getNodesInDirectory(e.path)}async getDependencyGraph(e,t){if(!e)return[];let r=await this.getInUseDependencies(e,t);return(e==null?void 0:e.object.dependencies.filter(i=>r.has(i.packageRef.identity.toLowerCase())).map(i=>{let s=this.dependencyType(i),o=this.dependencyDisplayVersion(i),a=this.dependencyPackagePath(i,t.folder.fsPath),c=i.packageRef.location;return new Gn(i.packageRef.identity,a,c,o,s)}))??[]}async getInUseDependencies(e,t){let r=await this.getLocalDependencySet(e,t),i=this.getRemoteDependencySet(t),s=this.getEditedDependencySet(e);return new Set([...r,...i,...s])}getRemoteDependencySet(e){var t;return new Set((t=e==null?void 0:e.swiftPackage.resolved)==null?void 0:t.pins.map(r=>r.identity))}getEditedDependencySet(e){return new Set(e.object.dependencies.filter(t=>this.dependencyType(t)==="editing").map(t=>t.packageRef.identity))}async getLocalDependencySet(e,t){let r=t.swiftPackage.dependencies??[],i=e.object.dependencies??[],s=t.folder.fsPath,o=new Set,a=r;for(;a.length>0;){let c=a.pop();if(!c||o.has(c.identity)||c.type!=="local"&&c.type!=="fileSystem")continue;o.add(c.identity);let u=i.find(f=>f.packageRef.identity===c.identity);if(!u)continue;let l=this.dependencyPackagePath(u,s),h=await Sn.loadPackage(Jt.Uri.file(l),this.workspaceContext.toolchain);a.push(...h.dependencies)}return o}getLocalDependencies(e){return(e==null?void 0:e.object.dependencies.filter(t=>(t.packageRef.kind==="local"||t.packageRef.kind==="fileSystem")&&t.packageRef.location).map(t=>new Gn(t.packageRef.identity,t.packageRef.location,t.packageRef.location,"local","local")))??[]}getRemoteDependencies(e){var t;return((t=e.swiftPackage.resolved)==null?void 0:t.pins.map(r=>new Gn(r.identity,r.location,r.location,r.state.version??r.state.branch??r.state.revision.substring(0,7),"remote")))??[]}getEditedDependencies(e){return(e==null?void 0:e.object.dependencies.filter(t=>t.state.name==="edited"&&t.state.path).map(t=>new Gn(t.packageRef.identity,t.state.path,t.state.path,"local","editing")))??[]}async getNodesInDirectory(e){let t=await eu.readdir(e),r=[],i=W.excludePathsFromPackageDependencies;for(let s of t){if(i.includes(s))continue;let o=tu.join(e,s),a=await eu.stat(o);r.push(new wC(s,o,a.isDirectory()))}return r.sort((s,o)=>s.isDirectory===o.isDirectory?s.name.localeCompare(o.name):s.isDirectory?-1:1)}dependencyType(e){return e.state.name==="edited"?"editing":e.packageRef.kind==="local"||e.packageRef.kind==="fileSystem"?"local":"remote"}dependencyDisplayVersion(e){var r,i,s;let t=this.dependencyType(e);return t==="editing"?"editing":t==="local"?"local":((r=e.state.checkoutState)==null?void 0:r.version)??((i=e.state.checkoutState)==null?void 0:i.branch)??((s=e.state.checkoutState)==null?void 0:s.revision.substring(0,7))??"unknown"}dependencyPackagePath(e,t){let r=this.dependencyType(e);if(r==="editing")return e.state.path??tu.join(t,"Packages",e.subpath);if(r==="local")return e.state.path??e.packageRef.location;{let i=Rt.buildDirectoryFromWorkspacePath(t,!0);return tu.join(i,"checkouts",e.subpath)}}};var bC=G(require("vscode"));async function gf(n,e,t,r=()=>{}){let i=bC.window.createQuickPick();i.placeholder=n,i.items=e,i.show();let s=await new Promise(o=>{i.onDidAccept(()=>o(i.selectedItems[0])),i.onDidTriggerItemButton(a=>{r(a),o(void 0)}),i.onDidHide(()=>o(void 0))});i.busy=!0,s&&(await t(s),i.busy=!1),i.dispose()}async function sx(n){let e=n.currentFolder;!e||await oa(e)}async function oa(n,e){let t=on(["package","resolve"],an.resolvePackageName,{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:Q.TaskRevealKind.Silent}},n.workspaceContext.toolchain);await qi(t,"Resolving Dependencies",n,!1,e).then(r=>{SC(r,n)})}async function ox(n){let e=n.currentFolder;!e||await ax(e)}async function ax(n){let e=on(["package","update"],an.updatePackageName,{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:Q.TaskRevealKind.Silent}},n.workspaceContext.toolchain);await qi(e,"Updating Dependencies",n).then(t=>{SC(t,n)})}async function cx(n){await DC(n,{noDebug:!0})}async function ux(n){await DC(n,{})}async function DC(n,e){var o;let t=n.currentFolder;if(!t)return;let r=(o=Q.window.activeTextEditor)==null?void 0:o.document.fileName;if(!r)return;let i=t.swiftPackage.getTarget(r);if(!i||i.type!=="executable")return;let s=Dp(i.name,t);if(s)return Da(t.workspaceFolder,s,e)}async function lx(n){let e=n.currentFolder;!e||await dx(e)}async function dx(n){let e=on(["package","clean"],an.cleanBuildName,{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:Q.TaskRevealKind.Silent},group:Q.TaskGroup.Clean},n.workspaceContext.toolchain);await qi(e,"Clean Build",n)}async function fx(n){let e=n.currentFolder;!e||await hx(e)}async function hx(n){let e=on(["package","reset"],"Reset Package Dependencies",{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:Q.TaskRevealKind.Silent},group:Q.TaskGroup.Clean},n.workspaceContext.toolchain);await qi(e,"Reset Package",n).then(async t=>{if(!t)return;let r=on(["package","resolve"],an.resolvePackageName,{cwd:n.folder,scope:n.workspaceFolder,prefix:n.name,presentationOptions:{reveal:Q.TaskRevealKind.Silent}},n.workspaceContext.toolchain);await qi(r,"Resolving Dependencies",n)})}async function px(n){var s;let e=(s=Q.window.activeTextEditor)==null?void 0:s.document;if(!e)return;if(process.platform==="win32"&&n.toolchain.swiftVersion<new He(5,7,0)){Q.window.showErrorMessage("Run Swift Script is unavailable with the legacy driver on Windows.");return}let t=e.fileName,r=!1;if(e.isUntitled){r=!0,t=n.tempFolder.filename(e.fileName,"swift");let o=e.getText();await Es.writeFile(t,o)}else await e.save();let i=on([t],`Run ${t}`,{scope:Q.TaskScope.Global,cwd:Q.Uri.file(CC.dirname(t)),presentationOptions:{reveal:Q.TaskRevealKind.Always,clear:!0}},n.toolchain);await n.tasks.executeTaskAndWait(i),r&&await Es.rm(t)}async function gx(){Q.commands.executeCommand("workbench.action.tasks.runTask",{type:"swift-plugin"})}async function mx(n,e){let t=e.currentFolder;!t||Q.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,defaultUri:t.folder,openLabel:"Select",title:"Select folder"}).then(async r=>{if(!r)return;let i=r[0],s=on(["package","edit","--path",i.fsPath,n],"Edit Package Dependency",{scope:t.workspaceFolder,cwd:t.folder,prefix:t.name},e.toolchain);await qi(s,`Use local version of ${n}`,t,!0).then(o=>{o&&e.fireEvent(t,ye.resolvedUpdated)})})}async function vx(n,e){let t=e.currentFolder;if(!t)return;let r=on(["package","edit",n],"Edit Package Dependency",{scope:t.workspaceFolder,cwd:t.folder,prefix:t.name},e.toolchain);await qi(r,`edit locally ${n}`,t,!0).then(i=>{var s;if(i){e.fireEvent(t,ye.resolvedUpdated);let o=((s=Q.workspace.workspaceFolders)==null?void 0:s.length)??0;Q.workspace.updateWorkspaceFolders(o,0,{uri:Q.Uri.file(t.editedPackageFolder(n)),name:n})}})}async function yx(n,e){let t=e.currentFolder;if(!t)return;e.outputChannel.log(`unedit dependency ${n}`,t.name);let r=`Reverting edited dependency ${n} (${t.name})`;e.statusItem.start(r),await TC(t,n,e),e.statusItem.end(r)}async function TC(n,e,t,r=[]){var i;try{await er(["package","unedit",...r,e],t.toolchain,{cwd:n.folder.fsPath},n),t.fireEvent(n,ye.resolvedUpdated);let s=(i=Q.workspace.workspaceFolders)==null?void 0:i.findIndex(o=>o.name===e);if(s)try{await Es.stat(Q.workspace.workspaceFolders[s].uri.fsPath)}catch{Q.workspace.updateWorkspaceFolders(s,1)}}catch(s){let o=s;o.stderr.match(/has uncommited changes/)?Q.window.showWarningMessage(`${e} has uncommitted changes. Are you sure you want to continue?`,"Yes","No").then(async a=>{if(a==="No"){t.outputChannel.log(o.stderr,n.name);return}await TC(n,e,t,["--force"])}):(t.outputChannel.log(o.stderr,n.name),Q.window.showErrorMessage(`${o.stderr}`))}}async function wx(n){var t;let e=((t=Q.workspace.workspaceFolders)==null?void 0:t.length)??0;Q.workspace.updateWorkspaceFolders(e,0,{uri:Q.Uri.file(n.path),name:n.name})}async function bx(n){if(n.currentFolder){let e=Q.Uri.joinPath(n.currentFolder.folder,"Package.swift"),t=await Q.workspace.openTextDocument(e);Q.window.showTextDocument(t)}}function Cx(n){let e=Q.window.activeTextEditor;if(!e)return;let t=e.selection.active.line;n.commentCompletionProvider.insert(e,t)}function Dx(n){n.languageClientManager.restart()}async function qi(n,e,t,r=!1,i){try{return await t.taskQueue.queueOperation({task:n,showStatusItem:!0,log:e,checkAlreadyRunning:i})===0?!0:(r&&Q.window.showErrorMessage(`${e} failed`),!1)}catch(s){return r&&Q.window.showErrorMessage(`${e} failed: ${s}`),!1}}function Tx(n){try{let e=Q.Uri.parse(n.location,!0);Q.env.openExternal(e)}catch{}}async function Sx(){await gf("Select a new target",[{value:void 0,label:"macOS"},{value:wr.iOS,label:"iOS"},{value:wr.tvOS,label:"tvOS"},{value:wr.watchOS,label:"watchOS"}],async n=>{let e=n.value?await br.getSDKForTarget(n.value):"";e!==void 0?e!==""?(W.sdk=e,Q.window.showWarningMessage(`Selecting the ${n.label} SDK will provide code editing support, but compiling with this SDK will have undefined results.`)):W.sdk=void 0:Q.window.showErrorMessage("Unable to obtain requested SDK path")})}async function Rx(){let n=await br.getXcodeDeveloperDir(),e=W.swiftEnvironmentVariables.DEVELOPER_DIR,t=await br.getXcodeInstalls();await gf(e??n,t.map(r=>{let i=`${r}/Contents/Developer`;return{label:i===n?`${r} (default)`:r,folder:i===n?void 0:i}}),async r=>{let i=W.swiftEnvironmentVariables,s=i.DEVELOPER_DIR??n;if(r.folder)i.DEVELOPER_DIR=r.folder;else if(i.DEVELOPER_DIR){let o=i,{DEVELOPER_DIR:a}=o;i=Sf(o,["DEVELOPER_DIR"])}W.swiftEnvironmentVariables=i,W.sdk.length>0&&W.sdk.startsWith(s)&&(W.sdk=W.sdk.replace(s,r.folder??n)),Q.window.showInformationMessage("Changing the Xcode Developer Directory requires the project be reloaded.","Ok").then(()=>{Q.commands.executeCommand("workbench.action.reloadWindow")})})}async function kx(n){n.currentFolder&&n.testCoverageDocumentProvider.show(n.currentFolder)}function Px(n){n.toggleTestCoverageDisplay()}function SC(n,e){let t=e.hasResolveErrors;e.hasResolveErrors=!n,t&&!e.hasResolveErrors&&e.fireEvent(ye.resolvedUpdated)}function RC(n){n.subscriptions.push(Q.commands.registerCommand("swift.resolveDependencies",()=>sx(n)),Q.commands.registerCommand("swift.updateDependencies",()=>ox(n)),Q.commands.registerCommand("swift.run",()=>cx(n)),Q.commands.registerCommand("swift.debug",()=>ux(n)),Q.commands.registerCommand("swift.cleanBuild",()=>lx(n)),Q.commands.registerCommand("swift.switchPlatform",()=>Sx()),Q.commands.registerCommand("swift.resetPackage",()=>fx(n)),Q.commands.registerCommand("swift.runScript",()=>px(n)),Q.commands.registerCommand("swift.openPackage",()=>bx(n)),Q.commands.registerCommand("swift.runSnippet",()=>pC(n)),Q.commands.registerCommand("swift.debugSnippet",()=>gC(n)),Q.commands.registerCommand("swift.runPluginTask",()=>gx()),Q.commands.registerCommand("swift.restartLSPServer",()=>Dx(n)),Q.commands.registerCommand("swift.insertFunctionComment",()=>Cx(n)),Q.commands.registerCommand("swift.showTestCoverageReport",()=>kx(n)),Q.commands.registerCommand("swift.toggleTestCoverage",()=>Px(n)),Q.commands.registerCommand("swift.useLocalDependency",e=>{e instanceof Gn&&mx(e.name,n)}),Q.commands.registerCommand("swift.editDependency",e=>{e instanceof Gn&&vx(e.name,n)}),Q.commands.registerCommand("swift.uneditDependency",e=>{e instanceof Gn&&yx(e.name,n)}),Q.commands.registerCommand("swift.openInWorkspace",e=>{e instanceof Gn&&wx(e)}),Q.commands.registerCommand("swift.openExternal",e=>{e instanceof Gn&&Tx(e)}),Q.commands.registerCommand("swift.selectXcodeDeveloperDir",()=>Rx()))}var mf=G(require("vscode")),kC=G(nf());var vf=class{constructor(e){let t=mf.languages.createLanguageStatusItem("swiftlang-version",Fn.documentSelector);t.text=e.toolchain.swiftVersionString,t.accessibilityInformation={label:`Swift Version ${e.toolchain.swiftVersion.toString()}`},this.packageSwiftItem=mf.languages.createLanguageStatusItem("swiftlang-package",[...Fn.appleLangDocumentSelector,...Fn.cFamilyDocumentSelector]),this.packageSwiftItem.text="No Package.swift",this.packageSwiftItem.accessibilityInformation={label:"There is no Package.swift"};let r=e.observeFolders(async(i,s)=>{switch(s){case ye.focus:i&&i.swiftPackage.foundPackage?(this.packageSwiftItem.text="Package.swift",this.packageSwiftItem.command=kC.Command.create("Open Package","swift.openPackage"),this.packageSwiftItem.accessibilityInformation={label:"Open Package.swift"}):(this.packageSwiftItem.text="No Package.swift",this.packageSwiftItem.accessibilityInformation={label:"There is no Package.swift"},this.packageSwiftItem.command=void 0)}});this.subscriptions=[r,t,this.packageSwiftItem]}dispose(){this.subscriptions.forEach(e=>e.dispose())}};var Qn=G(require("vscode")),PC=G(require("path"));var yf=class{constructor(e){this.workspaceContext=e}async provideTasks(e){if(this.workspaceContext.folders.length===0)return[];let t=[];for(let r of this.workspaceContext.folders)for(let i of r.swiftPackage.plugins)t.push(this.createSwiftPluginTask(i,{cwd:r.folder,scope:r.workspaceFolder,presentationOptions:{reveal:Qn.TaskRevealKind.Always}}));return t}resolveTask(e,t){let r=this.workspaceContext.toolchain.getToolchainExecutable("swift"),i=e.definition.disableSandbox?["--disable-sandbox"]:[],s=e.definition.allowWritingToPackageDirectory?["--allow-writing-to-package-directory"]:[],o=["package",...i,...s,e.definition.command,...e.definition.args];o=this.workspaceContext.toolchain.buildFlags.withSwiftSDKFlags(o);let a=new Qn.Task(e.definition,e.scope??Qn.TaskScope.Workspace,e.name,"swift-plugin",new Qn.ProcessExecution(r,o,{cwd:e.definition.cwd}),e.problemMatchers);return a.detail=e.detail??`swift ${o.join(" ")}`,a.presentationOptions=e.presentationOptions,a}createSwiftPluginTask(e,t){var f;let r=this.workspaceContext.toolchain.getToolchainExecutable("swift"),i=PC.relative(t.scope.uri.fsPath,(f=t.cwd)==null?void 0:f.fsPath),s=i!==""?i:void 0,o=this.getTaskDefinition(e,s),a=o.disableSandbox?["--disable-sandbox"]:[],c=o.allowWritingToPackageDirectory?["--allow-writing-to-package-directory"]:[],u=["package",...a,...c,e.command,...o.args];u=this.workspaceContext.toolchain.buildFlags.withSwiftSDKFlags(u);let l=new Qn.Task(o,t.scope??Qn.TaskScope.Workspace,e.name,"swift-plugin",new Qn.ProcessExecution(r,u,{cwd:s,env:le(le({},W.swiftEnvironmentVariables),Ut())}),[]),h;return t.prefix?h=`(${t.prefix}) `:h="",l.detail=`${h}swift ${u.join(" ")}`,l.presentationOptions=(t==null?void 0:t.presentationOptions)??{},l}getTaskDefinition(e,t){let r={type:"swift-plugin",command:e.command,args:[],disableSandbox:!1,allowWritingToPackageDirectory:!1,cwd:t,disableTaskQueue:!1};switch(`${e.package}, ${e.command}`){case"swift-aws-lambda-runtime, archive":r.disableSandbox=!0,r.disableTaskQueue=!0;break;case"SwiftDocCPlugin, generate-documentation":r.allowWritingToPackageDirectory=!0;break;case"SwiftDocCPlugin, preview-documentation":r.disableSandbox=!0,r.allowWritingToPackageDirectory=!0;break;case"SwiftFormat, swiftformat":r.allowWritingToPackageDirectory=!0;break;default:break}return r}};var _C=G(require("vscode")),EC=G(require("fs/promises"));function xC(){return _C.workspace.registerTextDocumentContentProvider("readonly",{provideTextDocumentContent:async e=>{try{return await EC.readFile(e.fsPath,"utf8")}catch{return`Failed to load swiftinterface ${e.path}`}}})}async function Ex(n){try{console.debug("Activating Swift for Visual Studio Code...");let e=await sa.create();n.subscriptions.push(e),e.setLLDBVersion(),e.setupEventListeners();let t=ai.tasks.registerTaskProvider("swift",new an(e)),r=ai.tasks.registerTaskProvider("swift-plugin",new yf(e));RC(e);let i=new vf(e),s=xC(),o=e.observeFolders((f,C)=>{e.outputChannel.log(`${C}: ${f==null?void 0:f.folder.fsPath}`,f==null?void 0:f.name)}),a=new pf(e),c=ai.window.createTreeView("packageDependencies",{treeDataProvider:a,showCollapseAll:!0});a.observeFolders(c);let u=e.observeFolders(async(f,C,b)=>{async function y(S,R){(!W.folder(S.workspaceFolder).disableAutoResolve||W.backgroundCompilation)&&(W.backgroundCompilation&&S.workspaceFolder.uri===S.folder?await S.backgroundCompilation.runTask():await oa(S,!0),R.swiftVersion>=new He(5,6,0)&&await R.statusItem.showStatusWhileRunning(`Loading Swift Plugins (${qt.uriName(S.workspaceFolder.uri)})`,async()=>{await S.loadSwiftPlugins(),R.updatePluginContextKey()}))}if(!!f)switch(C){case ye.add:Gi(f),f.swiftPackage.foundPackage&&y(f,b);break;case ye.packageUpdated:Gi(f),f.swiftPackage.foundPackage&&!W.folder(f.workspaceFolder).disableAutoResolve&&await oa(f,!0);break;case ye.resolvedUpdated:f.swiftPackage.foundPackage&&!W.folder(f.workspaceFolder).disableAutoResolve&&await oa(f,!0)}}),l=ai.debug.registerDebugAdapterTrackerFactory("lldb",new Iu),h=Yi.observeFolders(e);return e.addWorkspaceFolders(),n.subscriptions.push(l,u,h,s,c,a,o,i,r,t),{workspaceContext:e}}catch(e){let t=Nn(e);throw ai.window.showErrorMessage(`Activating Swift extension failed: ${t}`),Error(t)}}function xx(){}module.exports=WC(Fx);0&&(module.exports={activate,deactivate});
